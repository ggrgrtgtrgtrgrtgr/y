-- [[ CAPATROLITY HUB v3.0 ]]
-- Developed by: D3v1lHub & freakyfrisk_1015 (dc)
-- Time Spent: 4.5 Days

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Debris = game:GetService("Debris")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

-- Polyfill for getgenv
if not getgenv then getgenv = function() return _G end end
getgenv().godmode = false
getgenv().selectedKillAuraWeapons = {}
getgenv().selectedTreeAuraWeapons = {}

-- =========================================================================
-- THEME SYSTEM
-- =========================================================================
local Themes = {
	["Dark"] = {
		Name = "Dark",
		Primary = Color3.fromRGB(18, 18, 24),
		Secondary = Color3.fromRGB(28, 28, 36),
		Tertiary = Color3.fromRGB(40, 40, 52),
		Accent = Color3.fromRGB(88, 101, 242),
		AccentHover = Color3.fromRGB(108, 121, 255),
		Text = Color3.fromRGB(255, 255, 255),
		TextDim = Color3.fromRGB(160, 160, 180),
		Success = Color3.fromRGB(87, 242, 135),
		Error = Color3.fromRGB(237, 66, 69),
		Border = Color3.fromRGB(60, 60, 80),
		Shadow = Color3.fromRGB(0, 0, 0),
	},
	["Light"] = {
		Name = "Light",
		Primary = Color3.fromRGB(255, 255, 255),
		Secondary = Color3.fromRGB(245, 245, 250),
		Tertiary = Color3.fromRGB(235, 235, 245),
		Accent = Color3.fromRGB(59, 130, 246),
		AccentHover = Color3.fromRGB(79, 150, 255),
		Text = Color3.fromRGB(30, 30, 40),
		TextDim = Color3.fromRGB(100, 100, 120),
		Success = Color3.fromRGB(34, 197, 94),
		Error = Color3.fromRGB(239, 68, 68),
		Border = Color3.fromRGB(200, 200, 220),
		Shadow = Color3.fromRGB(180, 180, 200),
	},
	["Tokyo Night"] = {
		Name = "Tokyo Night",
		Primary = Color3.fromRGB(26, 27, 38),
		Secondary = Color3.fromRGB(36, 40, 59),
		Tertiary = Color3.fromRGB(52, 59, 88),
		Accent = Color3.fromRGB(187, 154, 247),
		AccentHover = Color3.fromRGB(207, 174, 255),
		Text = Color3.fromRGB(169, 177, 214),
		TextDim = Color3.fromRGB(115, 121, 148),
		Success = Color3.fromRGB(158, 206, 106),
		Error = Color3.fromRGB(247, 118, 142),
		Border = Color3.fromRGB(65, 72, 104),
		Shadow = Color3.fromRGB(15, 15, 25),
	},
	["Kawaii"] = {
		Name = "Kawaii",
		Primary = Color3.fromRGB(255, 240, 245),
		Secondary = Color3.fromRGB(255, 228, 236),
		Tertiary = Color3.fromRGB(255, 215, 227),
		Accent = Color3.fromRGB(255, 105, 180),
		AccentHover = Color3.fromRGB(255, 130, 195),
		Text = Color3.fromRGB(80, 60, 80),
		TextDim = Color3.fromRGB(160, 130, 160),
		Success = Color3.fromRGB(152, 251, 152),
		Error = Color3.fromRGB(255, 99, 132),
		Border = Color3.fromRGB(255, 182, 203),
		Shadow = Color3.fromRGB(255, 200, 220),
	},
	["Anime"] = {
		Name = "Anime",
		Primary = Color3.fromRGB(15, 15, 35),
		Secondary = Color3.fromRGB(25, 25, 55),
		Tertiary = Color3.fromRGB(40, 40, 80),
		Accent = Color3.fromRGB(255, 100, 100),
		AccentHover = Color3.fromRGB(255, 130, 130),
		Text = Color3.fromRGB(255, 255, 255),
		TextDim = Color3.fromRGB(200, 180, 220),
		Success = Color3.fromRGB(100, 255, 150),
		Error = Color3.fromRGB(255, 80, 80),
		Border = Color3.fromRGB(100, 80, 150),
		Shadow = Color3.fromRGB(10, 10, 30),
	},
}

local CurrentTheme = Themes["Tokyo Night"]
local ThemeElements = {}

-- Notification System
local function notify(title, text, type)
	task.spawn(function()
		local color = type == "Error" and CurrentTheme.Error or (type == "Success" and CurrentTheme.Success or CurrentTheme.Accent)
		
		local Toast = Instance.new("Frame")
		Toast.Name = "Notification"
		Toast.Size = UDim2.new(0, 220, 0, 70)
		Toast.Position = UDim2.new(1, 20, 1, -80)
		Toast.BackgroundColor3 = CurrentTheme.Secondary
		Toast.BackgroundTransparency = 0.1
		Toast.BorderSizePixel = 0
		Toast.Parent = ScreenGui
		
		local Corner = Instance.new("UICorner", Toast)
		Corner.CornerRadius = UDim.new(0, 12)
		
		local Stroke = Instance.new("UIStroke", Toast)
		Stroke.Color = color
		Stroke.Thickness = 2
		Stroke.Transparency = 0.3
		
		-- Glow effect
		local Glow = Instance.new("ImageLabel", Toast)
		Glow.Size = UDim2.new(1, 40, 1, 40)
		Glow.Position = UDim2.new(0, -20, 0, -20)
		Glow.BackgroundTransparency = 1
		Glow.Image = "rbxassetid://5028857084"
		Glow.ImageColor3 = color
		Glow.ImageTransparency = 0.85
		Glow.ZIndex = 0
		
		local T = Instance.new("TextLabel", Toast)
		T.Text = title
		T.Size = UDim2.new(1, -20, 0, 22)
		T.Position = UDim2.new(0, 12, 0, 8)
		T.BackgroundTransparency = 1
		T.TextColor3 = color
		T.Font = Enum.Font.GothamBold
		T.TextSize = 14
		T.TextXAlignment = Enum.TextXAlignment.Left
		
		local D = Instance.new("TextLabel", Toast)
		D.Text = text
		D.Size = UDim2.new(1, -24, 1, -35)
		D.Position = UDim2.new(0, 12, 0, 30)
		D.BackgroundTransparency = 1
		D.TextColor3 = CurrentTheme.Text
		D.Font = Enum.Font.Gotham
		D.TextSize = 12
		D.TextWrapped = true
		D.TextXAlignment = Enum.TextXAlignment.Left
		
		-- Smooth slide in with scale effect
		Toast.Size = UDim2.new(0, 200, 0, 60)
		local tweenIn = TweenService:Create(Toast, TweenInfo.new(0.4, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
			Position = UDim2.new(1, -230, 1, -80),
			Size = UDim2.new(0, 220, 0, 70)
		})
		tweenIn:Play()
		
		-- Pulse glow animation
		task.spawn(function()
			for i = 1, 3 do
				TweenService:Create(Glow, TweenInfo.new(0.5), {ImageTransparency = 0.7}):Play()
				task.wait(0.5)
				TweenService:Create(Glow, TweenInfo.new(0.5), {ImageTransparency = 0.9}):Play()
				task.wait(0.5)
			end
		end)
		
		task.wait(3.5)
		
		-- Smooth fade out
		local tweenOut = TweenService:Create(Toast, TweenInfo.new(0.35, Enum.EasingStyle.Quint, Enum.EasingDirection.In), {
			Position = UDim2.new(1, 30, 1, -80),
			BackgroundTransparency = 1
		})
		TweenService:Create(T, TweenInfo.new(0.25), {TextTransparency = 1}):Play()
		TweenService:Create(D, TweenInfo.new(0.25), {TextTransparency = 1}):Play()
		TweenService:Create(Stroke, TweenInfo.new(0.25), {Transparency = 1}):Play()
		tweenOut:Play()
		tweenOut.Completed:Wait()
		Toast:Destroy()
	end)
end

local function registerElement(element, properties)
	table.insert(ThemeElements, {element = element, properties = properties})
end

local function applyTheme(themeName)
	CurrentTheme = Themes[themeName] or Themes["Dark"]
	local delay = 0
	for _, data in ipairs(ThemeElements) do
		if data.element and data.element.Parent then
			for prop, themeKey in pairs(data.properties) do
				if CurrentTheme[themeKey] then
					task.delay(delay, function()
						TweenService:Create(data.element, TweenInfo.new(0.4, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {[prop] = CurrentTheme[themeKey]}):Play()
					end)
					delay = delay + 0.008
				end
			end
		end
	end
	notify("Theme Changed", "Applied " .. themeName .. " theme", "Success")
end

-- =========================================================================
-- CREATE SCREEN GUI
-- =========================================================================
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "ModernCheatUI_Themed"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.Parent = PlayerGui

-- Main Frame with shadow
local ShadowFrame = Instance.new("Frame")
ShadowFrame.Name = "Shadow"
ShadowFrame.Size = UDim2.new(0, 380, 0, 520)
ShadowFrame.Position = UDim2.new(0.5, -185, 0.5, -255)
ShadowFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
ShadowFrame.BackgroundTransparency = 0.7
ShadowFrame.BorderSizePixel = 0
ShadowFrame.Parent = ScreenGui
Instance.new("UICorner", ShadowFrame).CornerRadius = UDim.new(0, 16)

local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 370, 0, 510)
MainFrame.Position = UDim2.new(0.5, -185, 0.5, -260)
MainFrame.BackgroundColor3 = CurrentTheme.Primary
MainFrame.BorderSizePixel = 0
MainFrame.ClipsDescendants = true
MainFrame.Parent = ScreenGui
registerElement(MainFrame, {BackgroundColor3 = "Primary"})

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 14)
MainCorner.Parent = MainFrame

local MainStroke = Instance.new("UIStroke")
MainStroke.Color = CurrentTheme.Border
MainStroke.Thickness = 2
MainStroke.Parent = MainFrame
registerElement(MainStroke, {Color = "Border"})

-- Gradient overlay for depth
local GradientFrame = Instance.new("Frame")
GradientFrame.Size = UDim2.new(1, 0, 0, 100)
GradientFrame.BackgroundTransparency = 0.85
GradientFrame.BorderSizePixel = 0
GradientFrame.Parent = MainFrame

local Gradient = Instance.new("UIGradient")
Gradient.Rotation = 90
Gradient.Color = ColorSequence.new({
	ColorSequenceKeypoint.new(0, Color3.new(1, 1, 1)),
	ColorSequenceKeypoint.new(1, Color3.new(0, 0, 0))
})
Gradient.Parent = GradientFrame

-- Title Bar
local TitleBar = Instance.new("Frame")
TitleBar.Name = "TitleBar"
TitleBar.Size = UDim2.new(1, 0, 0, 50)
TitleBar.BackgroundColor3 = CurrentTheme.Secondary
TitleBar.BorderSizePixel = 0
TitleBar.Parent = MainFrame
registerElement(TitleBar, {BackgroundColor3 = "Secondary"})

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 14)
TitleCorner.Parent = TitleBar

-- Fix bottom corners of title bar
local TitleFix = Instance.new("Frame")
TitleFix.Size = UDim2.new(1, 0, 0, 20)
TitleFix.Position = UDim2.new(0, 0, 1, -20)
TitleFix.BackgroundColor3 = CurrentTheme.Secondary
TitleFix.BorderSizePixel = 0
TitleFix.Parent = TitleBar
registerElement(TitleFix, {BackgroundColor3 = "Secondary"})

-- Icon/Logo
local IconLabel = Instance.new("TextLabel")
IconLabel.Text = "âš¡"
IconLabel.Size = UDim2.new(0, 40, 0, 40)
IconLabel.Position = UDim2.new(0, 10, 0.5, -20)
IconLabel.BackgroundTransparency = 1
IconLabel.TextColor3 = CurrentTheme.Accent
IconLabel.Font = Enum.Font.GothamBold
IconLabel.TextSize = 24
IconLabel.Parent = TitleBar
registerElement(IconLabel, {TextColor3 = "Accent"})

-- Breathing pulse animation for icon
task.spawn(function()
	while IconLabel and IconLabel.Parent do
		TweenService:Create(IconLabel, TweenInfo.new(1.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {TextSize = 26}):Play()
		task.wait(1.5)
		TweenService:Create(IconLabel, TweenInfo.new(1.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {TextSize = 24}):Play()
		task.wait(1.5)
	end
end)

local TitleLabel = Instance.new("TextLabel")
TitleLabel.Text = "CAPATROLITY HUB"
TitleLabel.Size = UDim2.new(1, -120, 0, 24)
TitleLabel.Position = UDim2.new(0, 50, 0, 8)
TitleLabel.BackgroundTransparency = 1
TitleLabel.TextColor3 = CurrentTheme.Text
TitleLabel.Font = Enum.Font.GothamBlack
TitleLabel.TextSize = 18
TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
TitleLabel.Parent = TitleBar
registerElement(TitleLabel, {TextColor3 = "Text"})

local SubtitleLabel = Instance.new("TextLabel")
SubtitleLabel.Text = "Advanced Control Panel"
SubtitleLabel.Size = UDim2.new(1, -120, 0, 16)
SubtitleLabel.Position = UDim2.new(0, 50, 0, 30)
SubtitleLabel.BackgroundTransparency = 1
SubtitleLabel.TextColor3 = CurrentTheme.TextDim
SubtitleLabel.Font = Enum.Font.Gotham
SubtitleLabel.TextSize = 12
SubtitleLabel.TextXAlignment = Enum.TextXAlignment.Left
SubtitleLabel.Parent = TitleBar
registerElement(SubtitleLabel, {TextColor3 = "TextDim"})

-- Theme selector button
local ThemeBtn = Instance.new("TextButton")
ThemeBtn.Text = ""
ThemeBtn.Size = UDim2.new(0, 36, 0, 36)
ThemeBtn.Position = UDim2.new(1, -90, 0.5, -18)
ThemeBtn.BackgroundColor3 = CurrentTheme.Tertiary
ThemeBtn.TextColor3 = CurrentTheme.Text
ThemeBtn.Font = Enum.Font.GothamBold
ThemeBtn.TextSize = 18
ThemeBtn.AutoButtonColor = false
ThemeBtn.Parent = TitleBar
Instance.new("UICorner", ThemeBtn).CornerRadius = UDim.new(0, 10)
registerElement(ThemeBtn, {BackgroundColor3 = "Tertiary", TextColor3 = "Text"})

-- Theme button hover effects
ThemeBtn.MouseEnter:Connect(function()
	TweenService:Create(ThemeBtn, TweenInfo.new(0.2, Enum.EasingStyle.Quint), {
		Size = UDim2.new(0, 40, 0, 40),
		Position = UDim2.new(1, -92, 0.5, -20),
		BackgroundColor3 = CurrentTheme.Accent
	}):Play()
end)
ThemeBtn.MouseLeave:Connect(function()
	TweenService:Create(ThemeBtn, TweenInfo.new(0.25, Enum.EasingStyle.Quint), {
		Size = UDim2.new(0, 36, 0, 36),
		Position = UDim2.new(1, -90, 0.5, -18),
		BackgroundColor3 = CurrentTheme.Tertiary
	}):Play()
end)

-- Exit Button
local ExitButton = Instance.new("TextButton")
ExitButton.Text = "âœ•"
ExitButton.Size = UDim2.new(0, 36, 0, 36)
ExitButton.Position = UDim2.new(1, -46, 0.5, -18)
ExitButton.BackgroundColor3 = CurrentTheme.Error
ExitButton.BackgroundTransparency = 0.8
ExitButton.TextColor3 = CurrentTheme.Error
ExitButton.Font = Enum.Font.GothamBold
ExitButton.TextSize = 16
ExitButton.AutoButtonColor = false
ExitButton.Parent = TitleBar
Instance.new("UICorner", ExitButton).CornerRadius = UDim.new(0, 10)
registerElement(ExitButton, {TextColor3 = "Error"})

-- Exit button hover effects
ExitButton.MouseEnter:Connect(function()
	TweenService:Create(ExitButton, TweenInfo.new(0.15, Enum.EasingStyle.Quint), {
		BackgroundTransparency = 0.2,
		Size = UDim2.new(0, 40, 0, 40),
		Position = UDim2.new(1, -48, 0.5, -20),
		Rotation = 90
	}):Play()
end)
ExitButton.MouseLeave:Connect(function()
	TweenService:Create(ExitButton, TweenInfo.new(0.2, Enum.EasingStyle.Quint), {
		BackgroundTransparency = 0.8,
		Size = UDim2.new(0, 36, 0, 36),
		Position = UDim2.new(1, -46, 0.5, -18),
		Rotation = 0
	}):Play()
end)

ExitButton.MouseButton1Click:Connect(function()
	-- Smooth scale down and fade
	TweenService:Create(MainFrame, TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
		Position = UDim2.new(0.5, -185, 0.5, -240),
		Size = UDim2.new(0, 0, 0, 0)
	}):Play()
	TweenService:Create(ShadowFrame, TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
		Position = UDim2.new(0.5, -185, 0.5, -240),
		Size = UDim2.new(0, 0, 0, 0),
		BackgroundTransparency = 1
	}):Play()
	task.wait(0.45)
	ScreenGui:Destroy()
end)

-- Theme Dropdown
local ThemeDropdown = Instance.new("Frame")
ThemeDropdown.Name = "ThemeDropdown"
ThemeDropdown.Size = UDim2.new(0, 140, 0, 0)
ThemeDropdown.Position = UDim2.new(1, -150, 0, 50)
ThemeDropdown.BackgroundColor3 = CurrentTheme.Secondary
ThemeDropdown.BorderSizePixel = 0
ThemeDropdown.ClipsDescendants = true
ThemeDropdown.Visible = false
ThemeDropdown.ZIndex = 10
ThemeDropdown.Parent = MainFrame
Instance.new("UICorner", ThemeDropdown).CornerRadius = UDim.new(0, 10)
registerElement(ThemeDropdown, {BackgroundColor3 = "Secondary"})

local ThemeLayout = Instance.new("UIListLayout")
ThemeLayout.Padding = UDim.new(0, 2)
ThemeLayout.Parent = ThemeDropdown

local themeDropOpen = false
ThemeBtn.MouseButton1Click:Connect(function()
	themeDropOpen = not themeDropOpen
	ThemeDropdown.Visible = true
	local targetSize = themeDropOpen and UDim2.new(0, 140, 0, 165) or UDim2.new(0, 140, 0, 0)
	TweenService:Create(ThemeDropdown, TweenInfo.new(0.2), {Size = targetSize}):Play()
	if not themeDropOpen then task.delay(0.2, function() ThemeDropdown.Visible = false end) end
end)

for themeName, _ in pairs(Themes) do
	local ThemeOption = Instance.new("TextButton")
	ThemeOption.Text = themeName
	ThemeOption.Size = UDim2.new(1, -8, 0, 30)
	ThemeOption.Position = UDim2.new(0, 4, 0, 0)
	ThemeOption.BackgroundColor3 = CurrentTheme.Tertiary
	ThemeOption.BackgroundTransparency = 0.5
	ThemeOption.TextColor3 = CurrentTheme.Text
	ThemeOption.Font = Enum.Font.GothamMedium
	ThemeOption.TextSize = 13
	ThemeOption.ZIndex = 11
	ThemeOption.Parent = ThemeDropdown
	Instance.new("UICorner", ThemeOption).CornerRadius = UDim.new(0, 6)
	registerElement(ThemeOption, {BackgroundColor3 = "Tertiary", TextColor3 = "Text"})
	
	ThemeOption.MouseButton1Click:Connect(function()
		applyTheme(themeName)
		themeDropOpen = false
		TweenService:Create(ThemeDropdown, TweenInfo.new(0.2), {Size = UDim2.new(0, 140, 0, 0)}):Play()
		task.delay(0.2, function() ThemeDropdown.Visible = false end)
	end)
end

-- Search Bar
local SearchFrame = Instance.new("Frame")
SearchFrame.Name = "SearchFrame"
SearchFrame.Size = UDim2.new(1, -18, 0, 38)
SearchFrame.Position = UDim2.new(0, 9, 0, 56)
SearchFrame.BackgroundColor3 = CurrentTheme.Secondary
SearchFrame.BackgroundTransparency = 0.2
SearchFrame.Parent = MainFrame
Instance.new("UICorner", SearchFrame).CornerRadius = UDim.new(0, 10)
registerElement(SearchFrame, {BackgroundColor3 = "Secondary"})

local SearchStroke = Instance.new("UIStroke", SearchFrame)
SearchStroke.Color = CurrentTheme.Border
SearchStroke.Transparency = 0.7
SearchStroke.Thickness = 1
registerElement(SearchStroke, {Color = "Border"})

local SearchIcon = Instance.new("TextLabel")
SearchIcon.Size = UDim2.new(0, 32, 0, 32)
SearchIcon.Position = UDim2.new(0, 8, 0.5, -16)
SearchIcon.BackgroundTransparency = 1
SearchIcon.TextColor3 = CurrentTheme.TextDim
SearchIcon.Font = Enum.Font.GothamMedium
SearchIcon.TextSize = 16
SearchIcon.Text = ""
SearchIcon.Parent = SearchFrame
registerElement(SearchIcon, {TextColor3 = "TextDim"})

local SearchBox = Instance.new("TextBox")
SearchBox.PlaceholderText = "Search effects..."
SearchBox.Text = ""
SearchBox.Size = UDim2.new(1, -44, 1, 0)
SearchBox.Position = UDim2.new(0, 38, 0, 0)
SearchBox.BackgroundTransparency = 1
SearchBox.TextColor3 = CurrentTheme.Text
SearchBox.PlaceholderColor3 = CurrentTheme.TextDim
SearchBox.Font = Enum.Font.Gotham
SearchBox.TextSize = 13
SearchBox.TextXAlignment = Enum.TextXAlignment.Left
SearchBox.ClearTextOnFocus = false
SearchBox.Parent = SearchFrame
registerElement(SearchBox, {TextColor3 = "Text", PlaceholderColor3 = "TextDim"})

-- Search bar focus animations
SearchBox.Focused:Connect(function()
	TweenService:Create(SearchFrame, TweenInfo.new(0.25, Enum.EasingStyle.Quint), {BackgroundTransparency = 0}):Play()
	TweenService:Create(SearchStroke, TweenInfo.new(0.25), {Color = CurrentTheme.Accent, Transparency = 0.3}):Play()
	TweenService:Create(SearchIcon, TweenInfo.new(0.25), {TextColor3 = CurrentTheme.Accent}):Play()
end)
SearchBox.FocusLost:Connect(function()
	TweenService:Create(SearchFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quint), {BackgroundTransparency = 0.2}):Play()
	TweenService:Create(SearchStroke, TweenInfo.new(0.3), {Color = CurrentTheme.Border, Transparency = 0.7}):Play()
	TweenService:Create(SearchIcon, TweenInfo.new(0.3), {TextColor3 = CurrentTheme.TextDim}):Play()
end)

-- Scrolling Container
local MasterScroll = Instance.new("ScrollingFrame")
MasterScroll.Name = "MasterScroll"
MasterScroll.Size = UDim2.new(1, -16, 1, -100)
MasterScroll.Position = UDim2.new(0, 8, 0, 95)
MasterScroll.BackgroundTransparency = 1
MasterScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
MasterScroll.ScrollBarThickness = 2
MasterScroll.ScrollBarImageColor3 = CurrentTheme.Accent
MasterScroll.Parent = MainFrame
registerElement(MasterScroll, {ScrollBarImageColor3 = "Accent"})

-- Search Logic
local function updateSearch()
	local query = SearchBox.Text:lower()
	for _, child in ipairs(MasterScroll:GetChildren()) do
		if child:IsA("Frame") and child.Name ~= "UIListLayout" then
			local foundInCategory = false
			local content = child:FindFirstChild("Content")
			if content then
				for _, item in ipairs(content:GetChildren()) do
					if item:IsA("Frame") or item:IsA("TextButton") then
						local text = ""
						if item:IsA("TextButton") then text = item.Text:lower()
						else
							local label = item:FindFirstChildWhichIsA("TextLabel")
							if label then text = label.Text:lower() end
						end
						
						if text:find(query) then
							item.Visible = true
							foundInCategory = true
						else
							item.Visible = false
						end
					end
				end
			end
			child.Visible = foundInCategory or child.Name:lower():find(query)
		end
	end
end

SearchBox:GetPropertyChangedSignal("Text"):Connect(updateSearch)

local MasterLayout = Instance.new("UIListLayout")
MasterLayout.Padding = UDim.new(0, 8)
MasterLayout.SortOrder = Enum.SortOrder.LayoutOrder
MasterLayout.Parent = MasterScroll

MasterLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
	MasterScroll.CanvasSize = UDim2.new(0, 0, 0, MasterLayout.AbsoluteContentSize.Y + 20)
end)

-- =========================================================================
-- UI BUILDERS (Improved)
-- =========================================================================

local function createCategory(name, accentColor)
	local CategoryFrame = Instance.new("Frame")
	CategoryFrame.Name = name
	CategoryFrame.Size = UDim2.new(1, 0, 0, 48)
	CategoryFrame.BackgroundColor3 = CurrentTheme.Secondary
	CategoryFrame.BackgroundTransparency = 0.1
	CategoryFrame.BorderSizePixel = 0
	CategoryFrame.ClipsDescendants = true
	CategoryFrame.Parent = MasterScroll
	registerElement(CategoryFrame, {BackgroundColor3 = "Secondary"})
	
	local CatCorner = Instance.new("UICorner")
	CatCorner.CornerRadius = UDim.new(0, 12)
	CatCorner.Parent = CategoryFrame
	
	local CatStroke = Instance.new("UIStroke")
	CatStroke.Color = CurrentTheme.Border
	CatStroke.Thickness = 1
	CatStroke.Transparency = 0.6
	CatStroke.Parent = CategoryFrame
	registerElement(CatStroke, {Color = "Border"})
	
	-- Accent bar on left with glow
	local AccentBar = Instance.new("Frame")
	AccentBar.Size = UDim2.new(0, 4, 0, 28)
	AccentBar.Position = UDim2.new(0, 12, 0, 10)
	AccentBar.BackgroundColor3 = accentColor or CurrentTheme.Accent
	AccentBar.BorderSizePixel = 0
	AccentBar.Parent = CategoryFrame
	Instance.new("UICorner", AccentBar).CornerRadius = UDim.new(0, 4)
	
	local Header = Instance.new("TextButton")
	Header.Size = UDim2.new(1, 0, 0, 48)
	Header.BackgroundTransparency = 1
	Header.Text = ""
	Header.AutoButtonColor = false
	Header.Parent = CategoryFrame
	
	local Arrow = Instance.new("TextLabel")
	Arrow.Text = ">"
	Arrow.Size = UDim2.new(0, 30, 0, 48)
	Arrow.Position = UDim2.new(1, -40, 0, 0)
	Arrow.TextColor3 = CurrentTheme.TextDim
	Arrow.Font = Enum.Font.GothamBold
	Arrow.TextSize = 22
	Arrow.BackgroundTransparency = 1
	Arrow.Rotation = 0
	Arrow.Parent = Header
	registerElement(Arrow, {TextColor3 = "TextDim"})
	
	local Label = Instance.new("TextLabel")
	Label.Text = name:upper()
	Label.Size = UDim2.new(1, -75, 1, 0)
	Label.Position = UDim2.new(0, 26, 0, 0)
	Label.BackgroundTransparency = 1
	Label.TextColor3 = CurrentTheme.Text
	Label.Font = Enum.Font.GothamBold
	Label.TextSize = 13
	Label.TextXAlignment = Enum.TextXAlignment.Left
	Label.TextScaled = true
	Label.Parent = Header
	registerElement(Label, {TextColor3 = "Text"})
	
	local Content = Instance.new("Frame")
	Content.Name = "Content"
	Content.Size = UDim2.new(1, -20, 0, 0)
	Content.Position = UDim2.new(0, 10, 0, 52)
	Content.BackgroundTransparency = 1
	Content.Parent = CategoryFrame
	
	local ContentLayout = Instance.new("UIListLayout")
	ContentLayout.Padding = UDim.new(0, 6)
	ContentLayout.Parent = Content
	
	local open = false
	
	-- Hover effect for header
	Header.MouseEnter:Connect(function()
		TweenService:Create(AccentBar, TweenInfo.new(0.2, Enum.EasingStyle.Quint), {
			Size = UDim2.new(0, 5, 0, 32),
			Position = UDim2.new(0, 11, 0, 8)
		}):Play()
		TweenService:Create(Label, TweenInfo.new(0.2), {TextColor3 = accentColor or CurrentTheme.Accent}):Play()
	end)
	Header.MouseLeave:Connect(function()
		TweenService:Create(AccentBar, TweenInfo.new(0.25, Enum.EasingStyle.Quint), {
			Size = UDim2.new(0, 4, 0, 28),
			Position = UDim2.new(0, 12, 0, 10)
		}):Play()
		TweenService:Create(Label, TweenInfo.new(0.25), {TextColor3 = CurrentTheme.Text}):Play()
	end)
	
	Header.MouseButton1Click:Connect(function()
		open = not open
		TweenService:Create(Arrow, TweenInfo.new(0.35, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {Rotation = open and 90 or 0}):Play()
		local targetHeight = open and (ContentLayout.AbsoluteContentSize.Y + 62) or 48
		TweenService:Create(CategoryFrame, TweenInfo.new(0.4, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {Size = UDim2.new(1, 0, 0, targetHeight)}):Play()
		TweenService:Create(CatStroke, TweenInfo.new(0.3), {Color = open and (accentColor or CurrentTheme.Accent) or CurrentTheme.Border}):Play()
	end)
	
	ContentLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
		if open then
			TweenService:Create(CategoryFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quint), {Size = UDim2.new(1, 0, 0, ContentLayout.AbsoluteContentSize.Y + 62)}):Play()
		end
	end)
	
	return Content, Header
end

local function createToggle(parent, text, callback, default)
	local Frame = Instance.new("Frame")
	Frame.Size = UDim2.new(1, 0, 0, 42)
	Frame.BackgroundColor3 = CurrentTheme.Tertiary
	Frame.BackgroundTransparency = 0.2
	Frame.BorderSizePixel = 0
	Frame.Parent = parent
	Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 10)
	registerElement(Frame, {BackgroundColor3 = "Tertiary"})
	
	local FrameStroke = Instance.new("UIStroke", Frame)
	FrameStroke.Color = CurrentTheme.Border
	FrameStroke.Transparency = 0.8
	FrameStroke.Thickness = 1
	registerElement(FrameStroke, {Color = "Border"})
	
	local Label = Instance.new("TextLabel")
	Label.Text = text
	Label.Size = UDim2.new(1, -65, 1, 0)
	Label.Position = UDim2.new(0, 14, 0, 0)
	Label.TextColor3 = CurrentTheme.Text
	Label.Font = Enum.Font.GothamMedium
	Label.TextSize = 13
	Label.TextXAlignment = Enum.TextXAlignment.Left
	Label.BackgroundTransparency = 1
	Label.TextScaled = true
	Label.Parent = Frame
	registerElement(Label, {TextColor3 = "Text"})
	
	-- Modern toggle switch
	local ToggleBG = Instance.new("Frame")
	ToggleBG.Size = UDim2.new(0, 44, 0, 24)
	ToggleBG.Position = UDim2.new(1, -56, 0.5, -12)
	ToggleBG.BackgroundColor3 = default and CurrentTheme.Success or CurrentTheme.Border
	ToggleBG.BorderSizePixel = 0
	ToggleBG.Parent = Frame
	Instance.new("UICorner", ToggleBG).CornerRadius = UDim.new(1, 0)
	registerElement(ToggleBG, {BackgroundColor3 = "Border"})
	
	local ToggleCircle = Instance.new("Frame")
	ToggleCircle.Size = UDim2.new(0, 18, 0, 18)
	ToggleCircle.Position = default and UDim2.new(0, 23, 0.5, -9) or UDim2.new(0, 3, 0.5, -9)
	ToggleCircle.BackgroundColor3 = Color3.new(1, 1, 1)
	ToggleCircle.BorderSizePixel = 0
	ToggleCircle.Parent = ToggleBG
	Instance.new("UICorner", ToggleCircle).CornerRadius = UDim.new(1, 0)
	
	local ClickBtn = Instance.new("TextButton")
	ClickBtn.Size = UDim2.new(1, 0, 1, 0)
	ClickBtn.BackgroundTransparency = 1
	ClickBtn.Text = ""
	ClickBtn.Parent = Frame
	
	local enabled = default or false
	
	-- Hover effect
	ClickBtn.MouseEnter:Connect(function()
		TweenService:Create(Frame, TweenInfo.new(0.2, Enum.EasingStyle.Quint), {BackgroundTransparency = 0}):Play()
		TweenService:Create(FrameStroke, TweenInfo.new(0.2), {Transparency = 0.5}):Play()
	end)
	ClickBtn.MouseLeave:Connect(function()
		TweenService:Create(Frame, TweenInfo.new(0.25, Enum.EasingStyle.Quint), {BackgroundTransparency = 0.2}):Play()
		TweenService:Create(FrameStroke, TweenInfo.new(0.25), {Transparency = 0.8}):Play()
	end)
	
	ClickBtn.MouseButton1Click:Connect(function()
		enabled = not enabled
		local color = enabled and CurrentTheme.Success or CurrentTheme.Border
		local pos = enabled and UDim2.new(0, 23, 0.5, -9) or UDim2.new(0, 3, 0.5, -9)
		
		-- Spring animation for toggle
		TweenService:Create(ToggleBG, TweenInfo.new(0.35, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {BackgroundColor3 = color}):Play()
		TweenService:Create(ToggleCircle, TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {Position = pos}):Play()
		
		-- Scale bounce effect
		TweenService:Create(ToggleCircle, TweenInfo.new(0.15, Enum.EasingStyle.Quad), {Size = UDim2.new(0, 16, 0, 18)}):Play()
		task.delay(0.15, function()
			TweenService:Create(ToggleCircle, TweenInfo.new(0.2, Enum.EasingStyle.Quint), {Size = UDim2.new(0, 18, 0, 18)}):Play()
		end)
		
		notify("Feature Updated", text .. " is now " .. (enabled and "ON" or "OFF"), enabled and "Success" or "Default")
		callback(enabled)
	end)
	
	return Frame
end

local function createButton(parent, text, callback)
	local Button = Instance.new("TextButton")
	Button.Size = UDim2.new(1, 0, 0, 42)
	Button.BackgroundColor3 = CurrentTheme.Accent
	Button.BackgroundTransparency = 0.25
	Button.Text = text
	Button.TextColor3 = CurrentTheme.Text
	Button.Font = Enum.Font.GothamBold
	Button.TextSize = 13
	Button.AutoButtonColor = false
	Button.TextScaled = true
	Button.Parent = parent
	Instance.new("UICorner", Button).CornerRadius = UDim.new(0, 10)
	registerElement(Button, {BackgroundColor3 = "Accent", TextColor3 = "Text"})
	
	local BtnStroke = Instance.new("UIStroke", Button)
	BtnStroke.Color = CurrentTheme.Accent
	BtnStroke.Transparency = 0.6
	BtnStroke.Thickness = 1
	registerElement(BtnStroke, {Color = "Accent"})
	
	Button.MouseEnter:Connect(function()
		TweenService:Create(Button, TweenInfo.new(0.2, Enum.EasingStyle.Quint), {
			BackgroundTransparency = 0,
			Size = UDim2.new(1, 4, 0, 44),
			Position = UDim2.new(0, -2, 0, -1)
		}):Play()
		TweenService:Create(BtnStroke, TweenInfo.new(0.2), {Transparency = 0.3}):Play()
	end)
	Button.MouseLeave:Connect(function()
		TweenService:Create(Button, TweenInfo.new(0.25, Enum.EasingStyle.Quint), {
			BackgroundTransparency = 0.25,
			Size = UDim2.new(1, 0, 0, 42),
			Position = UDim2.new(0, 0, 0, 0)
		}):Play()
		TweenService:Create(BtnStroke, TweenInfo.new(0.25), {Transparency = 0.6}):Play()
	end)
	
	-- Click ripple effect
	Button.MouseButton1Click:Connect(function()
		TweenService:Create(Button, TweenInfo.new(0.1), {BackgroundTransparency = 0.5}):Play()
		task.delay(0.1, function()
			TweenService:Create(Button, TweenInfo.new(0.15), {BackgroundTransparency = 0}):Play()
		end)
		callback()
	end)
	
	return Button
end

-- =========================================================================
-- GLOBAL VARS & LOGIC (Same as original)
-- =========================================================================

local workspaceItems = workspace:WaitForChild("Items")
local PlantRemote = nil
local SAPLING_NAME = 'sapling'
local TrollSelectedItems = {["ALL"] = true}
local TrollAddInterval = 0.1
local TrollSpacing = 2
local activeTrailMarkers = {}
local selectedPlayer = nil
getgenv().TrollMaxItems = 1000000
getgenv().InstantBring = false
getgenv().selectedAuraWeapons = {}

-- Instant Interaction Bypass
local function setupPrompt(obj)
    if obj:IsA("ProximityPrompt") then
        obj.HoldDuration = 0
    end
end
for _, prompt in ipairs(game:GetDescendants()) do setupPrompt(prompt) end
game.DescendantAdded:Connect(setupPrompt)
print("E Buttons are set to 0 delay//--Script made by D3v1lHub")

local function findPlantRemote()
    for _, obj in ipairs(ReplicatedStorage:GetDescendants()) do
        if obj.Name:lower() == 'requestplantitem' then return obj end
    end
    return nil
end
PlantRemote = findPlantRemote()

local function robustPlantCall(remote, arg, pos)
	if not remote then return end
	pcall(function() remote:InvokeServer(arg, pos) end)
	pcall(function() remote:FireServer(arg, pos) end)
end

local function findRemote(name)
	for _, obj in ipairs(ReplicatedStorage:GetDescendants()) do
		if obj.Name:lower() == name:lower() then return obj end
	end
	return nil
end

local DragRemote = findRemote("RequestStartDraggingItem")
local StopRemote = findRemote("StopDraggingItem")

local function startDrag(item)
	if DragRemote then pcall(function() DragRemote:FireServer(item) end) end
end

local function stopDrag(item)
	if StopRemote then pcall(function() StopRemote:FireServer(item) end) end
end

local function handleItemInteraction(item)
	task.spawn(function()
		local r = ReplicatedStorage:FindFirstChild("RequestInteractItem", true) or ReplicatedStorage:FindFirstChild("Interact", true)
		if r then pcall(function() r:FireServer(item) end) end
		for _, v in ipairs(item:GetDescendants()) do
			if v:IsA("ProximityPrompt") then
				if fireproximityprompt then
					fireproximityprompt(v)
				else
					v:InputHoldBegin()
					task.wait(v.HoldDuration + 0.1)
					v:InputHoldEnd()
				end
			end
		end
	end)
end

local function findSaplingInstance()
    local containers = { workspace:FindFirstChild('Items'), ReplicatedStorage, LocalPlayer:FindFirstChild('Backpack'), LocalPlayer:FindFirstChild('Inventory') }
    for _, cont in ipairs(containers) do
        if cont then
            for _, c in ipairs(cont:GetDescendants()) do if c.Name:lower():find(SAPLING_NAME:lower()) then return c end end
        end
    end
    return SAPLING_NAME
end

local RESTRICTED_PATTERNS = {"fairy", "hardmode crate", "mossy chest"}
local function isRestricted(obj)
    local n = obj.Name:lower()
    for _, p in ipairs(RESTRICTED_PATTERNS) do if n:find(p) then return true end end
    for _, desc in ipairs(obj:GetDescendants()) do
        local dn = desc.Name:lower()
        for _, p in ipairs(RESTRICTED_PATTERNS) do if dn:find(p) then return true end end
    end
    return false
end

local function getTrollItems(targetTable, signal)
	local all = workspaceItems:GetChildren()
	local f = targetTable or {}
	local limit = getgenv().TrollMaxItems or 1000000
	local count = 0
	local char = LocalPlayer.Character; local hrp = char and char:FindFirstChild("HumanoidRootPart")
	
	for _, item in ipairs(all) do
		if count >= limit then break end
		local n = item.Name:lower()
		-- AUTO SKIP CHESTS AND CRATES for special/passive brings
		if not n:find("chest") and not n:find("crate") and not isRestricted(item) then
			if TrollSelectedItems["ALL"] or TrollSelectedItems[item.Name] then
				count = count + 1
				
				-- 3. SEQUENTIAL DELAY (Wait BEFORE processing the bring)
				if not getgenv().InstantBring and TrollAddInterval > 0 then
					local start = tick()
					while tick() - start < TrollAddInterval do
						if signal and signal.aborted then return f end
						task.wait(0.05)
					end
				end
				
				if signal and signal.aborted then return f end
				
				-- 1. INITIAL BRING (Teleport to player context)
				if hrp then
					local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
					if p then 
						p.CFrame = hrp.CFrame * CFrame.new(math.random(-5,5), math.random(2,5), math.random(-5,5))
						p.Velocity = Vector3.zero
					end
				end
				
				-- 2. START DRAG (Send server-side drag request)
				startDrag(item) 
				handleItemInteraction(item)

				-- 4. JOIN ANIMATION (Add to the items being updated by the logic)
				table.insert(f, item)
			end
		end
	end
	task.wait(0.01)
	return f
end

-- =========================================================================
-- ADMIN PANEL (HIDDEN)
-- =========================================================================
local AdminSeq = {core = 0, troll = 0, unlocked = false}
local AdminCat = nil
local AdminHeader = nil
local adminCode = "ifuhkadthisthenuterriblehahaHA"

local function createAdminTab()
    if AdminCat then return end
    local Content, Header = createCategory("Admin Panel (Restricted)", Color3.fromRGB(0, 0, 0))
    AdminCat = Content
    AdminHeader = Header
    AdminCat.Parent.Visible = false -- Start hidden

    local LoginFrame = Instance.new("Frame")
    LoginFrame.Size = UDim2.new(1, 0, 0, 80)
    LoginFrame.BackgroundColor3 = CurrentTheme.Tertiary
    LoginFrame.Parent = AdminCat
    Instance.new("UICorner", LoginFrame).CornerRadius = UDim.new(0, 8)

    local LoginBox = Instance.new("TextBox")
    LoginBox.PlaceholderText = "Enter Admin Key..."
    LoginBox.Size = UDim2.new(0.9, 0, 0, 35)
    LoginBox.Position = UDim2.new(0.05, 0, 0.1, 0)
    LoginBox.BackgroundColor3 = CurrentTheme.Secondary
    LoginBox.TextColor3 = CurrentTheme.Text
    LoginBox.Parent = LoginFrame
    Instance.new("UICorner", LoginBox).CornerRadius = UDim.new(0, 6)

    local LoginBtn = createButton(LoginFrame, "Unlock Panel", function()
        if LoginBox.Text == adminCode then
            LoginFrame:Destroy()
            notify("Access Granted", "Administrator privileges enabled.", "Success")
            
            -- Player Management Header
            local Label = Instance.new("TextLabel")
            Label.Text = "ACTIVE PLAYERS"
            Label.Size = UDim2.new(1, 0, 0, 30)
            Label.TextColor3 = CurrentTheme.Accent
            Label.Font = Enum.Font.GothamBold
            Label.Parent = AdminCat
            Label.BackgroundTransparency = 1

            -- Player Management UI
            local MessagingService = game:GetService("MessagingService")
            local GlobalUsers = {} -- { [Name] = {lastSeen = tick(), server = jobId} }

            local LocalLabel = Instance.new("TextLabel")
            LocalLabel.Text = "LOCAL SERVER PLAYERS"
            LocalLabel.Size = UDim2.new(1, 0, 0, 25)
            LocalLabel.TextColor3 = CurrentTheme.Accent
            LocalLabel.Font = Enum.Font.GothamBold
            LocalLabel.Parent = AdminCat
            LocalLabel.BackgroundTransparency = 1

            local LocalScroll = Instance.new("ScrollingFrame")
            LocalScroll.Size = UDim2.new(1, 0, 0, 140)
            LocalScroll.BackgroundColor3 = CurrentTheme.Secondary
            LocalScroll.BackgroundTransparency = 0.5
            LocalScroll.Parent = AdminCat
            Instance.new("UICorner", LocalScroll).CornerRadius = UDim.new(0, 8)
            local LocalLayout = Instance.new("UIListLayout", LocalScroll)
            LocalLayout.Padding = UDim.new(0, 4)

            local GlobalLabel = Instance.new("TextLabel")
            GlobalLabel.Text = "GLOBAL SCRIPT USERS (CROSS-SERVER)"
            GlobalLabel.Size = UDim2.new(1, 0, 0, 25)
            GlobalLabel.TextColor3 = Color3.fromRGB(255, 200, 0)
            GlobalLabel.Font = Enum.Font.GothamBold
            GlobalLabel.Parent = AdminCat
            GlobalLabel.BackgroundTransparency = 1

            local GlobalScroll = Instance.new("ScrollingFrame")
            GlobalScroll.Size = UDim2.new(1, 0, 0, 140)
            GlobalScroll.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
            GlobalScroll.BackgroundTransparency = 0.5
            GlobalScroll.Parent = AdminCat
            Instance.new("UICorner", GlobalScroll).CornerRadius = UDim.new(0, 8)
            local GlobalLayout = Instance.new("UIListLayout", GlobalScroll)
            GlobalLayout.Padding = UDim.new(0, 4)

            local function refreshUI()
                -- Refresh Local
                for _, child in ipairs(LocalScroll:GetChildren()) do if child:IsA("Frame") then child:Destroy() end end
                for _, p in ipairs(Players:GetPlayers()) do
                    local isUser = isScriptUser(p)
                    local pf = Instance.new("Frame")
                    pf.Size = UDim2.new(1, -8, 0, 36)
                    pf.BackgroundColor3 = isUser and Color3.fromRGB(30, 40, 60) or CurrentTheme.Tertiary
                    pf.Parent = LocalScroll
                    Instance.new("UICorner", pf).CornerRadius = UDim.new(0, 6)
                    
                    local pl = Instance.new("TextLabel")
                    pl.Text = p.Name .. (isUser and " [SCRIPT]" or "")
                    pl.Size = UDim2.new(0.6, 0, 1, 0)
                    pl.Position = UDim2.new(0, 8, 0, 0)
                    pl.BackgroundTransparency = 1
                    pl.TextColor3 = isUser and CurrentTheme.Success or CurrentTheme.Text
                    pl.TextXAlignment = Enum.TextXAlignment.Left
                    pl.Parent = pf

                    local kickBtn = createButton(pf, "KICK", function()
                        if p ~= LocalPlayer then pcall(function() p:Kick("Local Admin Action") end) end
                    end)
                    kickBtn.Size = UDim2.new(0.2, 0, 0.7, 0)
                    kickBtn.Position = UDim2.new(0.78, 0, 0.15, 0)
                    kickBtn.BackgroundColor3 = CurrentTheme.Error
                end
                LocalScroll.CanvasSize = UDim2.new(0,0,0, LocalLayout.AbsoluteContentSize.Y + 10)

                -- Refresh Global
                for _, child in ipairs(GlobalScroll:GetChildren()) do if child:IsA("Frame") then child:Destroy() end end
                local count = 0
                for Name, data in pairs(GlobalUsers) do
                    if tick() - data.lastSeen < 130 then
                        count = count + 1
                        local gf = Instance.new("Frame")
                        gf.Size = UDim2.new(1, -8, 0, 40)
                        gf.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
                        gf.Parent = GlobalScroll
                        Instance.new("UICorner", gf).CornerRadius = UDim.new(0, 6)
                        
                        local gl = Instance.new("TextLabel")
                        gl.Text = "ðŸŒ " .. Name
                        gl.Size = UDim2.new(0.45, 0, 1, 0)
                        gl.Position = UDim2.new(0, 10, 0, 0)
                        gl.BackgroundTransparency = 1
                        gl.TextColor3 = Color3.fromRGB(200, 200, 255)
                        gl.TextXAlignment = Enum.TextXAlignment.Left
                        gl.Parent = gf

                        local gMsg = createButton(gf, "ALERT", function()
                            MessagingService:PublishAsync("Capatrolity_Admin", {Type = "Alert", Target = Name, Content = "Admin is watching you..."})
                        end)
                        gMsg.Size = UDim2.new(0.22, 0, 0.7, 0)
                        gMsg.Position = UDim2.new(0.5, 0, 0.15, 0)
                        gMsg.BackgroundColor3 = CurrentTheme.Accent

                        local gKick = createButton(gf, "G-KICK", function()
                            MessagingService:PublishAsync("Capatrolity_Admin", {Type = "Kick", Target = Name})
                        end)
                        gKick.Size = UDim2.new(0.22, 0, 0.7, 0)
                        gKick.Position = UDim2.new(0.75, 0, 0.15, 0)
                        gKick.BackgroundColor3 = CurrentTheme.Error
                    end
                end
                if count == 0 then
                    local el = Instance.new("TextLabel")
                    el.Text = "Searching for global users..."
                    el.Size = UDim2.new(1, 0, 0, 25)
                    el.TextColor3 = CurrentTheme.TextDim
                    el.BackgroundTransparency = 1
                    el.Parent = GlobalScroll
                end
                GlobalScroll.CanvasSize = UDim2.new(0,0,0, GlobalLayout.AbsoluteContentSize.Y + 10)
            end
            
            -- GLOBAL LISTENERS
            MessagingService:SubscribeAsync("Capatrolity_Presence", function(msg)
                local data = msg.Data
                if type(data) == "table" and data.Name and data.Name ~= LocalPlayer.Name then
                    GlobalUsers[data.Name] = {lastSeen = tick(), server = data.JobId or "Unknown"}
                    refreshUI()
                end
            end)

            MessagingService:SubscribeAsync("Capatrolity_Admin", function(msg)
                local data = msg.Data
                if type(data) == "table" and data.Target == LocalPlayer.Name then
                    if data.Type == "Alert" then
                        notify("ADMIN MESSAGE", data.Content or "No content", "Warning")
                    elseif data.Type == "Kick" then
                        LocalPlayer:Kick("You have been globally kicked by an Administrator.")
                    end
                end
            end)

            -- HEARTBEAT & SYNC
            task.spawn(function()
                while true do
                    pcall(function() MessagingService:PublishAsync("Capatrolity_Presence", {Name = LocalPlayer.Name, JobId = game.JobId}) end)
                    task.wait(60)
                end
            end)

            createButton(AdminCat, "BroadCast Global Alert", function()
                local box = Instance.new("TextBox") -- Temporary input for simple broadcast
                MessagingService:PublishAsync("Capatrolity_Admin", {Type = "Alert", Content = "Global Announcement from Admin Hub!"})
                notify("Sent", "Broadcasted to all servers.", "Success")
            end)

            refreshUI()
            createButton(AdminCat, "Refresh All Lists", refreshUI)
        else
            notify("Access Denied", "Incorrect Administrator Key.", "Error")
        end
    end)
    LoginBtn.Parent = LoginFrame
    LoginBtn.Position = UDim2.new(0, 0, 0.55, 0)
end

local function checkAdminSequence(catName)
    if AdminCat and AdminCat.Parent.Visible then return end
    if catName == "Core & Survival" then
        AdminSeq.core = AdminSeq.core + 1
        if AdminSeq.core > 3 then AdminSeq.core = 1 end
    elseif catName == "Troll Settings" then
        if AdminSeq.core == 3 then
            AdminSeq.troll = AdminSeq.troll + 1
            if AdminSeq.troll == 1 then
                createAdminTab()
                AdminCat.Parent.Visible = true
                notify("Secret Found", "Hidden category revealed.", "Success")
            end
        else
            AdminSeq.core = 0
            AdminSeq.troll = 0
        end
    else
        AdminSeq.core = 0
        AdminSeq.troll = 0
    end
end

local function getTarget() return selectedPlayer or LocalPlayer end

-- =========================================================================
-- CATEGORY: CORE
-- =========================================================================
local CoreCat, CoreHeader = createCategory("Core & Survival", Color3.fromRGB(59, 130, 246))
CoreHeader.MouseButton1Click:Connect(function() checkAdminSequence("Core & Survival") end)

createToggle(CoreCat, "God Mode", function(v)
	getgenv().godmode = v
	task.spawn(function()
		while getgenv().godmode do
			local dmg = ReplicatedStorage:FindFirstChild("DamagePlayer", true)
			if dmg then pcall(function() dmg:FireServer(-9e9) end) end
			task.wait(0.5)
		end
	end)
end)




-- =========================================================================
-- CATEGORY: COMBAT & AURA
-- =========================================================================
local CombatCat = createCategory("Combat and Aura", Color3.fromRGB(239, 68, 68))

-- Kill Aura Weapon Selector
local KABtn = createButton(CombatCat, "Select Kill Aura Weapons", function() end)
local KAScroll = Instance.new("ScrollingFrame")
KAScroll.Size = UDim2.new(1, 0, 0, 100)
KAScroll.Visible = false
KAScroll.BackgroundColor3 = CurrentTheme.Tertiary
KAScroll.BackgroundTransparency = 0.5
KAScroll.Parent = CombatCat
Instance.new("UICorner", KAScroll).CornerRadius = UDim.new(0, 8)
local KALayout = Instance.new("UIListLayout", KAScroll)
KALayout.Padding = UDim.new(0, 3)

local function updateAuraSelector(scroll, btn, targetTable, prefix)
    for _, c in ipairs(scroll:GetChildren()) do if c:IsA("TextButton") then c:Destroy() end end
    
    local function addWeaponOption(name)
        local b = Instance.new("TextButton")
        b.Size = UDim2.new(1, -8, 0, 32)
        b.Position = UDim2.new(0, 4, 0, 0)
        b.BackgroundColor3 = CurrentTheme.Secondary
        b.BackgroundTransparency = 0.4
        b.Text = name
        b.TextColor3 = CurrentTheme.Text
        b.Font = Enum.Font.GothamMedium
        b.TextSize = 12
        b.Parent = scroll
        Instance.new("UICorner", b).CornerRadius = UDim.new(0, 6)
        b.MouseButton1Click:Connect(function()
            if name == "Reset (Use Held)" then
                table.clear(targetTable)
                btn.Text = "Select " .. prefix .. " Weapons"
            end
            scroll.Visible = false
        end)
    end
    
    addWeaponOption("Reset (Use Held)")
    local seen = {}
    local scanNodes = {LocalPlayer:FindFirstChild("Inventory"), LocalPlayer:FindFirstChild("Backpack")}
    for _, node in ipairs(scanNodes) do
        if node then
            for _, item in ipairs(node:GetChildren()) do
                if (item:IsA("Tool") or item:IsA("Model")) and not seen[item.Name] then
                    seen[item.Name] = true
                    local weaponName = item.Name
                    local isSel = false
                    for _, v in ipairs(targetTable) do if v == weaponName then isSel = true end end
                    
                    local b = Instance.new("TextButton")
                    b.Size = UDim2.new(1, -8, 0, 32)
                    b.Position = UDim2.new(0, 4, 0, 0)
                    b.BackgroundColor3 = isSel and CurrentTheme.Success or CurrentTheme.Secondary
                    b.BackgroundTransparency = 0.4
                    b.Text = weaponName .. (isSel and " [Queued]" or "")
                    b.TextColor3 = CurrentTheme.Text
                    b.Font = Enum.Font.GothamMedium
                    b.TextSize = 12
                    b.Parent = scroll
                    Instance.new("UICorner", b).CornerRadius = UDim.new(0, 6)
                    
                    b.MouseButton1Click:Connect(function()
                        local index = -1
                        for i, v in ipairs(targetTable) do if v == weaponName then index = i end end
                        if index ~= -1 then table.remove(targetTable, index)
                        elseif #targetTable < 2 then table.insert(targetTable, weaponName) end
                        
                        local text = prefix .. ": "
                        if #targetTable == 0 then text = text .. "Held Weapon"
                        else text = text .. table.concat(targetTable, " & ") end
                        btn.Text = text
                        scroll.Visible = false
                    end)
                end
            end
        end
    end
    scroll.CanvasSize = UDim2.new(0, 0, 0, (#scroll:GetChildren() * 35) + 35)
end

KABtn.MouseButton1Click:Connect(function()
    KAScroll.Visible = not KAScroll.Visible
    if KAScroll.Visible then updateAuraSelector(KAScroll, KABtn, getgenv().selectedKillAuraWeapons, "Kill Aura") end
end)

-- Tree Aura Weapon Selector
local TABtn = createButton(CombatCat, "Select Tree Aura Weapons", function() end)
local TAScroll = Instance.new("ScrollingFrame")
TAScroll.Size = UDim2.new(1, 0, 0, 100)
TAScroll.Visible = false
TAScroll.BackgroundColor3 = CurrentTheme.Tertiary
TAScroll.BackgroundTransparency = 0.5
TAScroll.Parent = CombatCat
Instance.new("UICorner", TAScroll).CornerRadius = UDim.new(0, 8)
local TALayout = Instance.new("UIListLayout", TAScroll)
TALayout.Padding = UDim.new(0, 3)

TABtn.MouseButton1Click:Connect(function()
    TAScroll.Visible = not TAScroll.Visible
    if TAScroll.Visible then updateAuraSelector(TAScroll, TABtn, getgenv().selectedTreeAuraWeapons, "Tree Aura") end
end)

createToggle(CombatCat, "Kill Aura", function(v)
	getgenv().killaura = v
	task.spawn(function()
		local remote = ReplicatedStorage:FindFirstChild("ToolDamageObject", true)
		while getgenv().killaura do
			local char = LocalPlayer.Character; local hrp = char and char:FindFirstChild("HumanoidRootPart")
			if hrp and remote then
				local inv = LocalPlayer:FindFirstChild("Inventory")
				local backpack = LocalPlayer:FindFirstChild("Backpack")
				local tools = {}
				
				-- Find selected tools in Character, Inv, or Backpack
				for _, wName in ipairs(getgenv().selectedKillAuraWeapons) do
					local t = char:FindFirstChild(wName) or (inv and inv:FindFirstChild(wName)) or (backpack and backpack:FindFirstChild(wName))
					if t then table.insert(tools, t) end
				end
				
				-- If none selected, use the currently held tool
				if #tools == 0 then
					local held = char:FindFirstChildWhichIsA("Tool")
					if held then tools = {held, held} end
				end
				
				if #tools > 0 then
					local enemyFolders = {workspace:FindFirstChild("Characters"), workspace:FindFirstChild("NPCs")}
					for _, folder in ipairs(enemyFolders) do
						for _, npc in ipairs(folder:GetChildren()) do
							if npc:IsA("Model") and npc ~= char then
								local hum = npc:FindFirstChildWhichIsA("Humanoid")
								if hum and hum.Health > 0 then
									if (npc:GetPivot().Position - hrp.Position).Magnitude < 150 then
										task.spawn(function()
											pcall(function() remote:InvokeServer(npc, tools[1], "1_" .. tostring(LocalPlayer.UserId), hrp.CFrame) end)
											task.wait(0.01)
											pcall(function() remote:InvokeServer(npc, tools[2] or tools[1], "1_" .. tostring(LocalPlayer.UserId), hrp.CFrame) end)
										end)
									end
								end
							end
						end
					end
				end
			end
			task.wait(0.6)
		end
	end)
end)

createToggle(CombatCat, "Tree Aura (All Trees)", function(v)
	getgenv().treeaura = v
	task.spawn(function()
		local remote = ReplicatedStorage:FindFirstChild("ToolDamageObject", true)
		while getgenv().treeaura do
			local char = LocalPlayer.Character; local hrp = char and char:FindFirstChild("HumanoidRootPart")
			if hrp and remote then
				local inv = LocalPlayer:FindFirstChild("Inventory")
				local backpack = LocalPlayer:FindFirstChild("Backpack")
				local tools = {}
				
				for _, wName in ipairs(getgenv().selectedTreeAuraWeapons) do
					local t = char:FindFirstChild(wName) or (inv and inv:FindFirstChild(wName)) or (backpack and backpack:FindFirstChild(wName))
					if t then table.insert(tools, t) end
				end
				
				if #tools == 0 then
					local held = char:FindFirstChildWhichIsA("Tool")
					if held then tools = {held, held} end
				end
				
				if #tools > 0 then
					local map = workspace:FindFirstChild("Map")
					local foliage = map and map:FindFirstChild("Foliage")
					if foliage then
						for _, tree in ipairs(foliage:GetChildren()) do
							local pos = (tree:IsA("Model") and tree:GetPivot().Position) or (tree:IsA("BasePart") and tree.Position)
							if pos and (pos - hrp.Position).Magnitude < 150 then
								task.spawn(function()
									pcall(function() remote:InvokeServer(tree, tools[1], "1_" .. tostring(LocalPlayer.UserId), hrp.CFrame) end)
									task.wait(0.01)
									pcall(function() remote:InvokeServer(tree, tools[2] or tools[1], "1_" .. tostring(LocalPlayer.UserId), hrp.CFrame) end)
								end)
							end
						end
					end
				end
			end
			task.wait(0.6)
		end
	end)
end)

createButton(CoreCat, "Bring All Items", function()
    local char = LocalPlayer.Character; local hrp = char and char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end
    for _, i in ipairs(workspaceItems:GetChildren()) do
		local n = i.Name:lower()
		if not n:find("chest") and not n:find("crate") and not isRestricted(i) then
			local p = (i:IsA("Model") and (i.PrimaryPart or i:FindFirstChildWhichIsA("BasePart"))) or (i:IsA("BasePart") and i)
			if p then 
				startDrag(i)
				p.CFrame = hrp.CFrame * CFrame.new(0, 3, -5)
				handleItemInteraction(i)
				task.wait() 
			end
		end
    end
end)

createButton(CoreCat, "Bring All Chests", function()
    local char = LocalPlayer.Character; local hrp = char and char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end
    
    local function isLoot(obj)
        local n = obj.Name:lower()
        if (n:find("chest") or n:find("crate")) and not isRestricted(obj) then return true end
        for _, child in ipairs(obj:GetDescendants()) do
            if child:IsA("MeshPart") or child:IsA("BasePart") or child:IsA("SpecialMesh") then
                local cn = child.Name:lower()
                if (cn:find("chest") or cn:find("crate")) and not isRestricted(obj) then return true end
            end
        end
        return false
    end

    local locs = {workspaceItems, LocalPlayer:FindFirstChild("Inventory")}
    for _, l in ipairs(locs) do
        if l then
            for _, i in ipairs(l:GetChildren()) do
                if isLoot(i) then
                    startDrag(i)
                    local tCF = hrp.CFrame * CFrame.new(0, 3, -8)
                    if i:IsA("Model") then i:PivotTo(tCF) end
                    local p = (i:IsA("Model") and (i.PrimaryPart or i:FindFirstChildWhichIsA("BasePart"))) or (i:IsA("BasePart") and i)
                    if p then 
                        p.CFrame = tCF; 
                        p.Velocity = Vector3.zero 
                    end
                    handleItemInteraction(i)
                    task.wait(0.02)
                end
            end
        end
    end
end)


-- Marker System
getgenv().markerActive = false
getgenv().markerPath = {}
local MarkerFolder = Instance.new("Folder", workspace)
MarkerFolder.Name = "CheatMarkers"

createButton(CoreCat, "Start/Stop Marker", function()
	getgenv().markerActive = not getgenv().markerActive
	if getgenv().markerActive then
		-- Start
		local lastPos = nil
		task.spawn(function()
			while getgenv().markerActive do
				local t = getTarget()
				local char = t.Character
				local hrp = char and char:FindFirstChild("HumanoidRootPart")
				if hrp then
					local currentPos = hrp.Position
					if not lastPos or (currentPos - lastPos).Magnitude >= (getgenv().MarkerSpacing or 0.1) then
						lastPos = currentPos
						table.insert(getgenv().markerPath, hrp.CFrame)
						
						-- Visual Marker
						local m = Instance.new("Part")
						m.Size = Vector3.new(0.5, 0.5, 0.5)
						m.Shape = Enum.PartType.Ball
						m.Anchored = true
						m.CanCollide = false
						m.Color = Color3.fromRGB(255, 0, 0)
						m.Material = Enum.Material.Neon
						m.Position = currentPos
						m.Parent = MarkerFolder
					end
				end
				task.wait()
			end
		end)
	end
end)

createButton(CoreCat, "Clear Markers", function()
	getgenv().markerActive = false
	getgenv().markerPath = {}
	MarkerFolder:ClearAllChildren()
end)

createButton(CoreCat, "Plant on Markers", function()
	local remote = ReplicatedStorage:FindFirstChild("ToolDamageObject", true)
	if not remote then return end
	
	local sap = findSaplingInstance()
	
	for _, cf in ipairs(getgenv().markerPath) do
		task.spawn(function()
			robustPlantCall(PlantRemote, sap, cf.Position)
		end)
	end
end)

-- =========================================================================
-- CATEGORY: VICTIM SELECTION
-- =========================================================================
local VictCat = createCategory("Victim Selection", Color3.fromRGB(239, 68, 68))

local VictimBtn = createButton(VictCat, "Select Victim (Self)", function() end)
local VictimScroll = Instance.new("ScrollingFrame")
VictimScroll.Size = UDim2.new(1, 0, 0, 120)
VictimScroll.Visible = false
VictimScroll.BackgroundTransparency = 1
VictimScroll.Parent = VictCat
Instance.new("UIListLayout", VictimScroll).Padding = UDim.new(0, 4)

VictimBtn.MouseButton1Click:Connect(function()
	VictimScroll.Visible = not VictimScroll.Visible
	for _, c in ipairs(VictimScroll:GetChildren()) do if c:IsA("TextButton") then c:Destroy() end end
	
	for _, p in ipairs(Players:GetPlayers()) do
		createButton(VictimScroll, p.Name, function()
			selectedPlayer = p
			VictimBtn.Text = "Victim: " .. p.Name
			VictimScroll.Visible = false
		end)
	end
end)

-- =========================================================================
-- TROLL SETTINGS (Item Selection, Interval, Spacing)
-- =========================================================================
local SettCat, SettHeader = createCategory("Troll Settings", Color3.fromRGB(168, 85, 247))
SettHeader.MouseButton1Click:Connect(function() checkAdminSequence("Troll Settings") end)

-- Item Selector Button
local ItemSelectorBtn = createButton(SettCat, "Select Animation Items", function() end)
local ItemScroll = Instance.new("ScrollingFrame")
ItemScroll.Size = UDim2.new(1, 0, 0, 150)
ItemScroll.Visible = false
ItemScroll.BackgroundColor3 = CurrentTheme.Tertiary
ItemScroll.BackgroundTransparency = 0.5
ItemScroll.ScrollBarThickness = 3
ItemScroll.Parent = SettCat
Instance.new("UICorner", ItemScroll).CornerRadius = UDim.new(0, 8)
local ItemScrollLayout = Instance.new("UIListLayout", ItemScroll)
ItemScrollLayout.Padding = UDim.new(0, 3)

ItemSelectorBtn.MouseButton1Click:Connect(function()
	ItemScroll.Visible = not ItemScroll.Visible
	local function refreshItemUI()
		for _, c in ipairs(ItemScroll:GetChildren()) do if c:IsA("TextButton") then c:Destroy() end end
		local function addItemOption(name)
			local isSel = TrollSelectedItems[name] or TrollSelectedItems["ALL"]
			local b = Instance.new("TextButton")
			b.Size = UDim2.new(1, -8, 0, 32)
			b.Position = UDim2.new(0, 4, 0, 0)
			b.BackgroundColor3 = isSel and CurrentTheme.Success or CurrentTheme.Tertiary
			b.BackgroundTransparency = isSel and 0.3 or 0.6
			b.Text = name
			b.TextColor3 = CurrentTheme.Text
			b.Font = Enum.Font.GothamMedium
			b.TextSize = 12
			b.Parent = ItemScroll
			Instance.new("UICorner", b).CornerRadius = UDim.new(0, 6)
			b.MouseButton1Click:Connect(function()
				if name == "ALL ITEMS" then TrollSelectedItems = {["ALL"] = true}
				else
					TrollSelectedItems["ALL"] = nil
					if TrollSelectedItems[name] then TrollSelectedItems[name] = nil else TrollSelectedItems[name] = true end
				end
				refreshItemUI()
			end)
		end
		addItemOption("ALL ITEMS")
		local found = {}
		for _, i in ipairs(workspaceItems:GetChildren()) do if not found[i.Name] then found[i.Name] = true; addItemOption(i.Name) end end
		ItemScroll.CanvasSize = UDim2.new(0, 0, 0, #ItemScroll:GetChildren() * 36)
	end
	if ItemScroll.Visible then refreshItemUI() end
end)

-- Interval Setting
local IntFrame = Instance.new("Frame")
IntFrame.Size = UDim2.new(1, 0, 0, 38)
IntFrame.BackgroundColor3 = CurrentTheme.Tertiary
IntFrame.Parent = SettCat
Instance.new("UICorner", IntFrame).CornerRadius = UDim.new(0, 8)
registerElement(IntFrame, {BackgroundColor3 = "Tertiary"})

local IntLabel = Instance.new("TextLabel")
IntLabel.Text = "Interval (sec):"
IntLabel.Size = UDim2.new(0.5, 0, 1, 0)
IntLabel.Position = UDim2.new(0, 12, 0, 0)
IntLabel.TextColor3 = CurrentTheme.Text
IntLabel.Font = Enum.Font.GothamMedium
IntLabel.TextSize = 13
IntLabel.TextXAlignment = Enum.TextXAlignment.Left
IntLabel.BackgroundTransparency = 1
IntLabel.Parent = IntFrame
registerElement(IntLabel, {TextColor3 = "Text"})

local IntBox = Instance.new("TextBox")
IntBox.Text = "0.1"
IntBox.Size = UDim2.new(0.4, 0, 0.7, 0)
IntBox.Position = UDim2.new(0.55, 0, 0.15, 0)
IntBox.BackgroundColor3 = CurrentTheme.Secondary
IntBox.TextColor3 = CurrentTheme.Text
IntBox.Font = Enum.Font.GothamBold
IntBox.TextSize = 14
IntBox.Parent = IntFrame
Instance.new("UICorner", IntBox).CornerRadius = UDim.new(0, 6)
registerElement(IntBox, {BackgroundColor3 = "Secondary", TextColor3 = "Text"})
IntBox.FocusLost:Connect(function() TrollAddInterval = tonumber(IntBox.Text) or 0.1 end)

-- Spacing Setting
local SpaceFrame = Instance.new("Frame")
SpaceFrame.Size = UDim2.new(1, 0, 0, 38)
SpaceFrame.BackgroundColor3 = CurrentTheme.Tertiary
SpaceFrame.Parent = SettCat
Instance.new("UICorner", SpaceFrame).CornerRadius = UDim.new(0, 8)
registerElement(SpaceFrame, {BackgroundColor3 = "Tertiary"})

local SpaceLabel = Instance.new("TextLabel")
SpaceLabel.Text = "Spacing:"
SpaceLabel.Size = UDim2.new(0.5, 0, 1, 0)
SpaceLabel.Position = UDim2.new(0, 12, 0, 0)
SpaceLabel.TextColor3 = CurrentTheme.Text
SpaceLabel.Font = Enum.Font.GothamMedium
SpaceLabel.TextSize = 13
SpaceLabel.TextXAlignment = Enum.TextXAlignment.Left
SpaceLabel.BackgroundTransparency = 1
SpaceLabel.Parent = SpaceFrame
registerElement(SpaceLabel, {TextColor3 = "Text"})

local SpaceBox = Instance.new("TextBox")
SpaceBox.Text = "2"
SpaceBox.Size = UDim2.new(0.4, 0, 0.7, 0)
SpaceBox.Position = UDim2.new(0.55, 0, 0.15, 0)
SpaceBox.BackgroundColor3 = CurrentTheme.Secondary
SpaceBox.TextColor3 = CurrentTheme.Text
SpaceBox.Font = Enum.Font.GothamBold
SpaceBox.TextSize = 14
SpaceBox.Parent = SpaceFrame
Instance.new("UICorner", SpaceBox).CornerRadius = UDim.new(0, 6)
registerElement(SpaceBox, {BackgroundColor3 = "Secondary", TextColor3 = "Text"})
SpaceBox.FocusLost:Connect(function() TrollSpacing = tonumber(SpaceBox.Text) or 2 end)

-- Marker Spacing Setting
local MarkerFrame = Instance.new("Frame")
MarkerFrame.Size = UDim2.new(1, 0, 0, 38)
MarkerFrame.BackgroundColor3 = CurrentTheme.Tertiary
MarkerFrame.Parent = SettCat
Instance.new("UICorner", MarkerFrame).CornerRadius = UDim.new(0, 8)
registerElement(MarkerFrame, {BackgroundColor3 = "Tertiary"})

local MarkerLabel = Instance.new("TextLabel")
MarkerLabel.Text = "Mark Space:"
MarkerLabel.Size = UDim2.new(0.5, 0, 1, 0)
MarkerLabel.Position = UDim2.new(0, 12, 0, 0)
MarkerLabel.TextColor3 = CurrentTheme.Text
MarkerLabel.Font = Enum.Font.GothamMedium
MarkerLabel.TextSize = 13
MarkerLabel.TextXAlignment = Enum.TextXAlignment.Left
MarkerLabel.BackgroundTransparency = 1
MarkerLabel.Parent = MarkerFrame
registerElement(MarkerLabel, {TextColor3 = "Text"})

local MarkerBox = Instance.new("TextBox")
MarkerBox.Text = "0.1"
MarkerBox.Size = UDim2.new(0.4, 0, 0.7, 0)
MarkerBox.Position = UDim2.new(0.55, 0, 0.15, 0)
MarkerBox.BackgroundColor3 = CurrentTheme.Secondary
MarkerBox.TextColor3 = CurrentTheme.Text
MarkerBox.Font = Enum.Font.GothamBold
MarkerBox.TextSize = 14
MarkerBox.Parent = MarkerFrame
Instance.new("UICorner", MarkerBox).CornerRadius = UDim.new(0, 6)
registerElement(MarkerBox, {BackgroundColor3 = "Secondary", TextColor3 = "Text"})
getgenv().MarkerSpacing = 0.1
MarkerBox.FocusLost:Connect(function() getgenv().MarkerSpacing = tonumber(MarkerBox.Text) or 0.1 end)

createToggle(SettCat, "Instant Bring (Bypass Interval)", function(v) getgenv().InstantBring = v end, false)

-- =========================================================================
-- BRING TROLLS (ALL 40+ Effects)
-- =========================================================================
local BringCat = createCategory("Troll: Bring Effects", Color3.fromRGB(249, 115, 22))

local function addBringTroll(name, updateFunc)
	local loop = nil
	local currentSignal = nil
	createToggle(BringCat, name, function(active)
		if active then
			if currentSignal then currentSignal.aborted = true end
			currentSignal = {aborted = false}
			local mySignal = currentSignal

			local activeItems = {}
			task.spawn(function() getTrollItems(activeItems, mySignal) end)
			
			loop = RunService.Heartbeat:Connect(function()
				if mySignal.aborted then return end
				local t = getTarget(); local char = t.Character; local hrp = char and char:FindFirstChild("HumanoidRootPart")
				if hrp then
					updateFunc(activeItems, hrp)
				end
			end)
		else
			if currentSignal then currentSignal.aborted = true; currentSignal = nil end
			if loop then loop:Disconnect(); loop = nil end
			for _, i in ipairs(workspaceItems:GetChildren()) do stopDrag(i) end
		end
	end)
end

-- Original effects
addBringTroll("Black Hole", function(its, hrp)
	local headPos = hrp.Position + Vector3.new(0, 5, 0)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then p.CFrame = CFrame.new(headPos + Vector3.new(math.sin(tick()+i)*7, math.cos((tick()+i)*1.3)*4, math.cos(tick()+i)*7)); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Item Wings", function(its, hrp)
	local flap = math.sin(tick() * 4) * 0.5
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local side = (i%2==0) and -1 or 1; local off = i/#its * 10
			p.CFrame = CFrame.new(hrp.Position + hrp.CFrame.RightVector * (side * (2 + off*0.5)) + hrp.CFrame.UpVector * (off*0.3) - hrp.CFrame.LookVector) * hrp.CFrame.Rotation * CFrame.Angles(0,0,flap*side)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("DNA Helix", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*2 + i*0.5; p.CFrame = CFrame.new(hrp.Position + Vector3.new(math.cos(t)*6, math.sin(t*0.5)*10, math.sin(t)*6)); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Item Fountain", function(its, hrp)
	local head = hrp.Position + Vector3.new(0,5,0)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = (tick()*1.5 + i*0.2) % 1; local h = t*15; local s = t*8; local a = i*137.5; p.CFrame = CFrame.new(head + Vector3.new(math.cos(a)*s, h-(h*h*0.05), math.sin(a)*s)); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Item Snake", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then p.CFrame = hrp.CFrame * CFrame.new(0, 0, 5 + i*3); p.Velocity = Vector3.zero end
    end
end)

addBringTroll("UFO Orbit", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*4 + (i * (math.pi*2/#its)); p.CFrame = CFrame.new(hrp.Position + Vector3.new(math.cos(t)*12, 10 + math.sin(tick()*2)*2, math.sin(t)*12)); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Item Cloak", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = i/#its * math.pi * 2; p.CFrame = hrp.CFrame * CFrame.new(math.cos(t)*2, math.sin(i)*3, math.sin(t)*2); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Hammer Strike", function(its, hrp)
	local targetP = hrp.Position + hrp.CFrame.LookVector * 5
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local swing = math.abs(math.sin(tick()*5)) * 15; p.CFrame = CFrame.new(targetP + Vector3.new(0, swing, 0)); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Item Tornado", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*5 + i; local h = (i/#its) * 20; p.CFrame = CFrame.new(hrp.Position + Vector3.new(math.cos(t)*(h/2), h-5, math.sin(t)*(h/2))); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Heart Orbit", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*2 + (i/#its * math.pi * 2); local x = 16 * math.sin(t)^3; local y = 13 * math.cos(t) - 5 * math.cos(2*t) - 2 * math.cos(3*t) - math.cos(4*t); p.CFrame = hrp.CFrame * CFrame.new(x/2, y/2 + 5, -5); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Vertical Gears", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*3 + i; local r = 8; p.CFrame = hrp.CFrame * CFrame.new(0, math.sin(t)*r, math.cos(t)*r); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Item Halo", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*2 + (i/#its * math.pi * 2); p.CFrame = hrp.CFrame * CFrame.new(math.cos(t)*4, 4, math.sin(t)*4) * CFrame.Angles(math.pi/2, 0, 0); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Satellite", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick() + i; local r = 15 + math.sin(tick())*5; p.CFrame = CFrame.new(hrp.Position + Vector3.new(math.cos(t)*r, math.sin(t*0.7)*5, math.sin(t)*r)); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Item Pulse", function(its, hrp)
	local r = 5 + math.sin(tick()*3)*5
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local a = (i/#its)*math.pi*2; p.CFrame = hrp.CFrame * CFrame.new(math.cos(a)*r, 0, math.sin(a)*r); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Head Spin", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then p.CFrame = hrp.CFrame * CFrame.new(0, 5, 0) * CFrame.Angles(0, tick()*10 + i, 0) * CFrame.new(3, 0, 0); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Item Cube", function(its, hrp)
	local size = 8
	local corners = {Vector3.new(1,1,1), Vector3.new(1,1,-1), Vector3.new(1,-1,1), Vector3.new(1,-1,-1), Vector3.new(-1,1,1), Vector3.new(-1,1,-1), Vector3.new(-1,-1,1), Vector3.new(-1,-1,-1)}
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local corner = corners[(i % 8) + 1] * (size/2); p.CFrame = hrp.CFrame * CFrame.new(corner); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Vertical Ring", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*2 + (i/#its * math.pi * 2); p.CFrame = hrp.CFrame * CFrame.new(0, math.sin(t)*10, math.cos(t)*10) * CFrame.Angles(t,0,0); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Item Tail", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local offset = hrp.CFrame.LookVector * -(5 + i*3) + hrp.CFrame.UpVector * (math.sin(tick()+i)*2); p.CFrame = CFrame.new(hrp.Position + offset); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Spin Blade", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*15 + (i/#its * math.pi * 2); p.CFrame = hrp.CFrame * CFrame.new(math.cos(t)*10, -3, math.sin(t)*10) * CFrame.Angles(0, t, 0); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Sky Vortex", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*3 + i; local r = 5 + (i/#its * 15); p.CFrame = CFrame.new(hrp.Position + Vector3.new(math.cos(t)*r, 20 + math.sin(t*0.5)*10, math.sin(t)*r)); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Front Wall", function(its, hrp)
	local side = math.ceil(math.sqrt(#its))
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local x = (i % side) * 2 - side; local y = math.floor(i / side) * 2; p.CFrame = hrp.CFrame * CFrame.new(x, y, -8); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Random Bounce", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick() + i; local bx = math.noise(t, 0, 0) * 15; local by = math.abs(math.noise(0, t, 0)) * 10; local bz = math.noise(0, 0, t) * 15; p.CFrame = CFrame.new(hrp.Position + Vector3.new(bx, by, bz)); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Pulse Shield", function(its, hrp)
	local r = 6 + math.sin(tick()*4)*4
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local a = (i/#its)*math.pi*2; p.CFrame = hrp.CFrame * CFrame.new(math.cos(a)*r, math.sin(i+tick())*3, math.sin(a)*r); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Star Orbit", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*2 + (i/#its * math.pi * 2); local r = 8 + math.sin(t*5)*3; p.CFrame = hrp.CFrame * CFrame.new(math.cos(t)*r, 2, math.sin(t)*r); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Chaos Swarm", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*8 + i*20; p.CFrame = CFrame.new(hrp.Position + Vector3.new(math.sin(t)*10, math.cos(t*1.2)*8, math.sin(t*0.8)*10)); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Double Helix", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local side = (i % 2 == 0) and 1 or -1; local t = tick()*3 + (i/#its * math.pi * 2); local h = (i/#its) * 20 - 10; p.CFrame = hrp.CFrame * CFrame.new(math.cos(t)*6 * side, h + 5, math.sin(t)*6 * side); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Infinity Orbit", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*2 + (i/#its * math.pi * 2); local x = math.sin(t) * 12; local z = math.sin(t) * math.cos(t) * 15; p.CFrame = hrp.CFrame * CFrame.new(x, 2, z); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Item Cape", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local x = (i % 5) * 1.5 - 3.75; local y = math.floor(i / 5) * -1.5 + 2; local sway = math.sin(tick() + i*0.5) * 2; p.CFrame = hrp.CFrame * CFrame.new(x, y, 1.5 + math.abs(y)*0.5) * CFrame.Angles(math.rad(sway), 0, 0); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Shield Array", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local ring = math.floor(i/8); local t = tick()*(2+ring) + (i % 8)/8 * math.pi * 2; local r = 5 + ring*4; p.CFrame = hrp.CFrame * CFrame.new(math.cos(t)*r, 1, math.sin(t)*r); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Item Shell", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local phi = math.acos(1 - 2 * (i/#its)); local theta = tick() + i * (math.pi * (3 - math.sqrt(5))); local r = 10; p.CFrame = CFrame.new(hrp.Position + Vector3.new(math.cos(theta)*math.sin(phi)*r, math.abs(math.cos(phi)*r), math.sin(theta)*math.sin(phi)*r)); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Pyramid Cage", function(its, hrp)
	local points = {Vector3.new(0,8,0), Vector3.new(6,0,6), Vector3.new(-6,0,6), Vector3.new(6,0,-6), Vector3.new(-6,0,-6)}
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local pt = points[(i % 5) + 1]; p.CFrame = hrp.CFrame * CFrame.new(pt); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Spinning Matrix", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local row = math.floor(i/5) % 5; local col = i % 5; local t = tick()*2; p.CFrame = hrp.CFrame * CFrame.Angles(t, t*0.5, t*0.3) * CFrame.new((col-2)*4, (row-2)*4, 10); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Item Lasso", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*5 + (i/#its * math.pi * 2); p.CFrame = hrp.CFrame * CFrame.new(math.cos(t)*15, 8, math.sin(t)*15) * CFrame.new(0, math.sin(t*2)*3, 0); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Vertical Ferris", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*1.5 + (i/#its * math.pi * 2); p.CFrame = hrp.CFrame * CFrame.new(0, math.sin(t)*12 + 5, math.cos(t)*12) * CFrame.Angles(-t, 0, 0); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Cross Swings", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*4; local side = (i % 2 == 0); local sway = math.sin(t)*8
			if side then p.CFrame = hrp.CFrame * CFrame.new(sway, 5, -8) else p.CFrame = hrp.CFrame * CFrame.new(8, sway + 5, 0) end
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Item Fan", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local a = math.sin(tick()) * (math.pi/2); local step = (i/#its) * 10 - 5; p.CFrame = hrp.CFrame * CFrame.Angles(0, a, 0) * CFrame.new(step, 2, -10); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Helix Floor", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*3 + (i*0.5); local r = i * 0.5; p.CFrame = hrp.CFrame * CFrame.new(math.cos(t)*r, -3.5, math.sin(t)*r); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Anchor Weight", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local x = (i % 4) - 1.5; local z = math.floor(i/4) % 4 - 1.5; p.CFrame = hrp.CFrame * CFrame.new(x*2, -10 - (math.floor(i/16)*2), z*2); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Royal Crown", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*2 + (i/#its * math.pi * 2); local r = 5; local h = 6 + math.sin(i*2)*1.5; p.CFrame = hrp.CFrame * CFrame.new(math.cos(t)*r, h, math.sin(t)*r) * CFrame.Angles(math.pi/4, 0, 0); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Chaos Cloud", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick() + i*1.3; local pos = Vector3.new(math.sin(t*0.9)*12, 5 + math.cos(t*1.1)*10, math.sin(t*0.7)*12); p.CFrame = CFrame.new(hrp.Position + pos); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Item Necklace", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = (i/#its - 0.5) * math.pi; p.CFrame = hrp.CFrame * CFrame.new(math.sin(t)*3, 2 - math.cos(t)*3, -1.5); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Backpack Clutter", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local x = (i % 3) * 1 - 1; local y = math.floor(i/3)%3 * 1; local z = 1 + math.floor(i/9)*1; p.CFrame = hrp.CFrame * CFrame.new(x, y, z); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Item Scissor", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*3; local side = (i%2==0) and 1 or -1; local angle = math.sin(t) * side * 1.2; p.CFrame = hrp.CFrame * CFrame.Angles(0, angle, 0) * CFrame.new(0, 2, -8); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Twister Base", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick()*10 + (i/#its * math.pi * 2); local r = 4 + (i/#its)*8; p.CFrame = hrp.CFrame * CFrame.new(math.cos(t)*r, -3, math.sin(t)*r); p.Velocity = Vector3.zero end
	end
end)

addBringTroll("Atom Spin", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then local t = tick() * 3 + i; local r = 8; local orbit = i % 3; local cf = hrp.CFrame
			if orbit == 0 then cf = cf * CFrame.Angles(t, 0, 0)
			elseif orbit == 1 then cf = cf * CFrame.Angles(0, t, 0)
			else cf = cf * CFrame.Angles(0, 0, t) end
			p.CFrame = cf * CFrame.new(0, 0, r); p.Velocity = Vector3.zero
		end
	end
end)

-- 15 NEW CREATIVE BRING TROLLS
addBringTroll("Solar System", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local planet = (i % 9) + 1
			local t = tick() * (10/planet)
			local r = planet * 2.5 + 4 -- Max ~27 studs (under 30)
			p.CFrame = hrp.CFrame * CFrame.new(math.cos(t)*r, 0, math.sin(t)*r) * CFrame.Angles(0, t*2, 0)
			p.Velocity = Vector3.zero 
		end
	end
end)

addBringTroll("DNA Strands", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local t = tick()*2 + (i*0.2)
			local x = math.sin(t) * 5
			local y = (i % 20) - 10
			local z = math.cos(t) * 5
			if i%2 == 0 then x = -x; z = -z end
			p.CFrame = hrp.CFrame * CFrame.new(x, y + 5, z)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Bouncing Cube", function(its, hrp)
	local size = 10
	local t = math.abs(math.sin(tick()*3)*10)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local x = (math.random()-0.5)*size
			local y = (math.random()-0.5)*size + t + 5
			local z = (math.random()-0.5)*size
			p.CFrame = hrp.CFrame * CFrame.new(x, y, z)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Gyro Rings", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local axis = i % 3
			local t = tick() + i
			local r = 10
			local cf = hrp.CFrame
			if axis == 0 then cf = cf * CFrame.Angles(t, 0, 0)
			elseif axis == 1 then cf = cf * CFrame.Angles(0, t, 0)
			else cf = cf * CFrame.Angles(0, 0, t) end
			p.CFrame = cf * CFrame.new(0, r, 0)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Hourglass", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local t = (tick() + i*0.05) % 4
			local y = 10 - t*5
			local r = math.abs(y) * 0.5 + 2
			local a = t * 10
			p.CFrame = hrp.CFrame * CFrame.new(math.cos(a)*r, y, math.sin(a)*r)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Fibonacci Spiral", function(its, hrp)
	local phi = (1 + math.sqrt(5)) / 2
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local r = math.sqrt(i) * 2
			local theta = i * 2 * math.pi * phi + tick()
			p.CFrame = hrp.CFrame * CFrame.new(r * math.cos(theta), 0, r * math.sin(theta))
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Electron Cloud", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local t = tick() * 5 + i
			local r = 8
			local a = math.sin(t*1.3) * math.pi
			local b = math.cos(t*0.7) * math.pi
			p.CFrame = hrp.CFrame * CFrame.new(math.sin(a)*math.cos(b)*r, math.sin(a)*math.sin(b)*r, math.cos(a)*r)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Smooth Snake", function(its, hrp)
	local t = tick()
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local lag = i * 0.1
			local pos = hrp.Position + Vector3.new(math.sin(t-lag)*10, 5 + math.cos((t-lag)*0.5)*5, math.cos(t-lag)*10)
			p.CFrame = CFrame.new(pos, hrp.Position)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Implosion", function(its, hrp)
	local r = (math.sin(tick()) + 1.2) * 15
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local phi = math.acos(1 - 2 * (i/#its))
			local theta = math.sqrt(#its * math.pi) * phi
			p.CFrame = hrp.CFrame * CFrame.new(math.sin(theta)*math.sin(phi)*r, math.cos(phi)*r, math.cos(theta)*math.sin(phi)*r)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Heavy Rain", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local h = (tick()*20 + i*5) % 40
			local x = (i % 10) * 3 - 15
			local z = (math.floor(i/10) % 10) * 3 - 15
			p.CFrame = hrp.CFrame * CFrame.new(x, 30 - h, z)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Heart Beat", function(its, hrp)
	local scale = 1 + math.sin(tick()*10)*0.2
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local t = (i/#its) * math.pi * 2
			local x = 16 * math.sin(t)^3
			local y = 13 * math.cos(t) - 5 * math.cos(2*t) - 2 * math.cos(3*t) - math.cos(4*t)
			p.CFrame = hrp.CFrame * CFrame.new(x*scale, y*scale + 5, -5)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Pendulum Wave", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local x = (i - #its/2) * 0.5
			local len = 10 + math.abs(x)
			local angle = math.sin(tick() * (1 + math.abs(x)*0.1)) * 0.8
			p.CFrame = hrp.CFrame * CFrame.new(x, 15, 0) * CFrame.Angles(angle, 0, 0) * CFrame.new(0, -len, 0)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Vortex Tunnel", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local depth = (i % 20) * 2
			local angle = tick() * 5 + i * 0.5
			local r = 5 + depth * 0.5
			p.CFrame = hrp.CFrame * CFrame.new(0, 0, -10) * CFrame.Angles(0, 0, angle) * CFrame.new(r, 0, -depth)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Chaotic Bounce", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local t = tick() + i
			local x = math.sin(t*1.1)*10
			local y = math.sin(t*1.7)*10
			local z = math.sin(t*2.3)*10
			p.CFrame = hrp.CFrame * CFrame.new(x, y+10, z) * CFrame.Angles(t, t, t)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Scanning Grid", function(its, hrp)
	local h = math.sin(tick()) * 10 + 5
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local row = math.floor(math.sqrt(#its))
			local x = (i % row) * 2 - row
			local z = math.floor(i / row) * 2 - row
			p.CFrame = hrp.CFrame * CFrame.new(x, h, z)
			p.Velocity = Vector3.zero
		end
	end
end)



-- =========================================================================
-- 50 NEW HANDCRAFTED BRING TROLLS
-- =========================================================================

-- Geometric & Mathematical
addBringTroll("Torus Knot", function(its, hrp)
	for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then local t=tick()+i*0.2; local r=5; local R=10; p.CFrame=hrp.CFrame*CFrame.new((R+r*math.cos(t*3))*math.cos(t*2), r*math.sin(t*3)+5, (R+r*math.cos(t*3))*math.sin(t*2)); p.Velocity=Vector3.zero end
    end
end)

addBringTroll("Figure 8 Strip", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then local t=tick()*2+i*0.5; p.CFrame=hrp.CFrame*CFrame.new(math.sin(t)*10, math.sin(t*2)*5+5, math.cos(t)*10); p.Velocity=Vector3.zero end
    end
end)

addBringTroll("Conic Spiral", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then local t=tick()*2+i*0.2; local h=(math.sin(t)+1)*5; local r=h; p.CFrame=hrp.CFrame*CFrame.new(math.cos(t)*r, h, math.sin(t)*r); p.Velocity=Vector3.zero end
    end
end)

addBringTroll("Ruler Line", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then local offset = (i-#its/2)*2; p.CFrame=hrp.CFrame*CFrame.new(offset, 5, -5); p.Velocity=Vector3.zero end
    end
end)

addBringTroll("Clock Face", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then local a = (i/#its)*math.pi*2 + tick(); p.CFrame=hrp.CFrame*CFrame.new(0, 5+math.sin(a)*8, math.cos(a)*8); p.Velocity=Vector3.zero end
    end
end)

addBringTroll("Wave Surface", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then local x = (i%5)*3-6; local z = math.floor(i/5)*3-6; local y = math.sin(tick()+x+z)*2+5; p.CFrame=hrp.CFrame*CFrame.new(x, y, z); p.Velocity=Vector3.zero end
    end
end)

addBringTroll("ðŸŽ¢ Rollercoaster", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then local t=tick()+i*0.1; p.CFrame=hrp.CFrame*CFrame.new(math.sin(t)*10, math.cos(t*2)*5+5, math.cos(t)*10); p.Velocity=Vector3.zero end
    end
end)

addBringTroll("Flying V", function(its, hrp)
     for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then local row = math.floor(i/2); local side = (i%2==0) and 1 or -1; p.CFrame=hrp.CFrame*CFrame.new(row*2*side, 5, -row*2); p.Velocity=Vector3.zero end
    end
end)

addBringTroll("Electron Shells", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local shell = (i%3)+1; local t=tick()*shell+i
            p.CFrame=hrp.CFrame*CFrame.Angles(t,t*0.5,0)*CFrame.new(0,0,shell*5); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Swarm Attack", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local dest = hrp.Position + hrp.CFrame.LookVector*10
            local noise = Vector3.new(math.sin(tick()*10+i)*3, math.cos(tick()*11+i)*3, math.sin(tick()*12+i)*3)
            p.CFrame=CFrame.new(dest + noise); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Chain Link", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local t = tick()*2
            local center = hrp.Position + Vector3.new(0, 5, 0)
            local offset = Vector3.new(math.cos(t+i*0.5)*5, (i-#its/2), math.sin(t+i*0.5)*5)
            p.CFrame=CFrame.new(center + offset); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Arrow Formation", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local z = -i*2
            local x = (i%2==0) and 2 or -2
            if i==1 then x=0 end
            p.CFrame=hrp.CFrame*CFrame.new(x, 5, z); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Wall Shield", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local row = math.floor(i/4)
            local col = i%4
            p.CFrame=hrp.CFrame*CFrame.new(col*3-4.5, row*3, -5); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Spider Web", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local ring = math.floor(i/6)+1
            local ang = (i%6) * (math.pi/3) + tick()*(ring%2==0 and 1 or -1)
            p.CFrame=hrp.CFrame*CFrame.new(math.cos(ang)*ring*3, 5, math.sin(ang)*ring*3); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Yoyo Trick", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local t = tick()*2
            local y = (math.sin(t)+1)*10
            p.CFrame=hrp.CFrame*CFrame.new(0, y, -5); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Hypno Disc", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local r = (i/#its)*10
            local a = r + tick()*5
            p.CFrame=hrp.CFrame*CFrame.new(math.cos(a)*r, 5, math.sin(a)*r); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Rain Cloud", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local x = (math.random()-0.5)*10
            local z = (math.random()-0.5)*10
            local y = 20 - (tick()*10 + i) % 15
            p.CFrame=hrp.CFrame*CFrame.new(x, y, z); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Ferris Wheel 2", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local a = (i/#its)*math.pi*2 + tick()
            p.CFrame=hrp.CFrame*CFrame.new(0, 10+math.sin(a)*10, math.cos(a)*10); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Horizontal DNA", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local x = (i-#its/2)*2
            local y = math.sin(tick()+i*0.5)*5 + 5
            local z = math.cos(tick()+i*0.5)*5
            p.CFrame=hrp.CFrame*CFrame.new(x, y, z); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Pool Rack", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            -- Simple triangle packing roughly
            local row = math.floor((-1 + math.sqrt(1 + 8*i))/2)
            local step = i - row*(row+1)/2
            p.CFrame=hrp.CFrame*CFrame.new(step*2 - row, 0, row*1.7) * CFrame.new(0,0,-15); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Radar Dish", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local r = (i/#its)*10
            local y = (r*r)/10
            local a = tick()*2 + i
            p.CFrame=hrp.CFrame*CFrame.new(math.cos(a)*r, y+2, math.sin(a)*r); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Dust Devil", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local h = (i/#its)*15
            local r = h/3 + 2
            local a = tick()*10 + h
            p.CFrame=hrp.CFrame*CFrame.new(math.cos(a)*r, h, math.sin(a)*r); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Balloon Float", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local sway = math.sin(tick() + i)*2
            local y = 10 + math.cos(tick()*0.5 + i)*2
            local r = math.sqrt(i)*2
            local a = i*2.4
            p.CFrame=hrp.CFrame*CFrame.new(math.cos(a)*r + sway, y, math.sin(a)*r); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Spotlight Scan", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local t = tick()*2
            local offset = Vector3.new(math.sin(t)*15, 0, math.cos(t*0.7)*15)
            local localOff = Vector3.new(math.random()-0.5, math.random()-0.5, math.random()-0.5)*5
            p.CFrame=hrp.CFrame*CFrame.new(offset + localOff); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Block Stack", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local h = i*2
            p.CFrame=hrp.CFrame*CFrame.new(0, h, -5); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Fireworks", function(its, hrp)
    local state = math.floor(tick())%2
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            if state == 0 then
                p.CFrame=hrp.CFrame*CFrame.new(0, i*0.5, -5) -- Launch
            else
                local r = (tick()%1)*20
                local phi = math.acos(1-2*(i/#its))
                local theta = math.sqrt(#its*math.pi)*phi
                p.CFrame=hrp.CFrame*CFrame.new(0, 10, -5)*CFrame.new(math.sin(theta)*math.sin(phi)*r, math.cos(phi)*r, math.cos(theta)*math.sin(phi)*r)
            end
            p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Magnet Pull", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local r = 20 - (tick()%5)*4
            local a = (i/#its)*math.pi*2
            p.CFrame=hrp.CFrame*CFrame.new(math.cos(a)*r, 5, math.sin(a)*r); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Race Track", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local t = tick()*5 + i*0.5
            p.CFrame=hrp.CFrame*CFrame.new(math.cos(t)*15, 2, math.sin(t*0.5)*10); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("UFO Fleet", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local x = (i%5)*5 - 10
            local z = math.floor(i/5)*5 - 10
            local hover = math.sin(tick()+i)*2
            p.CFrame=hrp.CFrame*CFrame.new(x, 15+hover, z); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Ball Bounce", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local t = tick() + i
            local y = math.abs(math.sin(t*3))*10
            local x = math.cos(t)*5
            p.CFrame=hrp.CFrame*CFrame.new(x, y, -10); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Galaxy Spiral", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local arms = 3
            local r = (i/#its)*20
            local a = r + tick() + (i%arms)*(math.pi*2/arms)
            p.CFrame=hrp.CFrame*CFrame.new(math.cos(a)*r, 5, math.sin(a)*r); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Mirror Wall", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local x = (i%10)*2 - 10
            local y = math.floor(i/10)*2
            p.CFrame=hrp.CFrame*CFrame.new(x, y, -5); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Cross Rotate", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local t = tick()
            local r = i*2
            if i%2==0 then
                p.CFrame=hrp.CFrame*CFrame.Angles(0,0,t)*CFrame.new(r, 0, -10)
            else
                p.CFrame=hrp.CFrame*CFrame.Angles(0,0,t)*CFrame.new(0, r, -10)
            end
            p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Cylinder Snake", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local t = tick()*5 + i*0.2
            p.CFrame=hrp.CFrame*CFrame.new(0, 5+math.cos(t)*5, -10+math.sin(t)*5); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Box Frame", function(its, hrp)
     local s = 10
     local pts = {}
     -- Generate box edges approximately
     for i=0, 1, 0.1 do table.insert(pts, Vector3.new(s, s*i, s)); table.insert(pts, Vector3.new(-s, s*i, s)) end
     -- (simplified to just distribute items on edges)
     for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
             local side = i%12
             local prog = (i/12)%1
             local x,y,z = 0,0,0
             if side < 4 then x=s; y=(side-2)*5; z=s else x=-s; y=0; z=0 end -- Crude
             p.CFrame=hrp.CFrame*CFrame.new(math.random(-s,s), math.random(0,s), math.random(-s,s)); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Gear Teeth", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local a = (i/#its)*math.pi*2 + tick()
            local r = 10 + (i%2)*2
            p.CFrame=hrp.CFrame*CFrame.new(math.cos(a)*r, 5, math.sin(a)*r); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Tornado Funnel", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local h = (i/#its)*20
            local r = h*0.5 + 2
            local a = tick()*10 + i
            p.CFrame=hrp.CFrame*CFrame.new(math.cos(a)*r, h, math.sin(a)*r); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Triangle Tunnel", function(its, hrp)
     for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local z = -i
            local side = i%3
            local r = 5
            local a = side * (math.pi*2/3) + tick()
            p.CFrame=hrp.CFrame*CFrame.new(math.cos(a)*r, 5+math.sin(a)*r, z); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Lissajous Curve", function(its, hrp)
     for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local t = tick() + i*0.1
            local x = 10 * math.sin(3*t + math.pi/2)
            local y = 10 * math.sin(2*t)
            p.CFrame=hrp.CFrame*CFrame.new(x, y+10, -5); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Moon Orbit", function(its, hrp)
     for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local t = tick()
            local r1 = 15; local r2 = 5
            local a1 = t; local a2 = t*3 + i
            local cx = math.cos(a1)*r1
            local cz = math.sin(a1)*r1
            p.CFrame=hrp.CFrame*CFrame.new(cx + math.cos(a2)*r2, 5, cz + math.sin(a2)*r2); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Circus Tent", function(its, hrp)
     for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local r = 10
            local a = (i/#its)*math.pi*2
            local h = 5 + (i%2)*5
            p.CFrame=hrp.CFrame*CFrame.new(math.cos(a)*r, h, math.sin(a)*r); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("RNA Single", function(its, hrp)
     for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local t = tick()*2 + i*0.2
            p.CFrame=hrp.CFrame*CFrame.new(math.cos(t)*5, i*0.5, math.sin(t)*5); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Phalanx", function(its, hrp)
      for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local row = math.floor(i/8)
            local col = i%8
            p.CFrame=hrp.CFrame*CFrame.new(col*2 - 8, 2, -row*2 - 5); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Twist Ring", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
           local r = 8
           local a = (i/#its)*math.pi*2 + tick()
           p.CFrame=hrp.CFrame*CFrame.new(math.cos(a)*r, 5 + math.sin(a*3)*2, math.sin(a)*r); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Vertical Loop", function(its, hrp)
     for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local t = tick()*2 + i*0.2
            p.CFrame=hrp.CFrame*CFrame.new(0, 10 + math.sin(t)*8, math.cos(t)*8); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Wind Blown", function(its, hrp)
     for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local offset = i*0.5
            local sway = math.sin(tick()+i*0.1)*3
            p.CFrame=hrp.CFrame*CFrame.new(sway, 5 + i*0.2, -offset); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Mobius Strip", function(its, hrp)
      for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local t = (i/#its)*math.pi*2 + tick()
            local r = 10
            local x = math.cos(t) * (1 + (tick()%1)*0.5 * math.cos(t/2))
            -- logic simplified for effect
            p.CFrame=hrp.CFrame*CFrame.new(math.cos(t)*r, math.sin(t/2)*5, math.sin(t)*r); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Balance Scales", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local side = (i%2==0) and 1 or -1
            local h = math.sin(tick())*5 * side
            p.CFrame=hrp.CFrame*CFrame.new(side*8, 10+h, -5); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Prayer Beads", function(its, hrp)
     for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local t = tick() + i * (math.pi*2 / #its)
            p.CFrame=hrp.CFrame*CFrame.new(0, 5, 0) * CFrame.Angles(t, t, 0) * CFrame.new(0, 8, 0); p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Orbital Rings", function(its, hrp)
    for i, item in ipairs(its) do
        local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
        if p then 
            local ring = i%3
            local r = 5 + ring*5
            local axis = Vector3.new(ring==0 and 1 or 0, ring==1 and 1 or 0, ring==2 and 1 or 0)
            local a = tick() + i
            if ring==0 then p.CFrame=hrp.CFrame*CFrame.Angles(a,0,0)*CFrame.new(0,r,0)
            elseif ring==1 then p.CFrame=hrp.CFrame*CFrame.Angles(0,a,0)*CFrame.new(r,0,0)
            else p.CFrame=hrp.CFrame*CFrame.Angles(0,0,a)*CFrame.new(0,r,0) end
            p.Velocity=Vector3.zero
        end
    end
end)

addBringTroll("Quad Helix", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local strand = i % 4
			local t = tick() * 3 + (i / #its * math.pi * 2)
			local x = math.cos(t) * 6
			local z = math.sin(t) * 6
			local y = (i / #its) * 20 - 10
			local angle = strand * (math.pi / 2)
			p.CFrame = hrp.CFrame * CFrame.Angles(0, angle, 0) * CFrame.new(x, y + 5, z)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Vortex Ring", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local t = tick() * 5 + (i / #its * math.pi * 2)
			local r = 8 + math.sin(tick() * 2) * 2
			p.CFrame = hrp.CFrame * CFrame.new(math.cos(t) * r, 2, math.sin(t) * r) * CFrame.Angles(t, 0, 0)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Jitter Box", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local x = math.random(-5, 5) + math.sin(tick() * 10 + i)
			local y = math.random(0, 10) + math.cos(tick() * 10 + i)
			local z = math.random(-5, 5) + math.sin(tick() * 12 + i)
			p.CFrame = hrp.CFrame * CFrame.new(x, y, z)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Eruption", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local t = (tick() + i * 0.1) % 2
			local r = t * 10
			local h = t * (4 - t) * 5
			local a = i * 137.5
			p.CFrame = hrp.CFrame * CFrame.new(math.cos(a) * r, h, math.sin(a) * r)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Ice Cube", function(its, hrp)
	local side = math.ceil(#its ^ (1/3))
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local x = (i % side) * 2 - side
			local y = (math.floor(i / side) % side) * 2
			local z = (math.floor(i / (side * side))) * 2 - 10
			p.CFrame = hrp.CFrame * CFrame.new(x, y, z)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Spiral Galaxy 2", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local r = (i / #its) * 25
			local a = r * 0.5 + tick() * 2
			p.CFrame = hrp.CFrame * CFrame.new(math.cos(a) * r, math.sin(r * 0.2 + tick()) * 2, math.sin(a) * r)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Dust Storm", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local t = tick() + i
			local r = 10 + math.sin(t * 0.5) * 5
			p.CFrame = hrp.CFrame * CFrame.new(math.sin(t * 1.1) * r, math.cos(t * 0.9) * 10 + 5, math.sin(t * 0.7) * r)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Mask Shape", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local t = (i / #its) * math.pi * 2
			local x = math.cos(t) * 5
			local y = math.sin(t) * 7 + 5
			local z = -5 + math.abs(math.sin(t)) * 2
			p.CFrame = hrp.CFrame * CFrame.new(x, y, z)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Dome Shield 3", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local phi = math.acos(math.random() * 1)
			local theta = math.random() * math.pi * 2 + tick()
			local r = 10
			p.CFrame = hrp.CFrame * CFrame.new(math.sin(phi) * math.cos(theta) * r, math.cos(phi) * r, math.sin(phi) * math.sin(theta) * r)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Whirlpool", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local t = (tick() + i * 0.1) % 5
			local r = t * 3
			local a = t * 10
			p.CFrame = hrp.CFrame * CFrame.new(math.cos(a) * r, -t, math.sin(a) * r)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Scaffolding", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local side = i % 4
			local h = math.floor(i / 4) * 2
			local x, z = 0, 0
			if side == 0 then x, z = 5, 5 elseif side == 1 then x, z = -5, 5 elseif side == 2 then x, z = -5, -5 else x, z = 5, -5 end
			p.CFrame = hrp.CFrame * CFrame.new(x, h, z)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Mothership", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			if i < 20 then
				local a = (i / 20) * math.pi * 2 + tick()
				p.CFrame = hrp.CFrame * CFrame.new(math.cos(a) * 15, 12, math.sin(a) * 15)
			else
				local t = tick() * 4 + i
				p.CFrame = hrp.CFrame * CFrame.new(math.cos(t) * 5, 15 + math.sin(t) * 2, math.sin(t) * 5)
			end
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Bullseye", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local ring = math.floor(i / 8) + 1
			local a = (i % 8) / 8 * math.pi * 2 + tick()
			p.CFrame = hrp.CFrame * CFrame.new(math.cos(a) * ring * 3, 5, -10)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Tsunami Wave", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local x = (i % 10) * 3 - 15
			local z = -20 + (tick() * 10 % 40)
			local y = math.sin(z * 0.5 + tick() * 5) * 5 + 5
			p.CFrame = hrp.CFrame * CFrame.new(x, y, z)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Tesla Coil 2", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local t = tick() * 20 + i
			local r = 5 + math.random() * 2
			p.CFrame = hrp.CFrame * CFrame.new(math.sin(t) * r, i * 0.5, math.cos(t) * r)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Eye Prism", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local a = (i / #its) * math.pi * 2 + tick()
			local r = 10
			p.CFrame = hrp.CFrame * CFrame.new(math.cos(a) * r, 5 + math.sin(tick()) * 3, -15)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Sliding Crate", function(its, hrp)
	local offset = math.sin(tick() * 2) * 10
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local x = (i % 5) * 2 - 4
			local y = math.floor(i / 5) * 2
			p.CFrame = hrp.CFrame * CFrame.new(x + offset, y, -10)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Cyclone Pillar", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local t = tick() * 15 + i
			local h = (i / #its) * 25
			p.CFrame = hrp.CFrame * CFrame.new(math.cos(t) * 3, h, math.sin(t) * 3)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Ground Helix 2", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local x = (i / #its) * 40 - 20
			local y = math.sin(x * 0.5 + tick() * 3) * 5
			local z = math.cos(x * 0.5 + tick() * 3) * 5
			p.CFrame = hrp.CFrame * CFrame.new(x, -3, z - 15)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Castle Turret", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local a = (i % 8) / 8 * math.pi * 2
			local h = math.floor(i / 8) * 2
			p.CFrame = hrp.CFrame * CFrame.new(math.cos(a) * 6, h, math.sin(a) * 6)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Abduction", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local t = (tick() + i * 0.1) % 3
			local h = t * 10
			local r = 2 + t
			local a = tick() * 5 + i
			p.CFrame = hrp.CFrame * CFrame.new(math.cos(a) * r, h, math.sin(a) * r)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Hurricane Eye", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local r = 5 + (i / #its) * 20
			local a = tick() * 4 + (i / #its * math.pi * 10)
			p.CFrame = hrp.CFrame * CFrame.new(math.cos(a) * r, 2, math.sin(a) * r)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Theater Arc", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local a = (i / #its - 0.5) * math.pi
			local r = 15
			p.CFrame = hrp.CFrame * CFrame.new(math.sin(a) * r, math.cos(a) * 5 + 5, -10)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Volley Rain", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local t = (tick() + i * 0.05) % 2
			local z = -20 + t * 15
			local y = 20 - t * 10
			local x = (math.random() - 0.5) * 10
			p.CFrame = hrp.CFrame * CFrame.new(x, y, z)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Spiral Tunnel 3", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local t = (i / #its) * 40 - 20
			local a = t + tick() * 5
			p.CFrame = hrp.CFrame * CFrame.new(math.cos(a) * 6, math.sin(a) * 6 + 5, -t)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Vertical Wheel 3", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local a = (i / #its) * math.pi * 2 + tick()
			p.CFrame = hrp.CFrame * CFrame.new(math.cos(a) * 12, math.sin(a) * 12 + 5, 0)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Orbital Matrix", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local t = tick() + i
			local r = 10
			p.CFrame = hrp.CFrame * CFrame.Angles(t * 0.1, t * 0.2, t * 0.3) * CFrame.new(r, 0, 0)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Cube Matrix", function(its, hrp)
	local s = 4
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local x = (i % s) * 3 - (s * 1.5)
			local y = (math.floor(i / s) % s) * 3
			local z = (math.floor(i / (s * s))) * 3 - 10
			p.CFrame = hrp.CFrame * CFrame.new(x, y, z) * CFrame.Angles(tick(), tick(), tick())
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Triple Helix 2", function(its, hrp)
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local strand = i % 3
			local t = tick() * 3 + (i / #its * math.pi * 2)
			local r = 6
			local x = math.cos(t + (strand * math.pi * 0.66)) * r
			local z = math.sin(t + (strand * math.pi * 0.66)) * r
			local y = (i / #its) * 20
			p.CFrame = hrp.CFrame * CFrame.new(x, y, z)
			p.Velocity = Vector3.zero
		end
	end
end)

addBringTroll("Pulsing Eye", function(its, hrp)
	local s = 1 + math.sin(tick() * 5) * 0.5
	for i, item in ipairs(its) do
		local p = (item:IsA("Model") and (item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart"))) or (item:IsA("BasePart") and item)
		if p then
			local a = (i / #its) * math.pi * 2
			p.CFrame = hrp.CFrame * CFrame.new(math.cos(a) * 10 * s, math.sin(a) * 10 * s + 5, -10)
			p.Velocity = Vector3.zero
		end
	end
end)


-- =========================================================================
-- PLANT TROLLS (ALL 40+ Effects)
-- =========================================================================
local PlantCat = createCategory("Troll: Plant Effects", Color3.fromRGB(34, 197, 94))

local function addPlantTroll(name, plantFunc)
	local loop = nil
	createToggle(PlantCat, name, function(active)
		if active then
			local sap = findSaplingInstance(); local last = 0
			loop = RunService.Heartbeat:Connect(function()
				if (tick()-last) < TrollAddInterval then return end; last = tick()
				local t = getTarget(); local char = t.Character; local hrp = char and char:FindFirstChild("HumanoidRootPart")
				if hrp then plantFunc(sap, hrp) end
			end)
		else
			if loop then loop:Disconnect(); loop = nil end
		end
	end)
end

addPlantTroll("Sapling Prison", function(sap, hrp)
	for i=1,10 do
		local a = (math.pi*2/10)*i + tick()*2; local p = hrp.Position + Vector3.new(math.cos(a)*4, -2, math.sin(a)*4)
		task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
	end
end)

addPlantTroll("Sapling Wall", function(sap, hrp)
	local base = hrp.Position + hrp.CFrame.LookVector*6
	for y=0,10,TrollSpacing do for x=-4,4,TrollSpacing do
		task.spawn(function() robustPlantCall(PlantRemote, sap, base + hrp.CFrame.RightVector*x + Vector3.new(0,y-2,0)) end)
	end end
end)

addPlantTroll("Sapling Pillar", function(sap, hrp)
	for i=1,10 do task.spawn(function() robustPlantCall(PlantRemote, sap, hrp.Position + Vector3.new(0, i*TrollSpacing - 2, 0)) end) end
end)

addPlantTroll("Sapling Dome", function(sap, hrp)
	for i=1,15 do
		local phi = math.acos(1-2*math.random()); local theta = math.random()*2*math.pi; local r = 8
		local p = hrp.Position + Vector3.new(math.cos(theta)*math.sin(phi)*r, math.abs(math.cos(phi)*r), math.sin(theta)*math.sin(phi)*r)
		task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
	end
end)

addPlantTroll("Orbital Strike", function(sap, hrp)
	for i=1,5 do task.spawn(function() robustPlantCall(PlantRemote, sap, hrp.Position + Vector3.new(0, 50-i*5, 0)) end) end
end)

addPlantTroll("Sapling Box", function(sap, hrp)
	local b = hrp.Position
	for x=-6,6,TrollSpacing * 2 do for y=0,8,TrollSpacing * 2 do for z=-6,6,TrollSpacing * 2 do
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, y-2, z)) end)
	end end end
end)

addPlantTroll("Sapling Spiral", function(sap, hrp)
	local t = tick()*5; local r = TrollSpacing * 2.5; local p = hrp.Position + Vector3.new(math.cos(t)*r, math.sin(t*0.5)*10, math.sin(t)*r)
	task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
end)

addPlantTroll("âŒ Ground X", function(sap, hrp)
	local b = hrp.Position
	for i=-10,10,TrollSpacing do
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(i, -2, i)) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(i, -2, -i)) end)
	end
end)

addPlantTroll("Ground Cross", function(sap, hrp)
	local b = hrp.Position
	for i=-10,10,TrollSpacing do
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(i, -2, 0)) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0, -2, i)) end)
	end
end)

addPlantTroll("Sapling Floor", function(sap, hrp)
	local b = hrp.Position
	for x=-8,8,TrollSpacing * 2 do for z=-8,8,TrollSpacing * 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, -2, z)) end) end end
end)

addPlantTroll("Staircase", function(sap, hrp)
	local p = hrp.Position + hrp.CFrame.LookVector*4 + Vector3.new(0, math.sin(tick())*5, 0)
	task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
end)

addPlantTroll("Infinite Rain", function(sap, hrp)
	local p = hrp.Position + Vector3.new(math.random(-10,10), 40, math.random(-10,10))
	task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
end)

addPlantTroll("Sapling Maze", function(sap, hrp)
	for i=1,5 do
		local p = hrp.Position + Vector3.new(math.random(-15,15), -2, math.random(-15,15))
		task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
	end
end)

addPlantTroll("Moving Wall", function(sap, hrp)
	local p = hrp.Position + hrp.CFrame.LookVector * (5 + math.sin(tick()*2)*5)
	for y=0,6,2 do task.spawn(function() robustPlantCall(PlantRemote, sap, p + Vector3.new(0,y,0)) end) end
end)

addPlantTroll("Sapling Sphere", function(sap, hrp)
	for i=1,20 do
		local phi = math.acos(1-2*math.random()); local theta = math.random()*2*math.pi; local r = 10
		local p = hrp.Position + Vector3.new(math.cos(theta)*math.sin(phi)*r, math.cos(phi)*r, math.sin(theta)*math.sin(phi)*r)
		task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
	end
end)

addPlantTroll("Outer Fence", function(sap, hrp)
	for a=0, 360, 20 do
		local rad = math.rad(a); local r = 15
		local p = hrp.Position + Vector3.new(math.cos(rad)*r, -2, math.sin(rad)*r)
		task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
	end
end)

addPlantTroll("Tight Cage", function(sap, hrp)
	local b = hrp.Position
	for x=-3,3,3 do for y=-1,5,3 do for z=-3,3,3 do
		if x == 0 and z == 0 and (y > -1 and y < 5) then continue end
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, y-1, z)) end)
	end end end
end)

addPlantTroll("Velocity Path", function(sap, hrp)
	local vel = hrp.AssemblyLinearVelocity
	if vel.Magnitude > 2 then
		local p = hrp.Position + vel.Unit * 8 - Vector3.new(0,2,0)
		task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
	end
end)

addPlantTroll("Ground Spike", function(sap, hrp)
	local b = hrp.Position
	for i=1,8 do
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0, i*2-4, 0)) end)
		for a=0, 360, 90 do
			local r = i; local rad = math.rad(a)
			task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*r, -2, math.sin(rad)*r)) end)
		end
	end
end)

addPlantTroll("Sine Wave", function(sap, hrp)
	for i=-15, 15, 3 do
		local z = math.sin(tick() + i/5) * 10
		local p = hrp.Position + hrp.CFrame.LookVector * i + hrp.CFrame.RightVector * z - Vector3.new(0,2,0)
		task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
	end
end)

addPlantTroll("Expanding Square", function(sap, hrp)
	local s = (tick()*5 % 20)
	for i=-s, s, TrollSpacing do
		task.spawn(function() robustPlantCall(PlantRemote, sap, hrp.Position + Vector3.new(i, -2, s)) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, hrp.Position + Vector3.new(i, -2, -s)) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, hrp.Position + Vector3.new(s, -2, i)) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, hrp.Position + Vector3.new(-s, -2, i)) end)
	end
end)

addPlantTroll("Hexagon Ring", function(sap, hrp)
	for a=0, 360, 60 do
		local rad = math.rad(a); local r = 12
		local p = hrp.Position + Vector3.new(math.cos(rad)*r, -2, math.sin(rad)*r)
		task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
	end
end)

addPlantTroll("Sky Bridge", function(sap, hrp)
	local p = hrp.Position + hrp.CFrame.LookVector * 10 + Vector3.new(0, 15, 0)
	for x=-4, 4, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, p + hrp.CFrame.RightVector * x) end) end
end)

addPlantTroll("ðŸš§ Waist Barrier", function(sap, hrp)
	local base = hrp.Position + hrp.CFrame.LookVector * 5
	for i=-6, 6, 2 do
		task.spawn(function() robustPlantCall(PlantRemote, sap, base + hrp.CFrame.RightVector * i + Vector3.new(0, 1, 0)) end)
	end
end)

addPlantTroll("ðŸ”º Prism Prison", function(sap, hrp)
	local b = hrp.Position
	for h=0, 8, 2 do
		for a=0, 360, 120 do
			local r = 6; local rad = math.rad(a)
			task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*r, h-2, math.sin(rad)*r)) end)
		end
	end
end)

addPlantTroll("â­ Ground Pentagram", function(sap, hrp)
	local b = hrp.Position; local r = 12
	for a=0, 360, 72 do
		local rad = math.rad(a)
		for step=0, r, 2 do
			task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*step, -2, math.sin(rad)*step)) end)
		end
	end
end)

addPlantTroll("ðŸ° Diagonal Wall", function(sap, hrp)
	local base = hrp.Position + hrp.CFrame.LookVector * 6
	for i=-5, 5 do
		local pos = base + hrp.CFrame.RightVector * i + Vector3.new(0, i + 3, 0)
		task.spawn(function() robustPlantCall(PlantRemote, sap, pos) end)
	end
end)

addPlantTroll("â™Ÿï¸ Checker Floor", function(sap, hrp)
	local b = hrp.Position
	for x=-12, 12, 4 do for z=-12, 12, 4 do
		if (x+z) % 8 == 0 then task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, -2, z)) end) end
	end end
end)

addPlantTroll("ðŸ  Sky Roof", function(sap, hrp)
	local b = hrp.Position + Vector3.new(0, 12, 0)
	for x=-10, 10, 3 do for z=-10, 10, 3 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, 0, z)) end) end end
end)

addPlantTroll("ðŸ•³ï¸ Deep Trench", function(sap, hrp)
	for i=1, 10 do
		local a = math.rad(i * 36)
		task.spawn(function() robustPlantCall(PlantRemote, sap, hrp.Position + Vector3.new(math.cos(a)*8, -15, math.sin(a)*8)) end)
	end
end)

addPlantTroll("ðŸŒ² Forest Trail", function(sap, hrp)
	local p = hrp.Position - hrp.CFrame.LookVector * 8
	for i=1, 5 do
		local off = Vector3.new(math.random(-5,5), -2, math.random(-5,5))
		task.spawn(function() robustPlantCall(PlantRemote, sap, p + off) end)
	end
end)

addPlantTroll("ðŸ—¼ Log Spire", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector * 10
	for i=0, 15 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0, i*2-2, 0)) end) end
end)

addPlantTroll("âž• Moving Cross", function(sap, hrp)
	local t = tick() * 3
	local b = hrp.Position + Vector3.new(math.sin(t)*10, -2, math.cos(t)*10)
	for i=-6, 6, 2 do
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(i, 0, 0)) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0, 0, i)) end)
	end
end)

addPlantTroll("ðŸŒŠ Wave Wall", function(sap, hrp)
	local base = hrp.Position + hrp.CFrame.LookVector * 8
	for x=-8, 8, 2 do
		local y = math.sin(tick() + x/2) * 5 + 5
		task.spawn(function() robustPlantCall(PlantRemote, sap, base + hrp.CFrame.RightVector * x + Vector3.new(0, y-2, 0)) end)
	end
end)

addPlantTroll("ðŸŒ€ Spiral Staircase", function(sap, hrp)
	local b = hrp.Position
	for i=1, 25 do
		local a = i * 0.4; local r = 5
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(a)*r, i-2, math.sin(a)*r)) end)
	end
end)

addPlantTroll("ðŸŒ‹ Log Volcano", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector * 20
	for h=0, 15, 2 do
		local r = 10 - (h/15)*10
		for a=0, 360, 30 do
			local rad = math.rad(a)
			task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*r, h-2, math.sin(rad)*r)) end)
		end
	end
end)

addPlantTroll("ðŸ”³ Grid Cage", function(sap, hrp)
	local b = hrp.Position; local s = 10
	for x=-s, s, 5 do for y=0, s, 5 do for z=-s, s, 5 do
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, y-2, z)) end)
	end end end
end)

addPlantTroll("ðŸ’– Heart Shape", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector * 10
	for t = 0, math.pi*2, 0.2 do
		local x = 16 * math.sin(t)^3
		local y = 13 * math.cos(t) - 5 * math.cos(2*t) - 2 * math.cos(3*t) - math.cos(4*t)
		for z=-2, 2, 2 do
			task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x/3, y/3 + 5, z)) end)
		end
	end
end)

addPlantTroll("ðŸŒ´ Random Jungle", function(sap, hrp)
	for i=1, 50 do
		local p = hrp.Position + Vector3.new(math.random(-30,30), math.random(-5, 20), math.random(-30,30))
		task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
	end
end)

addPlantTroll("ðŸ§¬ Vertical DNA", function(sap, hrp)
	for i=1, 20 do
		local a = i * 0.5 + tick()
		task.spawn(function() robustPlantCall(PlantRemote, sap, hrp.Position + Vector3.new(math.cos(a)*4, i-2, math.sin(a)*4)) end)
	end
end)

addPlantTroll("ðŸ›ï¸ Log Tunnel", function(sap, hrp)
	local base = hrp.CFrame
	for i=1, 10 do
		local dist = i * 4
		for a=0, 360, 45 do
			local rad = math.rad(a); local r = 6
			task.spawn(function() robustPlantCall(PlantRemote, sap, (base * CFrame.new(math.cos(rad)*r, math.sin(rad)*r, -dist)).Position) end)
		end
	end
end)

addPlantTroll("ðŸª¦ Death Pit", function(sap, hrp)
	local b = hrp.Position
	for a=0, 360, 20 do
		local rad = math.rad(a); local r = 10
		for h=0, 10, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*r, h-5, math.sin(rad)*r)) end) end
	end
end)

addPlantTroll("âš¡ Random Pillar Storm", function(sap, hrp)
	for i=1, 10 do
		local p = hrp.Position + Vector3.new(math.random(-15,15), -2, math.random(-15,15))
		for y=0, 10, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, p + Vector3.new(0, y, 0)) end) end
	end
end)

-- 15 NEW CREATIVE PLANT TROLLS
addPlantTroll("ðŸŒ³ Fractal Tree", function(sap, hrp)
	local function branch(pos, dir, len, lvl)
		if lvl == 0 then return end
		local endP = pos + dir * len
		task.spawn(function() robustPlantCall(PlantRemote, sap, endP) end)
		branch(endP, (dir + Vector3.new(0.5,0,0)).Unit, len*0.8, lvl-1)
		branch(endP, (dir + Vector3.new(-0.5,0,0)).Unit, len*0.8, lvl-1)
		branch(endP, (dir + Vector3.new(0,0,0.5)).Unit, len*0.8, lvl-1)
		branch(endP, (dir + Vector3.new(0,0,-0.5)).Unit, len*0.8, lvl-1)
	end
	branch(hrp.Position, Vector3.new(0,1,0), 8, 3)
end)

addPlantTroll("ðŸ”º Sierpinski Triangle", function(sap, hrp)
	local function gasket(p1, p2, p3, lvl)
		if lvl == 0 then
			task.spawn(function() robustPlantCall(PlantRemote, sap, p1) end)
			task.spawn(function() robustPlantCall(PlantRemote, sap, p2) end)
			task.spawn(function() robustPlantCall(PlantRemote, sap, p3) end)
			return
		end
		local m1 = (p1+p2)/2
		local m2 = (p2+p3)/2
		local m3 = (p3+p1)/2
		gasket(p1, m1, m3, lvl-1)
		gasket(m1, p2, m2, lvl-1)
		gasket(m3, m2, p3, lvl-1)
	end
	local s = 20
	local p = hrp.Position - Vector3.new(0,2,0)
	gasket(p + Vector3.new(s,0,s), p + Vector3.new(-s,0,s), p + Vector3.new(0,0,-s), 3)
end)

addPlantTroll("â­• Crop Circles", function(sap, hrp)
	local b = hrp.Position - Vector3.new(0,2,0)
	for i=1, 5 do
		local r = i * 4
		for a=0, 360, 20 do
			local rad = math.rad(a)
			if i % 2 == 0 then rad = rad + math.rad(10) end
			task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*r, 0, math.sin(rad)*r)) end)
		end
	end
end)

addPlantTroll("ðŸŒ‹ Lava Floor", function(sap, hrp)
	local b = hrp.Position - Vector3.new(0,2,0)
	for i=1, 40 do
		local p = b + Vector3.new(math.random(-25,25), 0, math.random(-25,25))
		if (p-b).Magnitude > 5 then
			task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
		end
	end
end)

addPlantTroll("ðŸ—¼ Spiral Tower", function(sap, hrp)
	local b = hrp.Position
	for i=0, 30 do
		local a = i * 0.5
		local r = 5 - (i*0.1)
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(a)*r, i, math.sin(a)*r)) end)
	end
end)

addPlantTroll("ðŸ° Castle Wall", function(sap, hrp)
	local b = hrp.Position
	local r = 15
	for a=0, 360, 10 do
		local rad = math.rad(a)
		local h = (a % 40 < 20) and 6 or 3 -- Crenellations
		local p = b + Vector3.new(math.cos(rad)*r, -2, math.sin(rad)*r)
		for y=0, h, 3 do
			task.spawn(function() robustPlantCall(PlantRemote, sap, p + Vector3.new(0, y, 0)) end)
		end
	end
end)

addPlantTroll("ðŸ›¡ï¸ Dome Shield", function(sap, hrp)
	local b = hrp.Position
	local r = 12
	for phi = 0, math.pi/2, 0.3 do
		for theta = 0, 2*math.pi, 0.3 do
			if math.random() > 0.3 then -- Sparse dome
				local p = b + Vector3.new(math.sin(phi)*math.cos(theta)*r, math.cos(phi)*r, math.sin(phi)*math.sin(theta)*r)
				task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
			end
		end
	end
end)

addPlantTroll("â˜„ï¸ Meteor Shower", function(sap, hrp)
	local b = hrp.Position
	for i=1, 10 do
		local p = b + Vector3.new(math.random(-20,20), 50 + math.random(0,20), math.random(-20,20))
		task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
	end
end)

addPlantTroll("ðŸ“Œ Spike Trap", function(sap, hrp)
	local b = hrp.Position - Vector3.new(0,2,0)
	local t = math.floor(tick()) % 2
	if t == 0 then
		for x=-10,10,4 do for z=-10,10,4 do
			task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, 0, z)) end)
			task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, 3, z)) end)
		end end
	end
end)

addPlantTroll("ðŸŽ¯ Target Reticle", function(sap, hrp)
	local b = hrp.Position - Vector3.new(0,2,0)
	local t = (tick() * 5) % 25
	for a=0, 360, 30 do
		local rad = math.rad(a)
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*t, 0, math.sin(rad)*t)) end)
	end
end)

addPlantTroll("ðŸŒŠ Wave Ocean", function(sap, hrp)
	local b = hrp.Position - Vector3.new(0,2,0)
	local t = tick()
	for x=-15, 15, 3 do for z=-15, 15, 3 do
		local y = math.sin(x*0.2 + t) * math.cos(z*0.2 + t) * 3
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, y, z)) end)
	end end
end)

addPlantTroll("ðŸ’¾ Binary Code", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector * 10
	for row=0, 8 do
		local bits = math.random(0, 255)
		for col=0, 7 do
			if bit32.btest(bits, bit32.lshift(1, col)) then
				task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(col*2 - 8, row*2, 0)) end)
			end
		end
	end
end)

addPlantTroll("ðŸ§± Tetris Stack", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector * 10
	local shapes = {
		{Vector3.new(0,0,0), Vector3.new(2,0,0), Vector3.new(4,0,0), Vector3.new(6,0,0)}, -- I
		{Vector3.new(0,0,0), Vector3.new(2,0,0), Vector3.new(0,2,0), Vector3.new(2,2,0)}, -- O
		{Vector3.new(0,0,0), Vector3.new(2,0,0), Vector3.new(4,0,0), Vector3.new(2,2,0)}, -- T
	}
	for i=0, 4 do
		local shape = shapes[math.random(1, #shapes)]
		local off = Vector3.new(math.random(-2,2)*2, i*3, 0)
		for _, v in ipairs(shape) do
			task.spawn(function() robustPlantCall(PlantRemote, sap, b + off + v) end)
		end
	end
end)

addPlantTroll("âš™ï¸ Circular Saw", function(sap, hrp)
	local b = hrp.Position - Vector3.new(0,1,0)
	local t = tick() * 5
	for i=0, 7 do
		local a = t + (i/8)*math.pi*2
		local p1 = b + Vector3.new(math.cos(a)*2, 0, math.sin(a)*2)
		local p2 = b + Vector3.new(math.cos(a + 0.5)*8, 0, math.sin(a + 0.5)*8)
		task.spawn(function() robustPlantCall(PlantRemote, sap, p1) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, p2) end)
	end
end)

addPlantTroll("âš« Black Hole Void", function(sap, hrp)
	for i=1, 20 do
		local r = math.random() * 5
		local theta = math.random() * math.pi * 2
		local phi = math.random() * math.pi
		local p = hrp.Position + Vector3.new(math.sin(phi)*math.cos(theta)*r, math.cos(phi)*r, math.sin(phi)*math.sin(theta)*r)
		task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
	end
end)



-- =========================================================================
-- 50 NEW HANDCRAFTED PLANT TROLLS
-- =========================================================================

addPlantTroll("ðŸŒ¸ Flower Bloom", function(sap, hrp)
    local b = hrp.Position
    local petals = 8
    for i=0, petals-1 do
        local a = (i/petals)*math.pi*2 + tick()
        local r = 5 + math.sin(tick())*2
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(a)*r, 0, math.sin(a)*r)) end)
    end
end)

addPlantTroll("ðŸŒ€ Ground Spiral 2", function(sap, hrp)
    local b = hrp.Position
    for i=0, 20 do
        local a = i*0.5 - tick()*5
        local r = i*0.8
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(a)*r, 0, math.sin(a)*r)) end)
    end
end)

addPlantTroll("ðŸ“ Triangle Base", function(sap, hrp)
    local b = hrp.Position
    local r = 8
    for i=0, 2 do
        local a = i*(2*math.pi/3) + tick()
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(a)*r, 0, math.sin(a)*r)) end)
        -- midpoints
        local a2 = (i+0.5)*(2*math.pi/3) + tick()
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(a2)*(r/2), 0, math.sin(a2)*(r/2))) end)
    end
end)

addPlantTroll("ðŸ”³ Square Border", function(sap, hrp)
    local b = hrp.Position
    local s = 10
    for i=-s, s, 5 do
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(i, 0, s)) end)
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(i, 0, -s)) end)
        if math.abs(i) < s then
            task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(s, 0, i)) end)
            task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-s, 0, i)) end)
        end
    end
end)

addPlantTroll("ðŸ”ï¸ Pyramid 2", function(sap, hrp)
    local b = hrp.Position
    for h=0, 4 do
        local s = (4-h)*3
        local y = h*2
        -- corners
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(s, y, s)) end)
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-s, y, s)) end)
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(s, y, -s)) end)
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-s, y, -s)) end)
    end
end)

addPlantTroll("ðŸ§± Random Wall", function(sap, hrp)
    local b = hrp.Position + hrp.CFrame.LookVector*10
    for i=1, 10 do
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.random(-5,5)*2, math.random(0,5)*2, 0)) end)
    end
end)

addPlantTroll("ðŸŒ² Forest Cluster", function(sap, hrp)
    local b = hrp.Position
    for i=1, 8 do
        local a = math.random()*math.pi*2
        local r = math.random()*15
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(a)*r, 0, math.sin(a)*r)) end)
    end
end)

addPlantTroll("â›“ï¸ Line March", function(sap, hrp)
    local b = hrp.Position + hrp.CFrame.LookVector*(-10)
    for i=0, 10 do
         local p = b + hrp.CFrame.LookVector * (i*3)
         task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
    end
end)

addPlantTroll("âŒ X Marks Spot", function(sap, hrp)
    local b = hrp.Position
    for i=-10, 10, 4 do
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(i, 0, i)) end)
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(i, 0, -i)) end)
    end
end)

addPlantTroll("ðŸ›£ï¸ Road blockade", function(sap, hrp)
    local b = hrp.Position + hrp.CFrame.LookVector*5
    for i=-3, 3 do
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + hrp.CFrame.RightVector * (i*3)) end)
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + hrp.CFrame.RightVector * (i*3) + Vector3.new(0,3,0)) end)
    end
end)

addPlantTroll("Ritual Circle", function(sap, hrp)
    local b = hrp.Position
    local r = 8
    for i=0, 5 do
        local a = i*(math.pi/3)
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(a)*r, 0, math.sin(a)*r)) end)
    end
    task.spawn(function() robustPlantCall(PlantRemote, sap, b) end) -- Center
end)

addPlantTroll("Stairway Heaven", function(sap, hrp)
    local b = hrp.Position + hrp.CFrame.LookVector*5
    for i=0, 8 do
        local p = b + hrp.CFrame.LookVector*(i*2) + Vector3.new(0, i, 0)
        task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
    end
end)

addPlantTroll("Wave Path", function(sap, hrp)
    local b = hrp.Position - hrp.CFrame.RightVector*10
    for i=0, 20 do
        local off = hrp.CFrame.RightVector*i
        local y = math.sin(i*0.5 + tick())*3
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + off + Vector3.new(0, y, 0)) end)
    end
end)

addPlantTroll("House Frame", function(sap, hrp)
    local b = hrp.Position
    local s = 6
    -- floor corners
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(s, 0, s)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-s, 0, s)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(s, 0, -s)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-s, 0, -s)) end)
    -- roof peak
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0, 8, 0)) end)
end)

addPlantTroll("Shield Wall 2", function(sap, hrp)
    local b = hrp.Position + hrp.CFrame.LookVector*5
    local r = hrp.CFrame.RightVector
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + r*3) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b - r*3) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0,3,0)) end)
end)

addPlantTroll("Double Circle", function(sap, hrp)
    local b = hrp.Position
    for i=0, 315, 45 do
        local r1 = 6; local r2 = 12
        local rad = math.rad(i)
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*r1, 0, math.sin(rad)*r1)) end)
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*r2, 0, math.sin(rad)*r2)) end)
    end
end)

addPlantTroll("Dice 5", function(sap, hrp)
    local b = hrp.Position
    local s = 4
    task.spawn(function() robustPlantCall(PlantRemote, sap, b) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(s,0,s)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(s,0,-s)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(-s,0,s)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(-s,0,-s)) end)
end)

addPlantTroll("Zig Zag", function(sap, hrp)
    local b = hrp.Position
    for i=0, 10 do
        local x = (i%2==0) and 3 or -3
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + hrp.CFrame.LookVector*(i*3) + hrp.CFrame.RightVector*x) end)
    end
end)

addPlantTroll("Diamond Shape", function(sap, hrp)
    local b = hrp.Position
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(5,0,0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-5,0,0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0,0,5)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0,0,-5)) end)
end)

addPlantTroll("Arrow Head", function(sap, hrp)
    local b = hrp.Position + hrp.CFrame.LookVector*10
    task.spawn(function() robustPlantCall(PlantRemote, sap, b) end) -- Tip
    task.spawn(function() robustPlantCall(PlantRemote, sap, b - hrp.CFrame.LookVector*3 + hrp.CFrame.RightVector*3) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b - hrp.CFrame.LookVector*3 - hrp.CFrame.RightVector*3) end)
end)

addPlantTroll("Galaxy Dust", function(sap, hrp)
    local b = hrp.Position
    for i=1, 15 do
        local r = i*1.5
        local a = i*0.5 + tick()
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(a)*r, 0, math.sin(a)*r)) end)
    end
end)

addPlantTroll("Rain Drop Splash", function(sap, hrp)
    local b = hrp.Position
    for i=1, 8 do
        local r = (tick()*10 + i*2) % 15
        local a = math.random()*math.pi*2
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(a)*r, 0, math.sin(a)*r)) end)
    end
end)

addPlantTroll("Moving Target", function(sap, hrp)
    local b = hrp.Position
    local x = math.sin(tick())*10
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, 0, 0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x+2, 0, 0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x-2, 0, 0)) end)
end)

addPlantTroll("Signal Bars", function(sap, hrp)
    local b = hrp.Position
    for i=1, 4 do
        local h = i*2
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + hrp.CFrame.RightVector * (i*2) + Vector3.new(0, h, 0)) end)
    end
end)

addPlantTroll("Tetris L", function(sap, hrp)
    local b = hrp.Position + hrp.CFrame.LookVector*5
    task.spawn(function() robustPlantCall(PlantRemote, sap, b) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(0,2,0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(0,4,0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(2,0,0)) end)
end)

addPlantTroll("Tetris S", function(sap, hrp)
    local b = hrp.Position + hrp.CFrame.LookVector*5
    task.spawn(function() robustPlantCall(PlantRemote, sap, b) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(2,0,0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(2,2,0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(4,2,0)) end)
end)

addPlantTroll("Bridge Arch", function(sap, hrp)
    local b = hrp.Position + hrp.CFrame.RightVector*(-10)
    for i=0, 20 do
        local x = i
        local y = -((x-10)^2)/10 + 10 -- parabola
        if y > 0 then
             task.spawn(function() robustPlantCall(PlantRemote, sap, b + hrp.CFrame.RightVector*x + Vector3.new(0, y, 0)) end)
        end
    end
end)

addPlantTroll("ðŸŒ‹ Volcano Rim", function(sap, hrp)
    local b = hrp.Position
    for i=0, 315, 45 do
        local r = 8
        local rad = math.rad(i)
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*r, 4, math.sin(rad)*r)) end)
    end
end)

addPlantTroll("DNA Ladder", function(sap, hrp)
    local b = hrp.Position
    for i=0, 10 do
        local x = math.sin(i*0.5)*3
        local z = i*2
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, 0, z)) end)
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-x, 0, z)) end)
    end
end)

addPlantTroll("Pool Break", function(sap, hrp)
    local b = hrp.Position + hrp.CFrame.LookVector*5
    for row=0, 4 do
        for col=0, row do
            local offX = (col * 2) - row
            local offZ = row * 1.7
            task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(offX, 0, offZ)) end)
        end
    end
end)

addPlantTroll("Saturn Rings", function(sap, hrp)
    local b = hrp.Position
    task.spawn(function() robustPlantCall(PlantRemote, sap, b) end) -- Planet
    for i=0, 360, 30 do
         local rad = math.rad(i)
         local r = 10
         task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*r, 0, math.sin(rad)*r)) end)
    end
end)

addPlantTroll("Cactus Line", function(sap, hrp)
    local b = hrp.Position
    for i=-3, 3 do
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(i*3, math.random(0,2), 0)) end)
    end
end)

addPlantTroll("Black Hole 2", function(sap, hrp)
    local b = hrp.Position
    local r = 12 - (tick()%4)*3
    for i=0, 300, 60 do
        local rad = math.rad(i + tick()*50)
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*r, 0, math.sin(rad)*r)) end)
    end
end)

addPlantTroll("Box Trap", function(sap, hrp)
    local b = hrp.Position
    local s = 2
    for x=-s,s,2 do for z=-s,s,2 do
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, 0, z)) end)
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, 6, z)) end)
    end end
end)

addPlantTroll("Thunder Bolt", function(sap, hrp)
    local b = hrp.Position + Vector3.new(0, 10, 0)
    local curr = b
    for i=1, 5 do
        local nxt = curr + Vector3.new(math.random(-2,2), -2, math.random(-2,2))
        task.spawn(function() robustPlantCall(PlantRemote, sap, nxt) end)
        curr = nxt
    end
end)

addPlantTroll("Snake Path", function(sap, hrp)
    local b = hrp.Position
    for i=0, 15 do
        local z = i*2
        local x = math.sin(i*0.5)*3
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, 0, z)) end)
    end
end)

addPlantTroll("Crane Arm", function(sap, hrp)
    local b = hrp.Position
    for i=0, 8 do
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0, i, 0)) end) -- Mast
    end
    for i=1, 6 do
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(i, 8, 0)) end) -- Jib
    end
end)

addPlantTroll("Eiffel Base", function(sap, hrp)
    local b = hrp.Position
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(5,0,5)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-5,0,5)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(5,0,-5)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-5,0,-5)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0,8,0)) end) -- Spire
end)

addPlantTroll("Canoe Shape", function(sap, hrp)
    local b = hrp.Position
    for i=-4, 4 do
        local w = 1 - math.abs(i)/5
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(w*2, 0, i*2)) end)
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-w*2, 0, i*2)) end)
    end
end)

addPlantTroll("Bird Formation", function(sap, hrp)
    local b = hrp.Position + Vector3.new(0, 10, 0)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-2, 0, -2)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(2, 0, -2)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-4, 0, -4)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(4, 0, -4)) end)
end)

addPlantTroll("Olymp Rings", function(sap, hrp)
    local b = hrp.Position
    -- Simplified 3 rings
    for i=-1, 1 do
        local c = b + Vector3.new(i*6, 5, 0)
        for a=0, 315, 45 do
            local r = 2.5
            task.spawn(function() robustPlantCall(PlantRemote, sap, c + Vector3.new(math.cos(math.rad(a))*r, math.sin(math.rad(a))*r, 0)) end)
        end
    end
end)

addPlantTroll("Traffic Light", function(sap, hrp)
    local b = hrp.Position
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0, 2, 0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0, 5, 0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0, 8, 0)) end)
end)

addPlantTroll("Chess Pawn", function(sap, hrp)
    local b = hrp.Position
    task.spawn(function() robustPlantCall(PlantRemote, sap, b) end) -- Base
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(1,0,0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(-1,0,0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(0,1,0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(0,2,0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(0,3,0)) end) -- Head
end)

addPlantTroll("Water Drop", function(sap, hrp)
    local b = hrp.Position
    -- Sphere-ish
    task.spawn(function() robustPlantCall(PlantRemote, sap, b) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(1,0,0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(-1,0,0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(0,0,1)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(0,0,-1)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b+Vector3.new(0,2,0)) end) -- Top
end)

addPlantTroll("Clock Ground", function(sap, hrp)
    local b = hrp.Position
    for i=0, 11 do
        local a = (i/12)*math.pi*2
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(a)*10, 0, math.sin(a)*10)) end)
    end
    -- Hands
    local t = (tick()%12) / 12 * math.pi*2
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(t)*5, 0, math.sin(t)*5)) end)
end)

addPlantTroll("Anchor Shape", function(sap, hrp)
    local b = hrp.Position
    for i=0, 6 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0, i, 0)) end) end -- Stem
    -- Curve
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(2, 0, 0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(4, 1, 0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-2, 0, 0)) end)
    task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-4, 1, 0)) end)
end)

addPlantTroll("Floor Web", function(sap, hrp)
    local b = hrp.Position
    for r=2, 10, 4 do
        for i=0, 5 do
             local a = i*(math.pi/3)
             task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(a)*r, 0, math.sin(a)*r)) end)
        end
    end
end)

addPlantTroll("Random Pillar 2", function(sap, hrp)
    local b = hrp.Position + Vector3.new(math.random(-10,10), 0, math.random(-10,10))
    for i=0, 8 do
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0, i, 0)) end)
    end
end)

addPlantTroll("Random Scatter 2", function(sap, hrp)
    local b = hrp.Position
    for i=1, 15 do
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.random(-15,15), math.random(0,5), math.random(-15,15))) end)
    end
end)

addPlantTroll("End Line", function(sap, hrp)
    local b = hrp.Position + hrp.CFrame.LookVector*10
    for i=-5, 5 do
        task.spawn(function() robustPlantCall(PlantRemote, sap, b + hrp.CFrame.RightVector*i) end)
    end
end)

addPlantTroll("Fortress", function(sap, hrp)
	local b = hrp.Position
	local s = 15
	for i=-s, s, 4 do
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(i, -2, s)) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(i, -2, -s)) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(s, -2, i)) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-s, -2, i)) end)
	end
end)

addPlantTroll("Pagoda", function(sap, hrp)
	local b = hrp.Position
	for h=0, 15, 3 do
		local s = 8 - (h/15)*8
		for x=-s, s, s*2 do for z=-s, s, s*2 do
			task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, h-2, z)) end)
		end end
	end
end)

addPlantTroll("Torii Gate", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector*8
	local r = hrp.CFrame.RightVector
	for y=0, 10, 2 do
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + r*4 + Vector3.new(0,y-2,0)) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, b - r*4 + Vector3.new(0,y-2,0)) end)
	end
	for x=-6, 6, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + r*x + Vector3.new(0,10,0)) end) end
end)

addPlantTroll("Moai Line", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.RightVector*10
	for i=1, 5 do
		local p = b - hrp.CFrame.RightVector*(i*5)
		for y=0, 6, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, p + Vector3.new(0,y-2,0)) end) end
	end
end)

addPlantTroll("Desert Garden", function(sap, hrp)
	for i=1, 20 do
		local p = hrp.Position + Vector3.new(math.random(-20,20), -2, math.random(-20,20))
		local h = math.random(2, 6)
		for y=0, h, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, p + Vector3.new(0,y,0)) end) end
	end
end)

addPlantTroll("Mushroom Ring", function(sap, hrp)
	local b = hrp.Position
	for a=0, 360, 30 do
		local rad = math.rad(a); local r = 8
		local p = b + Vector3.new(math.cos(rad)*r, -2, math.sin(rad)*r)
		task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, p + Vector3.new(0,2,0)) end)
	end
end)

addPlantTroll("Sunflower Field", function(sap, hrp)
	for x=-15, 15, 5 do for z=-15, 15, 5 do
		local p = hrp.Position + Vector3.new(x + math.random(-2,2), -2, z + math.random(-2,2))
		task.spawn(function() robustPlantCall(PlantRemote, sap, p) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, p + Vector3.new(0,4,0)) end)
	end end
end)

addPlantTroll("Pine Forest", function(sap, hrp)
	for i=1, 10 do
		local p = hrp.Position + Vector3.new(math.random(-25,25), -2, math.random(-25,25))
		for y=0, 10, 2 do
			local r = 5 - (y/10)*5
			for a=0, 360, 90 do
				local rad = math.rad(a)
				task.spawn(function() robustPlantCall(PlantRemote, sap, p + Vector3.new(math.cos(rad)*r, y, math.sin(rad)*r)) end)
			end
		end
	end
end)

addPlantTroll("Bamboo Grove", function(sap, hrp)
	for i=1, 30 do
		local p = hrp.Position + Vector3.new(math.random(-20,20), -2, math.random(-20,20))
		local h = math.random(10, 20)
		for y=0, h, 3 do task.spawn(function() robustPlantCall(PlantRemote, sap, p + Vector3.new(0,y,0)) end) end
	end
end)

addPlantTroll("Fern Gully", function(sap, hrp)
	local b = hrp.Position
	for i=1, 15 do
		local a = math.random()*math.pi*2; local r = math.random(5, 15)
		local p = b + Vector3.new(math.cos(a)*r, -2, math.sin(a)*r)
		for j=0, 3 do task.spawn(function() robustPlantCall(PlantRemote, sap, p + Vector3.new(j, j*0.5, 0)) end) end
	end
end)

addPlantTroll("Citadel", function(sap, hrp)
	local b = hrp.Position; local r = 20
	for a=0, 360, 15 do
		local rad = math.rad(a)
		local h = (a % 60 == 0) and 12 or 6
		for y=0, h, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*r, y-2, math.sin(rad)*r)) end) end
	end
end)

addPlantTroll("Lookout Tower", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector*15
	for y=0, 20, 2 do
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(2, y-2, 2)) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-2, y-2, 2)) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(2, y-2, -2)) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-2, y-2, -2)) end)
	end
	for x=-4, 4, 2 do for z=-4, 4, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, 20, z)) end) end end
end)

addPlantTroll("Cathedral", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector*20
	for x=-10, 10, 5 do for z=-20, 0, 5 do
		local h = (math.abs(x) == 10) and 15 or 8
		for y=0, h, 3 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, y-2, z)) end) end
	end end
end)

addPlantTroll("Pantheon", function(sap, hrp)
	local b = hrp.Position; local r = 15
	for a=0, 360, 30 do
		local rad = math.rad(a)
		for y=0, 10, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*r, y-2, math.sin(rad)*r)) end) end
	end
	for x=-r, r, 5 do for z=-r, r, 5 do if (x*x + z*z) <= r*r then task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, 10, z)) end) end end end
end)

addPlantTroll("Volcano Crater", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector*25
	for h=0, 12, 3 do
		local r = 15 - h
		for a=0, 360, 20 do
			local rad = math.rad(a)
			task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*r, h-2, math.sin(rad)*r)) end)
		end
	end
end)

addPlantTroll("Coral Reef", function(sap, hrp)
	for i=1, 40 do
		local p = hrp.Position + Vector3.new(math.random(-20,20), -2, math.random(-20,20))
		local h = math.random(1, 4)
		local c = Vector3.new(math.random(-1,1), 1, math.random(-1,1)).Unit
		for j=0, h do task.spawn(function() robustPlantCall(PlantRemote, sap, p + c*j*2) end) end
	end
end)

addPlantTroll("Glacier", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector*15
	for i=1, 20 do
		local off = Vector3.new(math.random(-10,10), 0, math.random(-10,10))
		local h = math.random(5, 15)
		for y=0, h, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + off + Vector3.new(0,y-2,0)) end) end
	end
end)

addPlantTroll("Dune", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector*10
	for x=-15, 15, 3 do
		local h = math.cos(x*0.2)*5 + 5
		for z=-5, 5, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, h-2, z)) end) end
	end
end)

addPlantTroll("Peak", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector*20
	for y=0, 20, 2 do
		local s = 10 - (y/20)*10
		for x=-s, s, s*2 do for z=-s, s, s*2 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, y-2, z)) end) end end
	end
end)

addPlantTroll("Viaduct", function(sap, hrp)
	local b = hrp.Position; local r = hrp.CFrame.RightVector; local l = hrp.CFrame.LookVector
	for i=0, 40, 5 do
		local p = b + l*i
		for y=0, 10, 2 do
			task.spawn(function() robustPlantCall(PlantRemote, sap, p + r*4 + Vector3.new(0,y-2,0)) end)
			task.spawn(function() robustPlantCall(PlantRemote, sap, p - r*4 + Vector3.new(0,y-2,0)) end)
		end
		for x=-4, 4, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, p + r*x + Vector3.new(0,10,0)) end) end
	end
end)

addPlantTroll("Arena", function(sap, hrp)
	local b = hrp.Position; local r = 25
	for a=0, 360, 10 do
		local rad = math.rad(a)
		for h=0, 8, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*(r+h), h-2, math.sin(rad)*(r+h))) end) end
	end
end)

addPlantTroll("Stage", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector*15
	for x=-10, 10, 2 do for z=-5, 5, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, -1, z)) end) end end
	for y=0, 10, 2 do
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(10, y, -5)) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-10, y, -5)) end)
	end
end)

addPlantTroll("Big Top", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector*20; local r = 15
	for a=0, 360, 20 do
		local rad = math.rad(a)
		for y=0, 8, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*r, y-2, math.sin(rad)*r)) end) end
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.cos(rad)*r*0.5, 15, math.sin(rad)*r*0.5)) end)
	end
	for y=8, 20, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0, y, 0)) end) end
end)

addPlantTroll("Fairground", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector*20
	for a=0, 360, 45 do
		local rad = math.rad(a); local r = 10
		local p = b + Vector3.new(0, 12 + math.sin(rad)*r, math.cos(rad)*r)
		for i=1, 3 do task.spawn(function() robustPlantCall(PlantRemote, sap, p) end) end
	end
	for y=0, 12, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0,y-2,0)) end) end
end)

addPlantTroll("Launchpad", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector*10
	for x=-6, 6, 2 do for z=-6, 6, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, -2, z)) end) end end
	for y=0, 15, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0, y, 0)) end) end
end)

addPlantTroll("Satellite Dish", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector*15
	for y=0, 6, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(0,y-2,0)) end) end
	for phi=0, math.pi/2, 0.4 do for theta=0, math.pi*2, 0.4 do
		local r = 8
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(math.sin(phi)*math.cos(theta)*r, 6 + math.cos(phi)*4, math.sin(phi)*math.sin(theta)*r)) end)
	end end
end)

addPlantTroll("Eiffel Tower", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector*20
	for y=0, 30, 3 do
		local s = 10 - (y/30)*10
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(s, y-2, s)) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-s, y-2, s)) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(s, y-2, -s)) end)
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(-s, y-2, -s)) end)
	end
end)

addPlantTroll("Bar Graph", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.RightVector*10
	for i=1, 10 do
		local h = i*2
		local p = b - hrp.CFrame.RightVector*(i*2)
		for y=0, h, 2 do task.spawn(function() robustPlantCall(PlantRemote, sap, p + Vector3.new(0,y-2,0)) end) end
	end
end)

addPlantTroll("Radio Array", function(sap, hrp)
	for i=1, 5 do
		local p = hrp.Position + Vector3.new(i*8, -2, 0)
		for y=0, 15, 3 do task.spawn(function() robustPlantCall(PlantRemote, sap, p + Vector3.new(0,y,0)) end) end
		task.spawn(function() robustPlantCall(PlantRemote, sap, p + Vector3.new(0,18,0)) end)
	end
end)

addPlantTroll("Storage Depot", function(sap, hrp)
	local b = hrp.Position + hrp.CFrame.LookVector*10
	for x=-8, 8, 4 do for y=0, 8, 4 do for z=-8, 8, 4 do
		task.spawn(function() robustPlantCall(PlantRemote, sap, b + Vector3.new(x, y-2, z)) end)
	end end end
end)


-- =========================================================================
-- SPECIAL ACTIONS (Ground Slam)
-- =========================================================================
-- =========================================================================
-- SPECIAL ACTIONS (Ground Slam)
-- =========================================================================
local SpecialCat = createCategory("Special Actions", Color3.fromRGB(251, 191, 36))

-- Max Items Setting
local MaxFrame = Instance.new("Frame")
MaxFrame.Size = UDim2.new(1, 0, 0, 38)
MaxFrame.BackgroundColor3 = CurrentTheme.Tertiary
MaxFrame.Parent = SpecialCat
Instance.new("UICorner", MaxFrame).CornerRadius = UDim.new(0, 8)
registerElement(MaxFrame, {BackgroundColor3 = "Tertiary"})

local MaxLabel = Instance.new("TextLabel")
MaxLabel.Text = "Max Bring Items:"
MaxLabel.Size = UDim2.new(0.5, 0, 1, 0)
MaxLabel.Position = UDim2.new(0, 12, 0, 0)
MaxLabel.TextColor3 = CurrentTheme.Text
MaxLabel.Font = Enum.Font.GothamMedium
MaxLabel.TextSize = 13
MaxLabel.TextXAlignment = Enum.TextXAlignment.Left
MaxLabel.BackgroundTransparency = 1
MaxLabel.Parent = MaxFrame
registerElement(MaxLabel, {TextColor3 = "Text"})

local MaxBox = Instance.new("TextBox")
MaxBox.Text = "1000000"
MaxBox.Size = UDim2.new(0.4, 0, 0.7, 0)
MaxBox.Position = UDim2.new(0.55, 0, 0.15, 0)
MaxBox.BackgroundColor3 = CurrentTheme.Secondary
MaxBox.TextColor3 = CurrentTheme.Text
MaxBox.Font = Enum.Font.GothamBold
MaxBox.TextSize = 14
MaxBox.Parent = MaxFrame
Instance.new("UICorner", MaxBox).CornerRadius = UDim.new(0, 6)
registerElement(MaxBox, {BackgroundColor3 = "Secondary", TextColor3 = "Text"})
MaxBox.FocusLost:Connect(function() getgenv().TrollMaxItems = tonumber(MaxBox.Text) or 1000000 end)

-- Custom R6 Animation System (no animation IDs)
-- Helper for getting motors
local function getMotors(char)
	local motors = {}
	if not char then return motors end
	local torso = char:FindFirstChild("Torso")
	if not torso then return motors end
	for _, m in ipairs(torso:GetChildren()) do if m:IsA("Motor6D") then motors[m.Name] = {m=m, C0=m.C0} end end
	if char:FindFirstChild("Head") then
		for _, m in ipairs(char.Head:GetChildren()) do if m:IsA("Motor6D") then motors[m.Name] = {m=m, C0=m.C0} end end
	end
	return motors
end

-- Helper to apply a pose to motors
local function applyPose(motors, pose)
	for motorName, cframe in pairs(pose) do
		if motors[motorName] then
			motors[motorName].m.C0 = motors[motorName].C0 * cframe
		end
	end
end

local function playGroundSlamAnimation(char)
	local motors = getMotors(char)
	local hrp = char:FindFirstChild("HumanoidRootPart")
	if not hrp then return 1.5 end
	
	task.spawn(function()
		local frames = {}
		-- 40 Frames of Meticulous Motion
		for i=1, 40 do
			local t = i/40
			if i <= 15 then -- WINDUP ARC
				local subT = i/15
				local ease = 1 - (1-subT)^3
				frames[i] = {
					RootJoint = CFrame.new(0, -0.5*ease, 0.2*ease) * CFrame.Angles(math.rad(-10*ease), 0, 0),
					["Right Shoulder"] = CFrame.Angles(math.rad(-160*ease), 0, math.rad(45*ease)),
					["Left Shoulder"] = CFrame.Angles(math.rad(-160*ease), 0, math.rad(-45*ease)),
					Neck = CFrame.Angles(math.rad(-20*ease), 0, 0)
				}
			elseif i <= 20 then -- HOLD/TENSION
				frames[i] = {
					RootJoint = CFrame.new(0, -0.6, 0.3) * CFrame.Angles(math.rad(-15), 0, 0),
					["Right Shoulder"] = CFrame.Angles(math.rad(-170), 0, math.rad(50)),
					["Left Shoulder"] = CFrame.Angles(math.rad(-170), 0, math.rad(-50)),
					Neck = CFrame.Angles(math.rad(-30), 0, 0)
				}
			elseif i <= 25 then -- SLAM SNAP
				local subT = (i-20)/5
				local ease = subT^4
				frames[i] = {
					RootJoint = CFrame.new(0, -2.5*ease, 1*ease) * CFrame.Angles(math.rad(80*ease), 0, 0),
					["Right Shoulder"] = CFrame.Angles(math.rad(60*ease), 0, 0),
					["Left Shoulder"] = CFrame.Angles(math.rad(60*ease), 0, 0),
					Neck = CFrame.Angles(math.rad(40*ease), 0, 0)
				}
			else -- RECOVERY
				frames[i] = frames[25]
			end
		end
		
		for i=1, 40 do
			if i > 25 then
				for name, data in pairs(motors) do
					data.m.C0 = data.m.C0:Lerp(data.C0, 0.15)
				end
			else
				applyPose(motors, frames[i])
			end
			task.wait(0.016)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
	return 0.4 -- Hit time
end

local function executeShockwaveSequence(hrp, items)
	if not hrp or #items == 0 then return end
	local center = hrp.Position
	return function()
		local start = tick()
		while tick()-start < 3 do
			local t = (tick()-start)/3
			local radius = 30 * math.sin(t * math.pi * 0.5) -- MAX 30 RADIUS
			for i, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local angle = (i/#items)*math.pi*2 + t*10
					local target = center + Vector3.new(math.cos(angle)*radius, 5*math.sin(t*math.pi), math.sin(angle)*radius)
					p.CFrame = p.CFrame:Lerp(CFrame.new(target), 0.2)
					p.Velocity = Vector3.zero
				end
			end
			task.wait()
		end
		for _, item in ipairs(items) do stopDrag(item) end
	end
end

createButton(SpecialCat, "GROUND SLAM", function()
	local char = LocalPlayer.Character
	local hrp = char and char:FindFirstChild("HumanoidRootPart")
	
	if not hrp then return end
	
	-- 1. Grab all items immediately
	local items = getTrollItems()
	
	notify("Ground Slam", "Charging...", "Success")
	
	-- 2. Pre-calculate shockwave function (closure with items)
	local triggerWave = executeShockwaveSequence(hrp, items)
	
	-- 3. Start Animation
	local hitDelay = playGroundSlamAnimation(char)
	
	-- 4. Wait for hit visual
	task.delay(hitDelay, function()
		-- Camera Shake
		local cam = workspace.CurrentCamera
		task.spawn(function()
			for i=1,10 do cam.CFrame = cam.CFrame * CFrame.new((math.random()-.5), (math.random()-.5), 0); task.wait() end
		end)
		
		-- Visual Ring
		task.spawn(function()
			local r = Instance.new("Part", workspace); r.Anchored=true; r.CanCollide=false; r.Shape="Cylinder"; r.Color=CurrentTheme.Accent; r.Material="Neon"; r.Transparency=0.2; r.Position=hrp.Position - Vector3.new(0,2.5,0); r.Orientation=Vector3.new(0,0,90)
			for i=1,20 do r.Size=Vector3.new(0.5, i*4, i*4); r.Transparency=0.2+(i/25); task.wait() end; r:Destroy()
		end)
		
		-- 5. Trigger Item Shockwave (Rise + Wave)
		if triggerWave then triggerWave() end
	end)
end)

createButton(SpecialCat, "INSTANT SHOCKWAVE", function()
	local char = LocalPlayer.Character
	local hrp = char and char:FindFirstChild("HumanoidRootPart")
	if not hrp then return end
	local items = getTrollItems()
	
	local wave = executeShockwaveSequence(hrp, items)
	if wave then wave() end
end)


-- =========================================================================
-- =========================================================================
-- SPECIAL ACTION: TORNADO (Realistic Mechanics)
-- =========================================================================
local function playTornadoAnim(char)
	local motors = {}
	for _, m in ipairs(char.Torso:GetChildren()) do if m:IsA("Motor6D") then motors[m.Name] = {m=m, C0=m.C0} end end
	
	local duration = 4.0
	task.spawn(function()
		local fps = 60
		local steps = duration * fps
		
		for i = 1, steps do
			local t = i / steps
			-- Cubic ease-in for spin speed (slow start -> fast)
			local spinSpeed = t * t * 50
			local spin = spinSpeed * math.pi
			
			-- Phase 1: Wind-Up (Anticipation)
			if t < 0.15 then
				local subT = t / 0.15
				local ease = 1 - (1 - subT) ^ 2 -- Quad Ease Out
				
				-- Crouch and coil opposite way
				if motors["RootJoint"] then 
					motors["RootJoint"].m.C0 = motors["RootJoint"].C0 * CFrame.new(0, -1 * ease, 0) * CFrame.Angles(0, math.rad(-60 * ease), math.rad(10 * ease))
				end
				-- Arms tight to body
				if motors["Right Shoulder"] then motors["Right Shoulder"].m.C0 = motors["Right Shoulder"].C0 * CFrame.Angles(0, 0, math.rad(-20 * ease)) end
				if motors["Left Shoulder"] then motors["Left Shoulder"].m.C0 = motors["Left Shoulder"].C0 * CFrame.Angles(0, 0, math.rad(20 * ease)) end
			else
				-- Phase 2: SPIN RELEASE
				local spinT = (t - 0.15) / 0.85
				
				if motors["RootJoint"] then
					-- Rise up + spin
					motors["RootJoint"].m.C0 = motors["RootJoint"].C0 * CFrame.new(0, math.sin(spinT*10)*0.5, 0) * CFrame.Angles(0, spin, math.rad(spinT*5))
				end
				
				-- Centrifugal force pulls arms out logic
				local force = math.min(1, spinT * 4) -- Arms fly out fast
				if motors["Right Shoulder"] then 
					motors["Right Shoulder"].m.C0 = motors["Right Shoulder"].C0 * CFrame.Angles(0, 0, math.rad(90 * force)) 
				end
				if motors["Left Shoulder"] then 
					motors["Left Shoulder"].m.C0 = motors["Left Shoulder"].C0 * CFrame.Angles(0, 0, math.rad(-90 * force)) 
				end
			end
			task.wait(1/fps)
		end
		
		-- Dizzy Recovery
		task.wait(0.2)
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
end

createButton(SpecialCat, "HUMAN TORNADO", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	
	notify("Tornado", "Spinning up!", "Success")
	playTornadoAnim(char)
	
	-- Item Effect
	task.spawn(function()
		-- Pre grab
		for _, item in ipairs(items) do startDrag(item); handleItemInteraction(item) end
		
		local start = tick()
		while tick() - start < 4.0 do
			local elapsed = tick() - start
			for i, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or (item:IsA("BasePart") and item)
				if p then
					local angle = (i * 0.5) + (elapsed * 10)
					local radius = 10 + (i % 5) * 2 + (elapsed * 2)
					local height = (math.sin(elapsed * 5 + i) * 5) + (elapsed * 2)
					
					local target = hrp.Position + Vector3.new(math.cos(angle)*radius, height, math.sin(angle)*radius)
					p.CFrame = p.CFrame:Lerp(CFrame.new(target) * CFrame.Angles(elapsed*5, elapsed, 0), 0.2)
					p.Velocity = Vector3.zero
				end
			end
			task.wait()
		end
	end)
end)

-- =========================================================================
-- SPECIAL ACTION: VOID IMPLOSION (Realistic Float & Snap)
-- =========================================================================
-- 2. VOID IMPLOSION (Masterpiece)
local function playVoidAnim(char)
	local motors = {}
	for _, m in ipairs(char.Torso:GetChildren()) do if m:IsA("Motor6D") then motors[m.Name] = {m=m, C0=m.C0} end end
	
	local function applyPose(motors, pose)
		for name, cf in pairs(pose) do
			if motors[name] then
				motors[name].m.C0 = motors[name].C0 * cf
			end
		end
	end

	task.spawn(function()
		local frames = {}
		for i=1, 60 do
			local t = i/60
			if i <= 40 then -- CHARGE
				local subT = i/40
				local ease = subT*subT*(3-2*subT)
				frames[i] = {
					RootJoint = CFrame.new(0, 4*ease, 0) * CFrame.Angles(math.rad(-30*ease), 0, 0),
					["Right Shoulder"] = CFrame.Angles(math.rad(20*ease), 0, math.rad(-45*ease)),
					["Left Shoulder"] = CFrame.Angles(math.rad(20*ease), 0, math.rad(45*ease)),
					["Right Hip"] = CFrame.Angles(math.rad(110*ease), 0, 0),
					["Left Hip"] = CFrame.Angles(math.rad(110*ease), 0, 0),
					Neck = CFrame.Angles(math.rad(30*ease), 0, 0)
				}
			elseif i <= 50 then -- TENSION
				local jitter = (math.random()-.5)*0.1
				frames[i] = { RootJoint = (frames[40] and frames[40].RootJoint or CFrame.new(0,4,0)) * CFrame.new(jitter, jitter, jitter) }
			else -- SNAP
				local subT = (i-50)/10
				local ease = 1 - (1-subT)^4
				frames[i] = {
					RootJoint = CFrame.new(0, 4, 0) * CFrame.Angles(math.rad(10), 0, 0),
					["Right Shoulder"] = CFrame.Angles(0, 0, math.rad(110*ease)),
					["Left Shoulder"] = CFrame.Angles(0, 0, math.rad(-110*ease)),
					["Right Hip"] = CFrame.Angles(math.rad(-20*ease), 0, math.rad(20*ease)),
					["Left Hip"] = CFrame.Angles(math.rad(-20*ease), 0, math.rad(-20*ease)),
					Neck = CFrame.Angles(math.rad(-40*ease), 0, 0)
				}
			end
		end
		for i=1, 60 do
			applyPose(motors, frames[i])
			task.wait(0.016)
		end
		task.wait(1)
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
	return 0.8 -- Sync time
end

createButton(SpecialCat, "VOID IMPLOSION", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	notify("Void", "Imploding reality...", "Success")
	playVoidAnim(char)
	task.spawn(function()
		local start = tick()
		while tick()-start < 1.4 do -- SUCK IN
			local radius = 30 * (1 - (tick()-start)/1.4)
			for i, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local angle = i + tick()*5
					local target = hrp.Position + Vector3.new(0, 3, 0) + Vector3.new(math.cos(angle)*radius, math.sin(tick()*3)*radius, math.sin(angle)*radius)
					p.CFrame = p.CFrame:Lerp(CFrame.new(target), 0.2)
					p.Velocity = Vector3.zero
				end
			end
			task.wait()
		end
		for _, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then p.Velocity = (p.Position - hrp.Position).Unit * 150 end -- Reduced velocity
		end
	end)
end)

-- 3. SPIRIT SPHERE (Masterpiece)
local function playSpiritAnim(char)
	local motors = getMotors(char)
	task.spawn(function()
		local frames = {}
		for i=1, 70 do
			local t = i/70
			if i <= 30 then -- LIFT ARC
				local subT = i/30
				local ease = 1 - (1-subT)^3
				local armX = (ease < 0.4) and math.rad(-100*(ease/0.4)) or math.rad(-100 - 60*((ease-0.4)/0.6))
				frames[i] = {
					RootJoint = CFrame.new(0, -0.5*ease, 0) * CFrame.Angles(math.rad(-10*ease), 0, 0),
					["Right Shoulder"] = CFrame.Angles(armX, 0, math.rad(-10*ease)),
					["Left Shoulder"] = CFrame.Angles(armX, 0, math.rad(10*ease)),
					Neck = CFrame.Angles(math.rad(-30*ease), 0, 0)
				}
			elseif i <= 55 then -- SHAKE/STRAIN
				local jitter = math.sin(i*0.5)*0.05
				frames[i] = {
					["Right Shoulder"] = (frames[30] and frames[30]["Right Shoulder"] or CFrame.Angles(math.rad(-160), 0, 0)) * CFrame.Angles(0,0,jitter),
					["Left Shoulder"] = (frames[30] and frames[30]["Left Shoulder"] or CFrame.Angles(math.rad(-160), 0, 0)) * CFrame.Angles(0,0,-jitter)
				}
			else -- THROW
				local subT = (i-55)/15
				local ease = 1 - (1-subT)^2
				frames[i] = {
					RootJoint = CFrame.new(0,0,-1*ease) * CFrame.Angles(math.rad(60*ease), 0, 0),
					["Right Shoulder"] = CFrame.Angles(math.rad(60),0,math.rad(-45)),
					["Left Shoulder"] = CFrame.Angles(math.rad(60),0,math.rad(45)),
					Neck = CFrame.Angles(math.rad(20*ease), 0, 0)
				}
			end
		end
		for i=1, 70 do
			applyPose(motors, frames[i])
			task.wait(0.016)
		end
		task.wait(0.5)
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
end

createButton(SpecialCat, "SPIRIT SPHERE", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	notify("Spirit", "Gathering energy...", "Success")
	playSpiritAnim(char)
	task.spawn(function()
		local start = tick()
		while tick()-start < 2.5 do
			for i, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local offset = 2 / #items
					local y = ((i * offset) - 1) + (offset / 2)
					local r = math.sqrt(1 - math.pow(y, 2))
					local phi = ((i + 1) % #items) * (math.pi*(3-math.sqrt(5)))
					local spherePos = Vector3.new(math.cos(phi)*r, y, math.sin(phi)*r) * 15 -- Radius 15 < 30
					local target = hrp.Position + Vector3.new(0, 25, 0) + (CFrame.Angles(0, tick(), 0) * spherePos)
					p.CFrame = p.CFrame:Lerp(CFrame.new(target), 0.1)
					p.Velocity = Vector3.zero
				end
			end
			task.wait()
		end
		local dir = hrp.CFrame.LookVector
		for _, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then p.Velocity = dir * 100 + Vector3.new(math.random(-10,10), math.random(-10,10), math.random(-10,10)) end
		end
	end)
end)

-- 4. GRAVITY DISK (Masterpiece)
local function playGravityAnim(char)
	local motors = getMotors(char)
	task.spawn(function()
		local frames = {}
		for i=1, 40 do
			if i <= 20 then -- REACH UP
				local subT = i/20
				local ease = subT*subT*(3-2*subT)
				frames[i] = {
					["Right Shoulder"] = CFrame.Angles(math.rad(-180*ease), 0, math.rad(-30*ease)),
					RootJoint = CFrame.new(0, 0.5*ease, 0) * CFrame.Angles(math.rad(-20*ease), 0, 0)
				}
			elseif i <= 25 then -- SLAM
				local subT = (i-20)/5
				frames[i] = {
					["Right Shoulder"] = CFrame.Angles(math.rad(-30), 0, 0),
					RootJoint = CFrame.new(0, -2, 0) * CFrame.Angles(math.rad(80), 0, 0)
				}
			else -- RECOVER
				frames[i] = frames[25]
			end
		end
		for i=1, 40 do
			if i <= 25 then 
				applyPose(motors, frames[i]) 
			else
				for name, data in pairs(motors) do data.m.C0 = data.m.C0:Lerp(data.C0, 0.1) end
			end
			task.wait(0.016)
		end
		task.wait(2)
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
end

createButton(SpecialCat, "GRAVITY DISK", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	notify("Gravity", "Compacting reality...", "Success")
	playGravityAnim(char)
	task.delay(0.35, function()
		local start = tick()
		while tick()-start < 2.5 do
			local t = (tick()-start)/2.5
			local radius = 30 * (1-t)
			for i, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local angle = (i * (math.pi*2 / #items)) + (tick() * (10 + t*20))
					local target = hrp.Position + hrp.CFrame.LookVector*5 + Vector3.new(math.cos(angle)*radius, -2.5, math.sin(angle)*radius)
					p.CFrame = p.CFrame:Lerp(CFrame.new(target) * CFrame.Angles(0, angle, 0), 0.2)
					p.Velocity = Vector3.zero
				end
			end
			task.wait()
		end
		for _, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then p.Velocity = (p.Position - hrp.Position).Unit * 250 end
			
		end
	end)
end)

-- 5. NEBULA SWEEP (Masterpiece)
createButton(SpecialCat, "NEBULA SWEEP", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	notify("Nebula", "Sweeping the cosmos...", "Success")
	local motors = getMotors(char)
	task.spawn(function()
		local frames = {}
		for i=1, 40 do
			local t = i/40
			local ease = t*t*(3-2*t)
			frames[i] = {
				RootJoint = CFrame.Angles(0, math.rad(540*ease), math.rad(10*math.sin(t*math.pi))),
				["Right Shoulder"] = CFrame.Angles(0, 0, math.rad(90))
			}
		end
		for i=1, 40 do
			applyPose(motors, frames[i])
			task.wait(0.016)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
	task.spawn(function()
		local start = tick()
		while tick()-start < 1.5 do
			for i, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local angle = (i/#items)*math.pi*2 + tick()*8
					local radius = 30 * (i/#items) -- MAX 30 RULE
					local target = hrp.Position + Vector3.new(math.cos(angle)*radius, 2 + math.sin(tick()+i), math.sin(angle)*radius)
					p.CFrame = p.CFrame:Lerp(CFrame.new(target), 0.2)
					p.Velocity = Vector3.zero
				end
			end
			task.wait()
		end
		for _, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then p.Velocity = (hrp.CFrame.LookVector + Vector3.new(0,0.5,0)) * 250 end
			
		end
	end)
end)

-- 6. ATMOSPHERIC CRASH (Masterpiece)
createButton(SpecialCat, "ATMOSPHERIC CRASH", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	notify("Atmosphere", "Rain down vengeance...", "Success")
	local motors = getMotors(char)
	task.spawn(function()
		local frames = {}
		for i=1, 50 do
			local t = i/50
			if i <= 30 then -- CALL
				local subT = i/30
				local ease = subT*subT*(3-2*subT)
				frames[i] = {
					["Right Shoulder"] = CFrame.Angles(math.rad(-180*ease), 0, 0),
					["Left Shoulder"] = CFrame.Angles(math.rad(-180*ease), 0, 0),
					Neck = CFrame.Angles(math.rad(-40*ease), 0, 0),
					RootJoint = CFrame.Angles(math.rad(-10*ease), 0, 0)
				}
			elseif i <= 38 then -- CRASH SNAP
				local subT = (i-30)/8
				frames[i] = {
					["Right Shoulder"] = CFrame.Angles(math.rad(45), 0, 0),
					["Left Shoulder"] = CFrame.Angles(math.rad(45), 0, 0),
					RootJoint = CFrame.new(0, -1.5, 1) * CFrame.Angles(math.rad(40), 0, 0)
				}
			else -- RECOVER
				frames[i] = frames[38]
			end
		end
		for i=1, 50 do
			if i <= 38 then applyPose(motors, frames[i]) else for name, d in pairs(motors) do d.m.C0 = d.m.C0:Lerp(d.C0, 0.1) end end
			task.wait(0.016)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
	task.spawn(function()
		local start = tick()
		while tick()-start < 1.4 do
			for i, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local target = hrp.Position + Vector3.new(math.random(-30,30), 100 * ((tick()-start)/1.4), math.random(-30,30))
					p.CFrame = p.CFrame:Lerp(CFrame.new(target), 0.1)
					p.Velocity = Vector3.zero
				end
			end
			task.wait()
		end
		task.wait(0.1)
		local targetArea = hrp.Position + hrp.CFrame.LookVector * 20
		for _, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then
				local randOffset = Vector3.new(math.random(-15,15), 0, math.random(-15,15))
				p.CFrame = CFrame.new(targetArea + randOffset + Vector3.new(0, 50, 0))
				p.Velocity = Vector3.new(0, -600, 0)
			end
			
		end
	end)
end)

-- =========================================================================
-- ADDITIONAL SPECIAL ACTIONS (Themed Packs)
-- =========================================================================

-- Helper for getting motors
local function getMotors(char)
	local motors = {}
	if not char:FindFirstChild("Torso") then return motors end
	for _, m in ipairs(char.Torso:GetChildren()) do if m:IsA("Motor6D") then motors[m.Name] = {m=m, C0=m.C0} end end
	if char:FindFirstChild("Head") then
		for _, m in ipairs(char.Head:GetChildren()) do if m:IsA("Motor6D") then motors[m.Name] = {m=m, C0=m.C0} end end
	end
	return motors
end

-- helper for the "Arc Windup" arm motion
local function setArcArms(motors, t, angleRange, spread)
	local armX = 0
	if t < 0.4 then
		armX = math.rad(-90 * (t / 0.4))
	else
		local subT = (t - 0.4) / 0.6
		armX = math.rad(-90 - (angleRange or 80) * subT)
	end
	if motors["Right Shoulder"] then motors["Right Shoulder"].m.C0 = motors["Right Shoulder"].C0 * CFrame.Angles(armX, 0, math.rad((spread or 20)*t)) end
	if motors["Left Shoulder"] then motors["Left Shoulder"].m.C0 = motors["Left Shoulder"].C0 * CFrame.Angles(armX, 0, math.rad(-(spread or 20)*t)) end
end

-- 1. MAGMA ERUPTION (Masterpiece)
createButton(SpecialCat, "MAGMA ERUPTION", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local frames = {}
		for i=1, 40 do
			local t = i/40
			if i <= 30 then -- WINDUP
				local subT = i/30
				local ease = subT*subT*(3-2*subT)
				frames[i] = {
					RootJoint = CFrame.new(0, -1*ease, 0) * CFrame.Angles(math.rad(-20*ease), 0, 0),
					["Right Shoulder"] = CFrame.Angles(math.rad(-100*subT), 0, math.rad(30*subT)),
					["Left Shoulder"] = CFrame.Angles(math.rad(-100*subT), 0, math.rad(-30*subT))
				}
			else -- IMPACT SLAM
				local subT = (i-30)/10
				frames[i] = {
					RootJoint = CFrame.new(0, -2.5, 0) * CFrame.Angles(math.rad(80), 0, 0),
					["Right Shoulder"] = CFrame.Angles(math.rad(45), 0, 0),
					["Left Shoulder"] = CFrame.Angles(math.rad(45), 0, 0)
				}
			end
		end
		for i=1, 40 do
			applyPose(motors, frames[i])
			task.wait(0.016)
		end
		task.wait(2)
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
	task.spawn(function()
		local start = tick()
		while tick()-start < 3 do
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local angle = j + tick()*5
					local radius = 2 + (j%3) -- Tight eruption
					local target = hrp.Position + Vector3.new(math.cos(angle)*radius, 5 + (tick()-start)*20, math.sin(angle)*radius)
					p.CFrame = p.CFrame:Lerp(CFrame.new(target), 0.2)
					p.Velocity = Vector3.zero
				end
			end
			task.wait()
		end
		
	end)
end)

-- 2. HYPER-FREEZE (Masterpiece)
createButton(SpecialCat, "HYPER-FREEZE", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local frames = {}
		for i=1, 45 do
			local t = i/45
			if i <= 35 then -- CROSS ARMS
				local subT = i/35
				frames[i] = {
					["Right Shoulder"] = CFrame.Angles(math.rad(110*subT), 0, math.rad(-60*subT)),
					["Left Shoulder"] = CFrame.Angles(math.rad(110*subT), 0, math.rad(60*subT)),
					RootJoint = CFrame.new(0, 0, -0.5*subT) * CFrame.Angles(math.rad(10*subT), 0, 0)
				}
			else -- TENSION SHAKE
				local jitter = (math.random()-.5)*0.1
				frames[i] = { RootJoint = frames[35].RootJoint * CFrame.Angles(jitter, jitter, jitter) }
			end
		end
		for i=1, 45 do
			applyPose(motors, frames[i])
			task.wait(0.016)
		end
		task.wait(1.5)
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
	task.spawn(function()
		local start = tick()
		while tick()-start < 2 do
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local target = hrp.Position + Vector3.new(math.sin(j)*10, math.cos(j)*10, math.sin(j*2)*10)
					p.CFrame = p.CFrame:Lerp(CFrame.new(target), 0.1)
					p.Velocity = Vector3.zero
				end
			end
			task.wait()
		end
		for _, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then p.Velocity = (p.Position - hrp.Position).Unit * 400 end
			
		end
	end)
end)

-- 3. ZEUS'S WRATH (Masterpiece)
createButton(SpecialCat, "ZEUS'S WRATH", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local frames = {}
		for i=1, 35 do
			local t = i/35
			local ease = t*t*(3-2*t)
			frames[i] = {
				["Right Shoulder"] = CFrame.Angles(math.rad(-180*ease), 0, 0),
				Neck = CFrame.Angles(math.rad(-40*ease), 0, 0),
				RootJoint = CFrame.Angles(math.rad(-10*ease), 0, 0)
			}
		end
		for i=1, 35 do
			applyPose(motors, frames[i])
			task.wait(0.016)
		end
		task.wait(1.5)
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
	task.spawn(function()
		for j, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then
				local targetArea = hrp.Position + hrp.CFrame.LookVector * (10 + (j%10)*2)
				p.CFrame = CFrame.new(targetArea + Vector3.new(0, 80, 0))
				p.Velocity = Vector3.new(0, -1000, 0)
				task.wait(0.1)
				
			end
		end
	end)
end)

-- 4. GIGA UPPERCUT (Masterpiece)
createButton(SpecialCat, "GIGA UPPERCUT", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local frames = {}
		for i=1, 40 do
			local t = i/40
			if i <= 25 then -- CROUCH WINDUP
				local subT = i/25
				local ease = 1 - (1-subT)^2
				frames[i] = {
					RootJoint = CFrame.new(0, -1.5*ease, 0) * CFrame.Angles(math.rad(20*ease), 0, 0),
					["Right Shoulder"] = CFrame.Angles(math.rad(-45*ease), 0, 0),
					["Left Shoulder"] = CFrame.Angles(0, 0, math.rad(-20*ease)),
					Neck = CFrame.Angles(math.rad(-20*ease), 0, 0)
				}
			elseif i <= 32 then -- EXPLOSIVE RISE
				local subT = (i-25)/7
				local ease = subT^3
				frames[i] = {
					RootJoint = CFrame.new(0, 3*ease, -0.5*ease) * CFrame.Angles(math.rad(-40*ease), 0, 0),
					["Right Shoulder"] = CFrame.Angles(math.rad(220*ease), 0, 0),
					Neck = CFrame.Angles(math.rad(40*ease), 0, 0)
				}
			else -- RECOVERY
				frames[i] = frames[32]
			end
		end
		for i=1, 40 do
			if i <= 32 then applyPose(motors, frames[i]) else for _, d in pairs(motors) do d.m.C0 = d.m.C0:Lerp(d.C0, 0.1) end end
			task.wait(0.016)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
	task.spawn(function()
		task.wait(0.4)
		for _, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then p.Velocity = Vector3.new(0, 600, 0) + hrp.CFrame.LookVector * 150 end
			
		end
	end)
end)

-- 5. BODY SLAM (Masterpiece)
createButton(SpecialCat, "BODY SLAM", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local frames = {}
		for i=1, 50 do
			local t = i/50
			if i <= 30 then -- BACKFLIP JUMP
				local ease = i/30
				frames[i] = {
					RootJoint = CFrame.new(0, 8*math.sin(ease*math.pi), 0) * CFrame.Angles(math.rad(360*ease), 0, 0),
					["Right Shoulder"] = CFrame.Angles(0,0,math.rad(90*ease)),
					["Left Shoulder"] = CFrame.Angles(0,0,math.rad(-90*ease))
				}
			elseif i <= 35 then -- FLAT SLAM SNAP
				frames[i] = {
					RootJoint = CFrame.new(0, -2.2, 1) * CFrame.Angles(math.rad(90), 0, 0),
					["Right Shoulder"] = CFrame.Angles(math.rad(90), 0, 0),
					["Left Shoulder"] = CFrame.Angles(math.rad(90), 0, 0)
				}
			else -- HOLD/RECOVER
				frames[i] = frames[35]
			end
		end
		for i=1, 50 do
			if i <= 35 then applyPose(motors, frames[i]) else for _, d in pairs(motors) do d.m.C0 = d.m.C0:Lerp(d.C0, 0.1) end end
			task.wait(0.016)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
	task.spawn(function()
		task.wait(0.55)
		local center = hrp.Position
		for _, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then
				local dir = (p.Position - center).Unit + Vector3.new(0, 1.2, 0)
				p.Velocity = dir * 350
			end
			
		end
	end)
end)

-- 6. ORA ORA BARRAGE (Masterpiece)
createButton(SpecialCat, "ORA BARRAGE", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local start = tick()
		while tick()-start < 3 do
			local subT = (tick()*40) % 20 -- 20-frame cycle
			local isRight = (math.sin(tick()*20) > 0)
			local pose = {
				RootJoint = CFrame.Angles(0, math.rad(isRight and 20 or -20), 0),
				["Right Shoulder"] = isRight and CFrame.Angles(math.rad(90), math.rad(-90), 0) or CFrame.Angles(0,0,0),
				["Left Shoulder"] = not isRight and CFrame.Angles(math.rad(90), math.rad(90), 0) or CFrame.Angles(0,0,0)
			}
			applyPose(motors, pose)
			
			local item = items[math.random(1, #items)]
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then
				p.CFrame = hrp.CFrame * CFrame.new(math.random(-5,5), math.random(-2,2), -5)
				p.Velocity = hrp.CFrame.LookVector * 250
			end
			task.wait(0.03)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 7. SPIRAL SHIELD (Masterpiece)
createButton(SpecialCat, "SPIRAL SHIELD", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local frames = {}
		for i=1, 40 do
			local t = i/40
			local ease = t*t*(3-2*t)
			frames[i] = {
				["Right Shoulder"] = CFrame.Angles(math.rad(90*ease), 0, math.rad(-45*ease)),
				["Left Shoulder"] = CFrame.Angles(math.rad(90*ease), 0, math.rad(45*ease)),
				RootJoint = CFrame.Angles(math.rad(10*ease), 0, 0)
			}
		end
		for i=1, 40 do
			applyPose(motors, frames[i])
			task.wait(0.016)
		end
		local start = tick()
		while tick()-start < 5 do
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local angle = (j/#items)*math.pi*2 + tick()*10
					local target = hrp.Position + Vector3.new(math.cos(angle)*10, math.sin(tick()+j)*2, math.sin(angle)*10)
					p.CFrame = p.CFrame:Lerp(CFrame.new(target) * CFrame.Angles(0, angle, 0), 0.3)
					p.Velocity = Vector3.zero
				end
			end
			task.wait()
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 8. DNA HELIX (Masterpiece)
createButton(SpecialCat, "DNA HELIX", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local frames = {}
		for i=1, 50 do
			local t = i/50
			local ease = t*t*(3-2*t)
			frames[i] = {
				RootJoint = CFrame.new(0, 3*ease, 0),
				["Right Hip"] = CFrame.Angles(math.rad(80*ease), 0, math.rad(30*ease)),
				["Left Hip"] = CFrame.Angles(math.rad(80*ease), 0, math.rad(-30*ease)),
				["Right Shoulder"] = CFrame.Angles(0, 0, math.rad(45*ease)),
				["Left Shoulder"] = CFrame.Angles(0, 0, math.rad(-45*ease))
			}
		end
		for i=1, 50 do
			applyPose(motors, frames[i])
			task.wait(0.016)
		end
		local start = tick()
		while tick()-start < 6 do
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local et = (tick()-start) * 2
					local side = (j%2 == 0) and 1 or -1
					local angle = et + (j*0.5)
					local target = hrp.Position + Vector3.new(math.cos(angle)*8*side, (j%10)-5, math.sin(angle)*8*side)
					p.CFrame = p.CFrame:Lerp(CFrame.new(target), 0.2)
					p.Velocity = Vector3.zero
				end
			end
			task.wait()
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 9. BEE HIVE (Masterpiece)
createButton(SpecialCat, "BEE HIVE", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local start = tick()
		while tick()-start < 5 do
			local jitter = (math.random()-.5)*0.3
			local pose = {
				RootJoint = CFrame.new(jitter, jitter, jitter) * CFrame.Angles(jitter, jitter, jitter),
				Neck = CFrame.Angles(jitter, jitter, jitter)
			}
			applyPose(motors, pose)
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local target = hrp.Position + Vector3.new(math.random(-15,15), math.random(-5,15), math.random(-15,15))
					p.CFrame = p.CFrame:Lerp(CFrame.new(target), 0.4)
					p.Velocity = Vector3.zero
				end
			end
			task.wait(0.02)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 10. RAIN OF ARROWS (Masterpiece)
createButton(SpecialCat, "RAIN OF ARROWS", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local frames = {}
		for i=1, 40 do
			local t = i/40
			local ease = t*t*(3-2*t)
			frames[i] = {
				RootJoint = CFrame.Angles(0, math.rad(-45*ease), 0),
				["Right Shoulder"] = CFrame.Angles(math.rad(90*ease), math.rad(-45*ease), 0),
				["Left Shoulder"] = CFrame.Angles(math.rad(90*ease), math.rad(45*ease), 0),
				Neck = CFrame.Angles(0, math.rad(45*ease), 0)
			}
		end
		for i=1, 40 do
			applyPose(motors, frames[i])
			task.wait(0.016)
		end
		for j, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then
				local offset = (j%10 - 5) * 5 -- 25 stud width < 30
				p.CFrame = hrp.CFrame * CFrame.new(offset, 40, -10 - (j/10)*5)
				p.Velocity = hrp.CFrame.LookVector * 400 + Vector3.new(0, -250, 0)
			end
			
			task.wait(0.04)
		end
		task.wait(1)
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
end)

-- 11. PING PONG (Masterpiece)
createButton(SpecialCat, "PING PONG", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local start = tick()
		while tick()-start < 5 do
			local et = tick()*5
			local side = math.sin(et)
			local pose = {
				RootJoint = CFrame.new(side*2, 0, 0) * CFrame.Angles(0, 0, math.rad(15*side)),
				Neck = CFrame.Angles(0, 0, math.rad(-10*side))
			}
			applyPose(motors, pose)
			local ballSide = math.sin(tick()*8) > 0 and 1 or -1
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local target = hrp.Position + Vector3.new(25*ballSide + (j%5), math.sin(tick()*12+j)*5, 0)
					p.CFrame = p.CFrame:Lerp(CFrame.new(target), 0.3)
					p.Velocity = Vector3.zero
				end
			end
			task.wait(0.016)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 12. SUPERNOVA (Masterpiece)
createButton(SpecialCat, "SUPERNOVA", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local frames = {}
		for i=1, 60 do
			local t = i/60
			local ease = t*t*(3-2*t)
			frames[i] = {
				RootJoint = CFrame.new(0, 15*ease, 0) * CFrame.Angles(math.rad(ease*20), 0, 0),
				["Right Shoulder"] = CFrame.Angles(0, 0, math.rad(160*ease)),
				["Left Shoulder"] = CFrame.Angles(0, 0, math.rad(-160*ease)),
				["Right Hip"] = CFrame.Angles(0, 0, math.rad(45*ease)),
				["Left Hip"] = CFrame.Angles(0, 0, math.rad(-45*ease))
			}
		end
		for i=1, 60 do
			applyPose(motors, frames[i])
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					p.CFrame = p.CFrame:Lerp(CFrame.new(hrp.Position) * CFrame.Angles(math.random(),math.random(),math.random()), 0.1)
				end
			end
			task.wait(0.016)
		end
		for _, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then p.Velocity = (p.Position - hrp.Position).Unit * 600 end
			
		end
		task.wait(1)
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
end)

-- =========================================================================
-- MASTERPIECE SPECIAL ACTIONS (30+ Explicit Keyframes)
-- Helpers already defined above (getMotors, applyPose)


-- 1. DRAGON STRIKE: Martial Arts Combo (3-Hit)
createButton(SpecialCat, "DRAGON STRIKE", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	
	task.spawn(function()
		-- 30+ Explicit Keyframes
		local anim = {
			-- WINDUP (1-10)
			[1] = {RootJoint = CFrame.new(0,-0.1,0) * CFrame.Angles(0,math.rad(-10),0)},
			[2] = {RootJoint = CFrame.new(0,-0.2,0) * CFrame.Angles(0,math.rad(-20),0), ["Right Shoulder"] = CFrame.Angles(math.rad(10),0,0)},
			[3] = {RootJoint = CFrame.new(0,-0.3,0) * CFrame.Angles(0,math.rad(-30),0), ["Right Shoulder"] = CFrame.Angles(math.rad(20),0,0)},
			[4] = {RootJoint = CFrame.new(0,-0.4,0) * CFrame.Angles(0,math.rad(-40),0), ["Right Shoulder"] = CFrame.Angles(math.rad(40),0,0)},
			[5] = {RootJoint = CFrame.new(0,-0.5,0) * CFrame.Angles(0,math.rad(-50),0), ["Right Shoulder"] = CFrame.Angles(math.rad(60),0,0), ["Left Shoulder"] = CFrame.Angles(0,0,math.rad(-10))},
			[6] = {RootJoint = CFrame.new(0,-0.4,0) * CFrame.Angles(0,math.rad(-40),0), ["Right Shoulder"] = CFrame.Angles(math.rad(80),0,0)},
			[7] = {RootJoint = CFrame.new(0,-0.3,0) * CFrame.Angles(0,math.rad(-30),0), ["Right Shoulder"] = CFrame.Angles(math.rad(100),0,0)},
			[8] = {RootJoint = CFrame.new(0,-0.2,0) * CFrame.Angles(0,math.rad(-20),0), ["Right Shoulder"] = CFrame.Angles(math.rad(120),0,0)},
			[9] = {RootJoint = CFrame.new(0,-0.1,0) * CFrame.Angles(0,math.rad(-10),0), ["Right Shoulder"] = CFrame.Angles(math.rad(140),0,0)},
			[10]= {RootJoint = CFrame.new(0,0,0) * CFrame.Angles(0,0,0), ["Right Shoulder"] = CFrame.Angles(math.rad(160),0,0)},
			
			-- FIRST HIT: LEFT JAB (11-15)
			[11]= {RootJoint = CFrame.Angles(0,math.rad(20),0), ["Left Shoulder"] = CFrame.Angles(math.rad(90),0,math.rad(-20))},
			[12]= {RootJoint = CFrame.Angles(0,math.rad(40),0), ["Left Shoulder"] = CFrame.Angles(math.rad(100),0,math.rad(-10))},
			[13]= {RootJoint = CFrame.Angles(0,math.rad(60),0), ["Left Shoulder"] = CFrame.Angles(math.rad(110),0,0)},
			[14]= {RootJoint = CFrame.Angles(0,math.rad(40),0), ["Left Shoulder"] = CFrame.Angles(math.rad(90),0,math.rad(-10))},
			[15]= {RootJoint = CFrame.Angles(0,math.rad(20),0), ["Left Shoulder"] = CFrame.Angles(math.rad(45),0,math.rad(-20))},
			
			-- SECOND HIT: RIGHT HOOK (16-20)
			[16]= {RootJoint = CFrame.Angles(0,math.rad(-20),0), ["Right Shoulder"] = CFrame.Angles(math.rad(90),math.rad(-45),0)},
			[17]= {RootJoint = CFrame.Angles(0,math.rad(-40),0), ["Right Shoulder"] = CFrame.Angles(math.rad(90),math.rad(-90),0)},
			[18]= {RootJoint = CFrame.Angles(0,math.rad(-60),0), ["Right Shoulder"] = CFrame.Angles(math.rad(90),math.rad(-120),0)},
			[19]= {RootJoint = CFrame.Angles(0,math.rad(-40),0), ["Right Shoulder"] = CFrame.Angles(math.rad(90),math.rad(-90),0)},
			[20]= {RootJoint = CFrame.Angles(0,math.rad(-20),0), ["Right Shoulder"] = CFrame.Angles(math.rad(45),math.rad(-45),0)},
			
			-- THIRD HIT: SPINNING ROUNDHOUSE (21-30)
			[21]= {RootJoint = CFrame.Angles(0,math.rad(60),0), ["Right Hip"] = CFrame.Angles(0,0,math.rad(20))},
			[22]= {RootJoint = CFrame.Angles(0,math.rad(120),0), ["Right Hip"] = CFrame.Angles(0,0,math.rad(40))},
			[23]= {RootJoint = CFrame.Angles(0,math.rad(180),0), ["Right Hip"] = CFrame.Angles(0,0,math.rad(60))},
			[24]= {RootJoint = CFrame.Angles(0,math.rad(240),0), ["Right Hip"] = CFrame.Angles(0,0,math.rad(90))},
			[25]= {RootJoint = CFrame.Angles(0,math.rad(300),0), ["Right Hip"] = CFrame.Angles(0,0,math.rad(70))},
			[26]= {RootJoint = CFrame.Angles(0,math.rad(360),0), ["Right Hip"] = CFrame.Angles(0,0,math.rad(40))},
			[27]= {RootJoint = CFrame.Angles(0,math.rad(10),0), ["Neck"] = CFrame.Angles(0,math.rad(-20),0)},
			[28]= {RootJoint = CFrame.Angles(0,math.rad(5),0), ["Neck"] = CFrame.Angles(0,math.rad(-10),0)},
			[29]= {RootJoint = CFrame.Angles(0,math.rad(2),0), ["Neck"] = CFrame.Angles(0,math.rad(-5),0)},
			[30]= {RootJoint = CFrame.new(0,0,0), ["Neck"] = CFrame.new(0,0,0)}
		}
		
		for i=1, 30 do
			applyPose(motors, anim[i])
			-- Sync items with hits
			if i == 13 or i == 18 or i == 24 then
				for _, item in ipairs(items) do
					local p = (item:IsA("Model") and item.PrimaryPart) or item
					if p and p:IsA("BasePart") then p.Velocity = hrp.CFrame.LookVector * 150 + Vector3.new(0, 50, 0) end
				end
			end
			task.wait(0.016)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 2. THE CONDUCTOR: Symphonic Item Pulse
createButton(SpecialCat, "THE CONDUCTOR", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	
	task.spawn(function()
		-- 30+ Explicit Sequence
		local frames = {}
		for i=1, 40 do
			local t = i/40
			local wave = math.sin(t * math.pi * 4)
			frames[i] = {
				["Right Shoulder"] = CFrame.Angles(math.rad(90 + wave*40), math.rad(wave*20), 0),
				["Left Shoulder"] = CFrame.Angles(math.rad(90 - wave*40), math.rad(-wave*20), 0),
				["Neck"] = CFrame.Angles(math.rad(wave*10), 0, 0),
				["RootJoint"] = CFrame.new(0, wave*0.2, 0) * CFrame.Angles(math.rad(wave*5), 0, 0)
			}
		end
		
		for i=1, 40 do
			applyPose(motors, frames[i])
			-- Item behavior: Swell with conductor
			local ease = math.sin((i/40) * math.pi * 4)
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local angle = (j/#items) * math.pi * 2 + tick()*2
					local radius = 10 + ease*15
					local target = hrp.Position + Vector3.new(math.cos(angle)*radius, 10 + ease*5, math.sin(angle)*radius)
					p.CFrame = p.CFrame:Lerp(CFrame.new(target), 0.2)
					p.Velocity = Vector3.zero
				end
			end
			task.wait(0.03)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 3. PUPPET MASTER: Finger-by-Finger Control
createButton(SpecialCat, "PUPPET MASTER", function()
	local char = LocalPlayer.Character
	local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems()
	if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	
	task.spawn(function()
		local frames = {}
		-- 32 Frames of creepy puppet logic
		for i=1, 32 do
			local t = i/32
			local jitter = (math.random()-.5)*0.05
			frames[i] = {
				["RootJoint"] = CFrame.new(0, 1 + jitter, 0) * CFrame.Angles(math.rad(30 + math.sin(t*10)*5), 0, 0),
				["Right Shoulder"] = CFrame.new(-0.2, -0.2, -0.2) * CFrame.Angles(math.rad(110 + math.cos(t*15)*20), 0, math.rad(-20)),
				["Left Shoulder"] = CFrame.new(0.2, -0.2, -0.2) * CFrame.Angles(math.rad(110 + math.sin(t*15)*20), 0, math.rad(20)),
				["Neck"] = CFrame.Angles(math.rad(-20), math.rad(math.sin(t*5)*30), 0)
			}
		end
		
		for i=1, 32 do
			applyPose(motors, frames[i])
			-- Items follow "strings"
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local t = tick()
					local target = hrp.Position + Vector3.new(math.sin(t+j)*15, 20 + math.cos(t*2+j)*5, math.cos(t+j)*15)
					p.CFrame = p.CFrame:Lerp(CFrame.new(target), 0.1)
					p.Velocity = Vector3.zero
				end
			end
			task.wait(0.04)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- ðŸ’Ž MASTERPIECE PACK II (Consolidated)

-- 4. PHOENIX REBIRTH
createButton(SpecialCat, "PHOENIX REBIRTH", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local frames = {}
		for i=1, 50 do
			local t = i/50
			if i <= 35 then -- RISE & WINGS
				local subT = i/35
				frames[i] = {
					RootJoint = CFrame.new(0, 5*subT, 0) * CFrame.Angles(math.rad(-20*subT), 0, 0),
					["Right Shoulder"] = CFrame.Angles(0, 0, math.rad(110*subT)),
					["Left Shoulder"] = CFrame.Angles(0, 0, math.rad(-110*subT)),
					Neck = CFrame.Angles(math.rad(-30*subT), 0, 0)
				}
			else -- BURST
				local subT = (i-35)/15
				frames[i] = {
					RootJoint = CFrame.new(0, 5, 0) * CFrame.Angles(math.rad(20*subT), 0, 0),
					["Right Shoulder"] = CFrame.Angles(0, 0, math.rad(180*subT)),
					["Left Shoulder"] = CFrame.Angles(0, 0, math.rad(-180*subT))
				}
			end
		end
		for i=1, 50 do
			applyPose(motors, frames[i])
			if i == 36 then
				for _, item in ipairs(items) do
					local p = (item:IsA("Model") and item.PrimaryPart) or item
					if p and p:IsA("BasePart") then p.Velocity = (p.Position - hrp.Position).Unit * 500 end
					
				end
			elseif i < 36 then
				for j, item in ipairs(items) do
					local p = (item:IsA("Model") and item.PrimaryPart) or item
					if p and p:IsA("BasePart") then
						local side = (j%2==0) and 1 or -1
						local target = hrp.Position + Vector3.new(15*side, 10 + math.sin(tick()+j)*5, -5)
						p.CFrame = p.CFrame:Lerp(CFrame.new(target), 0.2)
					end
				end
			end
			task.wait(0.016)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
end)

-- 5. POSEIDON'S WAKE
createButton(SpecialCat, "POSEIDON'S WAKE", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local frames = {}
		for i=1, 40 do
			local t = i/40
			local ease = t*t*(3-2*t)
			frames[i] = {
				RootJoint = CFrame.Angles(0, math.rad(-90*ease), 0),
				["Right Shoulder"] = CFrame.Angles(math.rad(90), math.rad(-90*ease), 0)
			}
		end
		for i=1, 40 do
			applyPose(motors, frames[i])
			local startT = tick()
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local x = (j%10 - 5) * 4
					local z = -10 - (tick()*20 + j) % 20
					local y = math.sin(z*0.5 + tick()*5)*5 + 5
					p.CFrame = hrp.CFrame * CFrame.new(x, y, z)
				end
			end
			task.wait(0.016)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 6. BLADE OF OLYMPUS
createButton(SpecialCat, "BLADE OF OLYMPUS", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local frames = {}
		for i=1, 50 do
			local t = i/50
			if i <= 30 then -- RAISE
				frames[i] = { ["Right Shoulder"] = CFrame.Angles(math.rad(-180*(i/30)), 0, 0), RootJoint = CFrame.Angles(math.rad(-10*(i/30)), 0, 0) }
			else -- SLAM
				local subT = (i-30)/20
				frames[i] = { ["Right Shoulder"] = CFrame.Angles(math.rad(-180 + 220*subT), 0, 0), RootJoint = CFrame.Angles(math.rad(-10 + 90*subT), 0, 0) }
			end
		end
		for i=1, 50 do
			applyPose(motors, frames[i])
			if i <= 30 then
				for j, item in ipairs(items) do
					local p = (item:IsA("Model") and item.PrimaryPart) or item
					if p and p:IsA("BasePart") then
						local target = hrp.CFrame * CFrame.new(0, 10 + j*1.5, 0) -- Vertical blade
						p.CFrame = p.CFrame:Lerp(target, 0.2)
					end
				end
			else
				for j, item in ipairs(items) do
					local p = (item:IsA("Model") and item.PrimaryPart) or item
					if p and p:IsA("BasePart") then
						p.CFrame = p.CFrame * CFrame.new(0,0,-5)
					end
				end
			end
			task.wait(0.016)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 7. MJÃ–LNIR'S STRIKE
createButton(SpecialCat, "MJOLNIR'S STRIKE", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		for i=1, 40 do
			local t = i/40
			local jitter = (math.random()-.5)*0.2
			applyPose(motors, { ["Right Shoulder"] = CFrame.Angles(math.rad(-180*t), jitter, jitter), Neck = CFrame.Angles(math.rad(-40*t), 0, 0) })
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then p.CFrame = hrp.CFrame * CFrame.new(math.random(-5,5), 20 + math.random(-5,5), math.random(-5,5)) end
			end
			task.wait(0.016)
		end
		applyPose(motors, { ["Right Shoulder"] = CFrame.Angles(math.rad(45), 0, 0), RootJoint = CFrame.new(0,-2,0) * CFrame.Angles(math.rad(80), 0, 0) })
		for _, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then p.Velocity = Vector3.new(0, -1000, 0);  end
		end
		task.wait(1)
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
end)

-- 8. LASER GRID
createButton(SpecialCat, "LASER GRID", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		applyPose(motors, { ["Right Shoulder"] = CFrame.Angles(0, 0, math.rad(90)), ["Left Shoulder"] = CFrame.Angles(0, 0, math.rad(-90)) })
		local start = tick()
		while tick()-start < 5 do
			local t = tick()*2
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local x = (j%5 - 2) * 6
					local y = (math.floor(j/5)%5 - 2) * 6
					local cf = hrp.CFrame * CFrame.Angles(0, t, 0) * CFrame.new(x, y + 5, -10)
					p.CFrame = p.CFrame:Lerp(cf, 0.2)
				end
			end
			task.wait()
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 9. WARP DRIVE
createButton(SpecialCat, "WARP DRIVE", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		for i=1, 30 do
			applyPose(motors, { RootJoint = CFrame.new(0, 0, i*0.2) * CFrame.Angles(math.rad(i*2), 0, 0) })
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then p.CFrame = p.CFrame:Lerp(hrp.CFrame * CFrame.new(0,0,-2), 0.3) end
			end
			task.wait(0.016)
		end
		for _, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then p.CFrame = hrp.CFrame * CFrame.new(0,0,-30);  end
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
end)

-- 10. NANO-SWARM
createButton(SpecialCat, "NANO-SWARM", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local start = tick()
		while tick()-start < 6 do
			local jitter = (math.random()-.5)*0.2
			applyPose(motors, { Neck = CFrame.Angles(jitter, jitter, jitter) })
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local t = tick() + j*0.5
					local target = hrp.Position + Vector3.new(math.sin(t)*12, 5 + math.cos(t*1.5)*8, math.sin(t*0.8)*12)
					p.CFrame = p.CFrame:Lerp(CFrame.new(target), 0.15)
				end
			end
			task.wait()
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 11. SOLAR FLARE
createButton(SpecialCat, "SOLAR FLARE", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		for i=1, 60 do
			local t = i/60
			applyPose(motors, { RootJoint = CFrame.new(0, 10*t, 0), ["Right Shoulder"] = CFrame.Angles(0,0,math.rad(180*t)), ["Left Shoulder"] = CFrame.Angles(0,0,math.rad(-180*t)) })
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local r = 5 + (math.random()*t*25)
					p.CFrame = hrp.CFrame * CFrame.Angles(math.random(),math.random(),math.random()) * CFrame.new(0,r,0)
				end
			end
			task.wait(0.016)
		end
		
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
end)

-- 12. BLACK HOLE SINGULARITY
createButton(SpecialCat, "SINGULARITY", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local start = tick()
		while tick()-start < 4 do
			local t = tick()-start
			local ease = 1 - (t/4)
			applyPose(motors, { RootJoint = CFrame.Angles(0, tick()*10, 0), Neck = CFrame.Angles(math.rad(30), 0, 0) })
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local a = tick()*15 + j
					local r = 25 * ease
					p.CFrame = hrp.CFrame * CFrame.new(math.cos(a)*r, math.sin(a)*r, math.sin(a*0.5)*r)
				end
			end
			task.wait()
		end
		
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
end)

-- 13. SEISMIC TOSS
createButton(SpecialCat, "SEISMIC TOSS", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		for i=1, 40 do
			local ease = i/40
			applyPose(motors, { RootJoint = CFrame.Angles(0, math.rad(720*ease), 0), ["Right Shoulder"] = CFrame.Angles(math.rad(-90), 0, 0) })
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then p.CFrame = hrp.CFrame * CFrame.new(0, 5, -10); p.Velocity = hrp.CFrame.LookVector * 100 end
			end
			task.wait(0.016)
		end
		for _, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then p.Velocity = (hrp.CFrame.LookVector + Vector3.new(0,1,0)) * 500 end
			
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
end)

-- 14. ARCANE SIGIL
createButton(SpecialCat, "ARCANE SIGIL", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		applyPose(motors, { RootJoint = CFrame.new(0, 2, 0), ["Right Shoulder"] = CFrame.Angles(math.rad(-90), 0, 0), ["Left Shoulder"] = CFrame.Angles(math.rad(-90), 0, 0) })
		local start = tick()
		while tick()-start < 6 do
			local t = tick()
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local r = 12
					local a = (j/#items)*math.pi*2 + t
					local inner = (j%2==0) and 1 or 0.5
					p.CFrame = hrp.CFrame * CFrame.new(math.cos(a)*r*inner, -3.5, math.sin(a)*r*inner) * CFrame.Angles(0, t, 0)
				end
			end
			task.wait()
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 15. SOUL REAP
createButton(SpecialCat, "SOUL REAP", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		for i=1, 50 do
			local t = i/50
			applyPose(motors, { RootJoint = CFrame.Angles(math.rad(-30*t), 0, 0), Neck = CFrame.Angles(math.rad(40*t), 0, 0) })
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					p.CFrame = p.CFrame:Lerp(hrp.CFrame, 0.1)
					if (p.Position - hrp.Position).Magnitude < 2 then p.CFrame = hrp.CFrame * CFrame.new(0,0,5) end
				end
			end
			task.wait(0.016)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 16. CHRONOS SNAP
createButton(SpecialCat, "CHRONOS SNAP", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		-- Snap Animation
		for i=1, 20 do applyPose(motors, { ["Right Shoulder"] = CFrame.Angles(math.rad(-90*(i/20)), 0, 0) }); task.wait(0.01) end
		local start = tick()
		while tick()-start < 5 do
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					p.Velocity = Vector3.new(0,0.1,0)
					p.CFrame = p.CFrame * CFrame.Angles(0.01, 0.01, 0.01)
				end
			end
			task.wait(0.1)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 17. HURRICANE EYE
createButton(SpecialCat, "HURRICANE EYE", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local start = tick()
		while tick()-start < 6 do
			applyPose(motors, { RootJoint = CFrame.Angles(0, tick()*20, 0) })
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local a = (j/#items)*math.pi*2 + tick()*15
					local h = (j%10)*3
					p.CFrame = hrp.CFrame * CFrame.new(math.cos(a)*15, h - 5, math.sin(a)*15)
				end
			end
			task.wait()
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 18. MIRROR IMAGE
createButton(SpecialCat, "MIRROR IMAGE", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	task.spawn(function()
		local start = tick()
		while tick()-start < 5 do
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local target = hrp.CFrame * CFrame.new(0,0,-8)
					p.CFrame = p.CFrame:Lerp(target, 0.1)
				end
			end
			task.wait()
		end
		
	end)
end)

-- 19. THOUSAND SLAPS
createButton(SpecialCat, "THOUSAND SLAPS", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local start = tick()
		while tick()-start < 4 do
			local side = (math.sin(tick()*40) > 0)
			applyPose(motors, {
				["Right Shoulder"] = side and CFrame.Angles(math.rad(-90), math.rad(-90), 0) or CFrame.new(),
				["Left Shoulder"] = not side and CFrame.Angles(math.rad(-90), math.rad(90), 0) or CFrame.new()
			})
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					p.CFrame = hrp.CFrame * CFrame.new(math.random(-5,5), math.random(-2,5), -6)
					p.Velocity = hrp.CFrame.LookVector * 200
				end
			end
			task.wait(0.02)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 20. SEISMIC SURGE
createButton(SpecialCat, "SEISMIC SURGE", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		for wave=1, 3 do
			-- Slam
			for i=1,10 do applyPose(motors, { RootJoint = CFrame.new(0,-1,0) * CFrame.Angles(math.rad(45),0,0) }); task.wait(0.01) end
			local start = tick()
			while tick()-start < 1.5 do
				local r = (tick()-start)*20
				for j, item in ipairs(items) do
					local p = (item:IsA("Model") and item.PrimaryPart) or item
					if p and p:IsA("BasePart") then
						local a = (j/#items)*math.pi*2
						p.CFrame = hrp.CFrame * CFrame.new(math.cos(a)*r, -3.5, math.sin(a)*r)
					end
				end
				task.wait()
			end
			for _, d in pairs(motors) do d.m.C0 = d.C0 end
		end
		
	end)
end)

-- 21. GRAVITY WELL
createButton(SpecialCat, "GRAVITY WELL", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		applyPose(motors, { RootJoint = CFrame.new(0,-2,0), Neck = CFrame.Angles(math.rad(40), 0, 0) })
		for j, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then
				local r = math.random(5, 25)
				local a = math.random()*math.pi*2
				p.CFrame = hrp.CFrame * CFrame.new(math.cos(a)*r, -4, math.sin(a)*r)
				p.Velocity = Vector3.new(0, -500, 0)
			end
		end
		task.wait(4)
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 22. DIMENSIONAL RIFT
createButton(SpecialCat, "DIMENSIONAL RIFT", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local start = tick()
		while tick()-start < 5 do
			local jitter = (math.random()-.5)*2
			applyPose(motors, { RootJoint = CFrame.new(jitter, jitter, jitter) * CFrame.Angles(jitter, jitter, jitter) })
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					p.CFrame = hrp.CFrame * CFrame.new(math.random(-25,25), math.random(0,20), math.random(-25,25))
				end
			end
			task.wait(0.05)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 23. STAR SHOWER
createButton(SpecialCat, "STAR SHOWER", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		applyPose(motors, { Neck = CFrame.Angles(math.rad(-60), 0, 0), ["Right Shoulder"] = CFrame.Angles(math.rad(-180), 0, 0) })
		for j, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then
				p.CFrame = hrp.CFrame * CFrame.new(math.random(-25,25), 50, math.random(-25,25))
				p.Velocity = Vector3.new(0, -200, 0)
				task.wait(0.05)
				
			end
		end
		task.wait(1)
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
end)

-- 24. VORTEX BLASTER
createButton(SpecialCat, "VORTEX BLASTER", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		applyPose(motors, { ["Right Shoulder"] = CFrame.Angles(math.rad(-90), math.rad(-30), 0) })
		for j, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then
				p.CFrame = hrp.CFrame * CFrame.new(2, 2, -3) * CFrame.Angles(tick()*10, 0, 0)
				p.Velocity = hrp.CFrame.LookVector * 600
				task.wait(0.05)
				
			end
		end
		task.wait(1)
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
end)

-- 25. CRYSTAL PRISM
createButton(SpecialCat, "CRYSTAL PRISM", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local start = tick()
		while tick()-start < 6 do
			local t = tick()*3
			applyPose(motors, { RootJoint = CFrame.new(0, 2 + math.sin(t)*0.5, 0) * CFrame.Angles(0, t, 0) })
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local a = (j/#items)*math.pi*2 + t
					local r = 10
					local h = (j%5)*4 - 5
					p.CFrame = hrp.CFrame * CFrame.new(math.cos(a)*r, h, math.sin(a)*r) * CFrame.Angles(t, a, 0)
				end
			end
			task.wait()
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 26. HEAVENLY ASCENSION
createButton(SpecialCat, "ASCENSION", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		for i=1, 60 do
			local t = i/60
			applyPose(motors, { RootJoint = CFrame.new(0, 30*t, 0) * CFrame.Angles(0, t*10, 0), ["Right Shoulder"] = CFrame.Angles(0,0,math.rad(90)) })
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local a = (j/#items)*math.pi*4 + tick()
					local r = 8
					local h = (j/#items)*40 - 20
					p.CFrame = hrp.CFrame * CFrame.new(math.cos(a)*r, h, math.sin(a)*r)
				end
			end
			task.wait(0.016)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 27. DEEP SEA BUBBLE
createButton(SpecialCat, "SEA BUBBLE", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		local start = tick()
		while tick()-start < 6 do
			local t = tick()
			applyPose(motors, { RootJoint = CFrame.Angles(math.sin(t)*0.1, math.cos(t)*0.1, 0) })
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local phi = math.acos(1 - 2 * (j/#items))
					local theta = tick()*2 + j * (math.pi * (3 - math.sqrt(5)))
					local r = 12 + math.sin(tick()*3 + j)*2
					p.CFrame = hrp.CFrame * CFrame.new(math.cos(theta)*math.sin(phi)*r, math.cos(phi)*r, math.sin(theta)*math.sin(phi)*r)
				end
			end
			task.wait()
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 28. BLOOD MOON PULSE
createButton(SpecialCat, "BLOOD MOON", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		for i=1, 50 do
			local t = i/50
			applyPose(motors, { RootJoint = CFrame.Angles(math.rad(-20*t), 0, 0), Neck = CFrame.Angles(math.rad(-40*t), 0, 0) })
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local r = 15 * (1-t)
					local a = tick()*20 + j
					p.CFrame = hrp.CFrame * CFrame.new(math.cos(a)*r, 25, math.sin(a)*r)
				end
			end
			task.wait(0.016)
		end
		for _, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then p.Velocity = (p.Position - (hrp.Position + Vector3.new(0,25,0))).Unit * 800;  end
		end
		task.wait(1)
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
	end)
end)

-- 29. SEISMIC CRUSH
createButton(SpecialCat, "SEISMIC CRUSH", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		-- Raise
		for i=1, 30 do applyPose(motors, { ["Right Shoulder"] = CFrame.Angles(math.rad(-160*(i/30)), 0, 0), ["Left Shoulder"] = CFrame.Angles(math.rad(-160*(i/30)), 0, 0) }); task.wait(0.01) end
		-- Slam
		applyPose(motors, { RootJoint = CFrame.new(0,-2.5,0) * CFrame.Angles(math.rad(80), 0, 0) })
		for j, item in ipairs(items) do
			local p = (item:IsA("Model") and item.PrimaryPart) or item
			if p and p:IsA("BasePart") then
				local r = 5 + (j%5)*5
				local a = (j/#items)*math.pi*2
				p.CFrame = hrp.CFrame * CFrame.new(math.cos(a)*r, -4, math.sin(a)*r)
				p.Velocity = Vector3.new(0, -1000, 0)
			end
		end
		task.wait(2)
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- 30. DRAGON'S BREATH
createButton(SpecialCat, "DRAGON'S BREATH", function()
	local char = LocalPlayer.Character; local hrp = char:FindFirstChild("HumanoidRootPart")
	local items = getTrollItems(); if not hrp or #items == 0 then return end
	local motors = getMotors(char)
	task.spawn(function()
		for i=1, 40 do
			local t = i/40
			applyPose(motors, { RootJoint = CFrame.Angles(math.rad(-10*t), 0, 0), Neck = CFrame.Angles(math.rad(20*t), 0, 0) })
			for j, item in ipairs(items) do
				local p = (item:IsA("Model") and item.PrimaryPart) or item
				if p and p:IsA("BasePart") then
					local spread = 10 * t
					local offset = Vector3.new(math.random(-spread, spread), math.random(-spread, spread), -5 - (j%5)*4)
					p.CFrame = hrp.CFrame * CFrame.new(offset)
					p.Velocity = hrp.CFrame.LookVector * 300
				end
			end
			task.wait(0.016)
		end
		for _, d in pairs(motors) do d.m.C0 = d.C0 end
		
	end)
end)

-- =========================================================================
-- GLOBAL SIGNAL & SHARED STATE
-- =========================================================================
shared.CapatrolityUsers = shared.CapatrolityUsers or {}
shared.CapatrolityUsers[LocalPlayer.Name] = true

local function isScriptUser(p)
    return shared.CapatrolityUsers[p.Name] == true
end

-- =========================================================================
-- CATEGORY: CREDITS
-- =========================================================================
local CredCat = createCategory("Hub Credits", Color3.fromRGB(168, 85, 247))

local CredLabel = Instance.new("TextLabel")
CredLabel.Text = "CAPATROLITY HUB v3.0\n\nNo Interact CD: D3v1lHub\nAll Functions: freakyfrisk_1015 (dc)\nTime Spent: 4.5 Days\n\nThank you for using our Script Hub!"
CredLabel.Size = UDim2.new(1, -20, 0, 120)
CredLabel.Position = UDim2.new(0, 10, 0, 10)
CredLabel.BackgroundTransparency = 1
CredLabel.TextColor3 = CurrentTheme.Text
CredLabel.Font = Enum.Font.GothamMedium
CredLabel.TextSize = 14
CredLabel.TextXAlignment = Enum.TextXAlignment.Center
CredLabel.Parent = CredCat:FindFirstChild("Content") or CredCat
registerElement(CredLabel, {TextColor3 = "Text"})

-- =========================================================================
-- DRAGGING LOGIC
-- =========================================================================
local dragging, dragInput, dragStart, startPos

local function updateDrag(input)
	local delta = input.Position - dragStart
	MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
	ShadowFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X + 5, startPos.Y.Scale, startPos.Y.Offset + delta.Y + 5)
end

TitleBar.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = MainFrame.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then dragging = false end
		end)
	end
end)

TitleBar.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
		dragInput = input
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if input == dragInput and dragging then updateDrag(input) end
end)

-- Opening animation with scale bounce
MainFrame.Position = UDim2.new(0.5, -185, 0.5, -260)
MainFrame.Size = UDim2.new(0, 0, 0, 0)
MainFrame.BackgroundTransparency = 1
ShadowFrame.Position = UDim2.new(0.5, -185, 0.5, -255)
ShadowFrame.Size = UDim2.new(0, 0, 0, 0)
ShadowFrame.BackgroundTransparency = 1

-- Staggered entrance animation
task.spawn(function()
	task.wait(0.05)
	TweenService:Create(ShadowFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
		Size = UDim2.new(0, 380, 0, 520),
		BackgroundTransparency = 0.7
	}):Play()
	task.wait(0.05)
	TweenService:Create(MainFrame, TweenInfo.new(0.55, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
		Size = UDim2.new(0, 370, 0, 510),
		BackgroundTransparency = 0
	}):Play()
end)

print("Themed GUI Loaded! Click Themes to change themes.")
